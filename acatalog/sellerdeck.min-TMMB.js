/***************************************************************
* 
* ActinicCore.js	-	core utility functions
*
* Copyright (c) 2014 SellerDeck Limited
*
****************************************************************/
var bPageIsLoaded=!1;function setCookie(e,t,r){var n=e+"="+escape(t)+"; path=/";return r&&(n+="; expires="+r.toGMTString()),document.cookie=n,null}function getCookie(e){for(var t=document.cookie.split("; "),r,n=0;n<t.length;n++)if(r=t[n].split("="),r[0]==e)return unescape(r[1]);return null}function saveReferrer(){if("ActPopup"!=window.name){var e=!1;if(0==parent.frames.length)e=!0;else{for(var t=!1,r=parent.frames.length;r>0;r--)if("CatalogBody"==parent.frames[r-1].name){t=!0;break}t?"CatalogBody"==window.name&&(e=!0):e=!0}if(e){var n=document.URL,i=n.lastIndexOf("#"),o=n.lastIndexOf("#SID=");i>0&&-1==o&&(n=n.substring(0,i)),setCookie("ACTINIC_REFERRER",n)}return null}}function CreateArray(e){this.length=e;for(var t=1;e>=t;t++)this[t]=new Section;return this}function Section(){this.sURL=null,this.sName=null,this.sImage=null,this.nImageWidth=null,this.nImageHeight=null,this.nSectionId=null,this.pChild=null}function SwapImage(e,t){var r=0;document.aSource=new Array,null!=document[e]&&(document.aSource[r++]=document[e],null==document[e].sOldSrc&&(document[e].sOldSrc=document[e].src),document[e].src=t)}function RestoreImage(){var e,t=document.aSource;if(null!=t)for(e=0;e<t.length;e++)null!=t[e]&&null!=t[e].sOldSrc&&(t[e].src=t[e].sOldSrc)}function PreloadImages(){if(bPageIsLoaded=!0,document.images){document.Preloaded||(document.Preloaded=new Array);var e,t=document.Preloaded.length,r=PreloadImages.arguments;for(e=0;e<r.length;e++)document.Preloaded[t]=new Image,document.Preloaded[t++].src=r[e]}}function ShowPopUp(e,t,r){if(0!=e.indexOf("http")&&0!=e.indexOf("/")){var n=GetDocumentBaseHref();e=n+e}return window.open(e,"ActPopup","width="+t+",height="+r+",scrollbars, resizable"),bPageIsLoaded||window.location.reload(!0),!1}function GetDocumentBaseHref(){var e=document.getElementsByTagName("base");if(e&&e[0]){var t=e[0];if(t.href)return t.href}return""}function DecodeMail(){for(var e=0;e<document.links.length;e++)if("contactus"==document.links[e].name){for(var t=document.links[e].href;-1!=t.indexOf(" [dot] ");)t=t.replace(" [dot] ",".");for(;-1!=t.indexOf(" [at] ");)t=t.replace(" [at] ","@");document.links[e].href=t}}function HtmlInclude(){var e;if("undefined"==typeof XMLHttpRequest)try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){return}}else e=new XMLHttpRequest;var r=document.getElementsByTagName("A"),n;for(n=0;n<r.length;n++)if("fragment"==r[n].getAttribute("rel"))try{if(e.open("GET",r[n].getAttribute("href"),!1),document.characterSet&&e.overrideMimeType("text/html; charset="+document.characterSet),e.send(null),200==e.status){var i=document.createElement("SPAN");i.innerHTML=e.responseText,r[n].parentNode.replaceChild(i,r[n])}}catch(t){return}}function AddEvent(e,t,r){e.attachEvent?(e["e"+t+r]=r,e[t+r]=function(){e["e"+t+r](window.event)},e.attachEvent("on"+t,e[t+r])):e.addEventListener(t,r,!1)}AddEvent(window,"load",HtmlInclude),window.SDStorage={isSupported:function(){try{var e=(new Date).valueOf();window.SDStorage.write(e,e,!0);var t=window.SDStorage.read(e,!0);return window.SDStorage.remove(e,!0),e==t}catch(r){return!1}},writePage:function(e,t){try{window.SDStorage.write(e+"|"+window.location.href,t,!0)}catch(r){}},readPage:function(e){return window.SDStorage.read(e+"|"+window.location.href,!0)},writeGlobal:function(e,t){window.SDStorage.write(e+"|global",t,!0)},readGlobal:function(e){return window.SDStorage.read(e+"|global",!0)},write:function(e,t,r){"object"==typeof t&&(t=JSON.stringify(t)),r?sessionStorage.setItem(e,t):localStorage.setItem(e,t)},read:function(e,t){if(t)var r=sessionStorage.getItem(e);else var r=localStorage.getItem(e);try{var n=JSON.parse(r)}catch(i){return r}return n},remove:function(e,t){t?sessionStorage.removeItem(e):localStorage.removeItem(e)}};/***************************************************************
* 
* ActinicExtras.js	-	additional utility functions
*
* Copyright (c) 2014 SellerDeck Limited
*
****************************************************************/
var bDebug=!1,bShowErrors=!0,g_arrAJAX=[],g_mapAJAXArgs={},g_mapAJAXResults={},g_mapDynPrices={},g_mapStockByRef={},g_bStockUpdateInProgress=!1,g_bDynamicPriceUpdatePending=!1,g_bChoicesUpdatePending=!1,g_mapAJAXActions={GetBreadcrumbTrail:SetBreadcrumbTrail},PRICING_MODEL_COMPONENTS_SUM=1;function AddAJAXCall(){var e=arguments[0];g_arrAJAX.push(e);for(var t=1;t<arguments.length;t++)g_mapAJAXArgs[arguments[t]]||(g_mapAJAXArgs[arguments[t]]=1)}function AJAXCall(){if(0!=g_arrAJAX.length){var e=new ajaxObject(g_sAJAXScriptURL);e.callback=function(e){bDebug&&alert(e),g_mapAJAXResults=e.parseJSON(),g_mapAJAXResults.Error?bDebug&&alert("Programming Error:"+g_mapAJAXResults.Error):ProcessAJAXResults(g_mapAJAXResults)};var t="ACTIONS="+g_arrAJAX.join(",");for(var r in g_mapAJAXArgs)r&&(t+="&"+r);e.update(t,"GET")}}function ProcessAJAXResults(e){for(var t in e)g_mapAJAXActions[t]&&g_mapAJAXActions[t](e[t])}function AddAJAXBreadcrumbTrail(e){var t=document.getElementById("idBreadcrumbsTop"),r=document.getElementById("idBreadcrumbsBottom");if(t||r){var n=t||r,i=n.getElementsByTagName("a");if(0!=i.length){AdjustPageFileNameSIDAnchor();var o=[];if(document.location.href.match(/\bSID=(\d+)\b/)){o.push("SID="+RegExp.$1),t&&(t.style.visibility="hidden"),r&&(r.style.visibility="hidden");var a=i[0];a.className.match(/\bajs-bc-home\b/)&&o.push("ROOTCLASS="+a.className);for(var l=GetAllElements(n),s=0;s<l.length;s++)if(l[s].className.match(/\bajs-bc-prod\b/)){o.push("PRODCLASS="+l[s].className);break}AddAJAXCall("GetBreadcrumbTrail","REF="+encodeURIComponent(e),o.join("&"))}}}}function SetBreadcrumbTrail(e){if(e.HTML){var t=document.getElementById("idBreadcrumbsTop"),r=document.getElementById("idBreadcrumbsBottom"),n=decodeURIComponent(e.HTML);t&&(t.innerHTML=n,t.style.visibility="visible"),r&&(r.innerHTML=n,r.style.visibility="visible")}bDebug&&alert("Breadcrumb Trail:"+(e.HTML||e.Error)),bShowErrors&&e.Error&&alert("Breadcrumb Trail:"+e.Error)}function AdjustPageFileNameSIDAnchor(){var e=GetInputElement(document,"PAGEFILENAME");if(e){var t=GetSIDAnchor();if(t){e.value=e.value.replace(/#SID=\d+/,"#SID="+t);var r=GetInputElement(e.form,"SID");r&&(r.value=t)}}}function GetSIDAnchor(){var e=document.location.href.split("#SID=");return 2==e.length?e[1]:""}function AppendParentSection(e,t){if(1==arguments.length){var r=GetInputElement(document,"PAGE");if(!r||"PRODUCT"!=r.value)return;var n=GetInputElement(r.form,"SID");return n&&(t=n.value),void(e.href.indexOf("?")>-1&&(e.href+="&SID="+t))}e.href+="#SID="+t}var PASSWORD_MATCH_ERROR="Passwords do not match.";function getCartItem(e){var t=getCookie("CART_CONTENT"),r=null!=t?r=t.split("	"):0;return r.length>0?r[e]:0}function GotoAnchor(e){window.location.hash=e}!function(s){s.parseJSON=function(filter){try{if("object"==typeof JSON)return JSON.parse(this,filter);var j;function walk(e,t){var r,n,i=e[t];if(i&&"object"==typeof i)for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n=walk(i,r),void 0!==n?i[r]=n:delete i[r]);return reviver.call(e,t,i)}var text=String(this),cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;if(cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j}catch(e){}throw new SyntaxError("parseJSON")}}(String.prototype);function ajaxObject(e,t){if(e.match(/^https?:/)){var r=document.location.protocol,n=e.split("//")[0];n!=r&&(e=e.replace(new RegExp("^"+n),r));var i=e.split("//")[1].split("/")[0];i!=document.location.host&&(e=e.replace(i,document.location.host))}var o=this;this.updating=!1,this.abort=function(){o.updating&&(o.updating=!1,o.AJAX.abort(),o.AJAX=null)},this.update=function(e,t,r){if(r="undefined"!=typeof r?r:!0,o.updating)return!1;if(o.AJAX=null,window.XMLHttpRequest?o.AJAX=new XMLHttpRequest:o.AJAX=new ActiveXObject("Microsoft.XMLHTTP"),null==o.AJAX)return!1;if(o.AJAX.onreadystatechange=function(){4==o.AJAX.readyState&&(o.updating=!1,o.callback(o.AJAX.responseText,o.AJAX.status,o.AJAX.responseXML),o.AJAX=null)},o.updating=new Date,/post/i.test(t)){var n=a;o.AJAX.open("POST",n,r),o.AJAX.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.AJAX.send(e)}else{var n=a+"?"+(""==e?"":e+"&")+"timestamp="+o.updating.getTime();o.AJAX.open("GET",n,r),o.AJAX.send(null)}return!0};var a=e;this.callback=t||function(){}}function getStockNodes(){var e=new Array;if(document.evaluate){for(var t="//*[contains(@class, 'ActinicRTS')]",r=document.evaluate(t,document,null,0,null);e[e.length]=r.iterateNext(););e.pop()}else if(document.getElementsByTagName)for(var n=document.getElementsByTagName("*"),i=0,o=n.length;o>i;i+=1)n[i].className.indexOf&&-1!=n[i].className.indexOf("ActinicRTS")&&e.push(n[i]);return e}function getProductStock(e,t,r,n){return getStock(e,null,t,r,n)}function getSectionStock(e,t,r,n,i){return $(".ActinicRTS").length||!$.isEmptyObject(g_mapProds)?getStock(e,t,r,n,i):void 0}function getStock(e,t,r,n,i){if(0==e.indexOf("file://")){for(var o=r.split("|"),a=n.split("|"),l=0;l<o.length;l++){var s=o[l].split("!"),d=s[s.length-1];g_mapStockByRef[d]=a[l]}updateStockDisplay(g_mapStockByRef,!0)}else{g_bStockUpdateInProgress=!0;var c=new ajaxObject(e);c.callback=function(n){if(n.match(/^-?\d+$/)?g_mapStockByRef[r]=n:n&&(g_mapStockByRef=n.parseJSON()),updateStockDisplay(g_mapStockByRef,!0),g_bStockUpdateInProgress=!1,g_bDynamicPriceUpdatePending&&""!==g_sDynamicPriceURL)if(void 0==t){var o=GetSIDAnchor();if(""==o){var a=GetInputElement(document,"PAGE");if(a&&"PRODUCT"==a.value){var l=GetInputElement(a.form,"SID");l&&(o=l.value)}}o&&getAllDynamicPrices(g_sDynamicPriceURL,o,i)}else getAllDynamicPrices(g_sDynamicPriceURL,t,i);else g_bChoicesUpdatePending&&(SetupChoicesAllProducts(e,t,i),g_bChoicesUpdatePending=!1)};var u=null!=t?"ACTION=GETSECTIONSTOCK&SID="+t:"ACTION=GETSTOCK&REF="+encodeURIComponent(r);null==t&&nAssocProdRefSID>0&&(u+="&SID="+nAssocProdRefSID),i&&(u+="&SHOP="+i),c.update(u,"GET")}}function updateStockDisplay(e,t){for(var r={},n=/\brts_([^_]+)_/,i=/\bchk_(v_[^_]+_\d+)_/,o=document.getElementsByTagName("SELECT"),a=0;a<o.length;a++){var l=o[a];if(0==l.name.indexOf("v_")){var s=null,d=l.className.match(i);d&&(s=document.getElementsByName(d[1])[0]);for(var c=0,u=!1,p=!1,m=0;m<l.options.length;m++){var g=l.options[m];(""==g.value||-1==g.value)&&(s=g,u=!s.selected);var f=g.className,d=f.match(n);if(d){var v=d[1];void 0!=e[v]&&e[v]<=0?(g.disabled=!0,g.selected&&(g.selected=!1,p=!0)):(g.disabled=!1,c++,1==c&&(p||t)&&(g.selected=!0))}else g.value>0&&(c++,1==c&&t&&(g.selected=!0))}if(0==c||s&&!u)if(!s||"INPUT"!=s.tagName&&-1!=s.value)if(s&&""==s.value&&c>0)"OPTION"==s.tagName&&t&&(s.selected=!0);else{var h=l.name.match(/^v_([^_]+)_/)[1];r[h]=1,0==c&&l.options.length>0&&"undefined"!=typeof l.options[0]&&"OPTION"==l.options[0].tagName&&(l.options[0].selected=!0)}else"OPTION"==s.tagName?t&&(s.selected=!0):0==c&&(s.checked=!1,s.disabled=!0)}}for(var S={},P={},C=document.getElementsByTagName("INPUT"),a=0;a<C.length;a++){var u=!1,_=C[a];if("checkbox"==_.type){var I=_.name.match(/^v_([^_]+)/);I&&(P["_"+I[1]]=_),u=_.checked}var d=_.className.match(n);if(d){var y=_.name;if(!S[y]){var s="checkbox"==_.type?_:null;d=_.className.match(i),d&&(s=document.getElementsByName(d[1])[0]),!s&&P[y]&&(s=P[y]);for(var c=0,A=document.getElementsByName(y),T=0;T<A.length;T++){var b=A[T];if(-1==b.value&&(s=b),d=b.className.match(n)){var v=d[1];void 0!=e[v]&&e[v]<=0?(b.disabled=!0,"submit"==b.type&&(b.parentNode.style.display="none")):(b.disabled=!1,c++,1==c&&t&&u&&(b.checked=!0))}else("submit"==b.type||b.value>0)&&(b.disabled=!1,c++,1==c&&t&&(b.checked=!0))}if(!c)if(s)"radio"==s.type?t&&(s.checked=!0):(t&&(s.checked=!1),s.disabled=!0);else{var h=0==y.indexOf("_")?y.substr(1):y.match(/^v_([^_]+)_/)[1];r[h]=1}S[y]=1}}}for(var R=getStockNodes(),E=0;E<R.length;E++){var D=R[E].id.split("_"),L=D[D.length-1],M=GetProductFromMap(L),N=-1;if(M&&M.bAssemblyProduct){if(M.arrComps)for(var a=0;a<M.arrComps.length;a++){var O=M.arrComps[a],F=O.nQ?O.nQ:1;if(null!=e[O.sAsscProdRef]&&!O.bOpt){!r[L]&&!O.bOpt&&null!=O.sAsscProdRef&&F>e[O.sAsscProdRef]&&(r[L]=1);var w=Math.floor(e[O.sAsscProdRef]/F);N=-1==N?w:Math.min(N,w)}}-1==N&&(r[L]=1)}var k=D[0];if(null!=e[L]){var B=IsInStock(L,e,r);"StockLevel"==k&&(M&&M.bAssemblyProduct&&N>-1?R[E].innerHTML=N:R[E].innerHTML=e[L]);var G=$(R[E]);if(G.filter("[data-message]").html(G.attr("data-message")).removeAttr("data-message"),"EnableIfOutOfStock"==k)if(B)R[E].style.visibility="hidden",R[E].style.display="none";else{R[E].style.visibility="visible",R[E].style.display="inline";var H=GetElementByName("Q_"+L);H&&(H.value=0,H.disabled=!0)}"RemoveIfOutOfStock"==k&&(B||(R[E].innerHTML="")),"EnableIfInStock"==k&&(B?(R[E].style.visibility="visible",R[E].style.display="inline"):(R[E].style.visibility="hidden",R[E].style.display="none")),"RemoveIfInStock"==k&&B&&(R[E].innerHTML=""),"EnableIfStockOk"==k&&(R[E].style.visibility="visible",R[E].style.display="inline")}}}function DisableOOSComponents(e,t){for(var r=document.getElementsByName(e),n=0;n<r.length;n++){var i=r[n];"SELECT"==i.tagName?0==i.options.length?HandleAllChoicesOutOfStock(e,t):1==i.options.length&&(-1==i.options[0].value?i.options[0].selected=!0:i.options[0].value||(i.options[0].selected=!1,HandleAllChoicesOutOfStock(e,t))):1==r.length&&(-1==i.value?i.checked=!0:i.value||(i.disabled=!0,HandleAllChoicesOutOfStock(e,t)))}0==r.length&&HandleAllChoicesOutOfStock(e,t)}function HandleAllChoicesOutOfStock(e,t){if(t){var r=GetElementByName(t);r.checked=!1,r.disabled=!0}else DisableAddToCart(e)}function DisableAddToCart(e){var t=e.match(/v_([^_]+)_/);if(t){var r=t[1],n=GetElementByName("Q_"+r);n&&(n.value=0,n.disabled=!0);var i=document.getElementById("EnableIfOutOfStock_"+r);i&&(i.style.visibility="visible",i.style.display="inline"),i=document.getElementById("RemoveIfOutOfStock_"+r),i&&(i.innerHTML=""),i=document.getElementById("EnableIfInStock_"+r),i&&(i.style.visibility="hidden",i.style.display="")}}function GetElementByName(e){var t=document.getElementsByName(e);return 0==t.length?null:t[0]}function AttachEvent(e,t,r){e&&("on"==t.substring(0,2)&&(t=t.substring(2,t.length)),e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent&&e.attachEvent("on"+t,r))}function ValidateCartNameDetails(){if(document.location.href.indexOf("SID=")>-1){document.location.href.match(/\bSID=(\d+)/);var e=RegExp.$1,t=GetInputElement(document,"ACTION_BUYNOW"),r=t.form,n=GetInputElement(r,"SID");n||(n=document.createElement("INPUT"),n.type="hidden",n.name="SID",r.appendChild(n)),n.value=e}var i=document.getElementById("idRowCartNamePassword");if(!i)return!0;if("none"==i.style.display)return i.style.display="",!1;var o=document.getElementById("idCartName");return""==o.value?(alert("Username must be filled in"),!1):(o=document.getElementById("idCartPassword"),""==o.value?(alert("Password must be filled in"),!1):!0)}function DeliveryCountryChanged(){CountryChanged("Delivery")}function InvoiceCountryChanged(){CountryChanged("Invoice")}function CountryChanged(e){var t=document.getElementById("lst"+e+"Country"),r=document.getElementById("lst"+e+"Region");if(!t)return void(r&&(r.style.display="none"));if(SetCountryTextFieldDisplay(e,""),r&&r.options){var n=document.getElementById("id"+e+"RegionEdit"),i=n?n.value:"",o=r.value;if(r.options.length=1,"UndefinedRegion"==t.value)return r.style.display="none",void(n&&(n.style.display=""));var a=document.getElementById("idSEPARATESHIP"),l=a&&a.checked,s="Delivery"==e?g_mapDeliveryCountryStateMap:g_mapInvoiceCountryStateMap,d=s[t.value];if(d||"Invoice"!=e||l||!g_mapDeliveryCountryStateMap[t.value]||(d=g_mapDeliveryCountryStateMap[t.value]),!d)return r.style.display="none",void(n&&(n.style.display=""));r.style.display="",n&&(n.style.display="none");for(var c=!1,u=0;u<d.length;u+=2){var p=document.createElement("OPTION");p.text=d[u+1],p.value=d[u],(p.value==o||p.text==i)&&(c=!0,o=p.value,p.selected=!0),r.options.add(p)}c&&(r.value=o)}}function SetCountryTextFieldDisplay(e,t){var r="Delivery"==e?"idDELIVERCOUNTRYText":"idINVOICECOUNTRYText",n=document.getElementById(r);if(n){var i=document.getElementById("lst"+e+"Country");n.style.display=i&&"---"==i.value?t:"none"}}function SetDeliveryAddressVisibility(){if(document.getElementById("idInvoiceRule")||document.getElementById("idDeliveryRule"))return void SetAccountAddressVisibility();var e=SD.Responsive.getResponsiveDeliveryFields();SetInvoiceCountries();var t=IsElementChecked("idSEPARATESHIP");e?($("#idBothAddressesTable #idDeliverHeader").toggle(t),$("#idBothAddressesTable > > .DeliverField:not(#idSeparateShipRow)").toggle(t),$("#idBothAddressesTable > > .InvoiceField:not(#idSeparateShipRow)").toggleClass("wideInput",!t)):($("#idSeparateShipCell").attr("colSpan",$("#idDeliverHeader").length&&t?2:1),$("#idBothAddressesTable > > tr > td.DeliverField").toggle(t)),$("#idINVOICERESIDENTIAL").toggle(!t),InvoiceCountryChanged()}function SetAccountAddressVisibility(){var e=SD.Responsive.getResponsiveDeliveryFields(),t=function(t,r,n){e?$("#idBothAddressesTable >").children("."+t).filter("div:not(#idInvoiceAccountAddresses, #idDeliverAccountAddresses, #idSeparateShipRow)").toggle(r).toggleClass("wideInput",r&&!n):$("#idBothAddressesTable tr:not(.ShowAlways) ."+t).children().filter(":not([id^='pcaDiv'])").toggle(r)},r=IsElementChecked("idINVOICEADDRESSSELECT_0"),n=IsElementChecked("idDELIVERADDRESSSELECT_0"),i=r||n,o;if(o=e?$("#idBothAddressesTable >").children("div:not(#idInvoiceAccountAddresses, #idDeliverAccountAddresses), label, input"):$("#idBothAddressesTable > > tr:not(.ShowAlways)"),o.toggle(i),i){var a=!1;n&&(!r||IsElementChecked("idSEPARATESHIP"))&&(a=!0);var l=r&&a;t("InvoiceField",r,l),r&&InvoiceCountryChanged(),t("DeliverField",a,l),a&&DeliveryCountryChanged(),$("#idSeparateShipRow").toggle(r&&n)}}function IsElementChecked(e){var t=document.getElementById(e);return t&&t.checked?!0:!1}function SetShoppingCartVisibility(){var e=document.getElementById("idShowHide");if(e){var t=document.getElementById("idShoppingCartGrid");if(t){var r=document.getElementById("idCartHeadingTotal"),n=document.getElementById("idCartChangeCell");"none"==t.style.display?(setCookie("cartDisplayPreference","show"),t.style.display="",e.innerHTML="hide",r.style.display="none",n&&(document.getElementById("idCartChangeCell").style.display="")):(setCookie("cartDisplayPreference","hide"),t.style.display="none",e.innerHTML="show",r.style.display="",n&&(document.getElementById("idCartChangeCell").style.display="none"))}}}function HideCartDetailsOnCheckoutPages(){var e=getCookie("cartDisplayPreference");"show"!==e&&SetShoppingCartVisibility()}function SetCreditCardFieldsVisibility(){return $("#idPaymentMethodTable .CreditCardField").toggle("10005"==GetPaymentMethod()),"90"!==GetPaymentMethod()?void $("#idPaymentMethodTable .v12FinanceFields").hide():void GetAvailableFinanceProducts()}function CheckForm(e){for(var t=e.parentElement?e.parentElement:e.parentNode;t&&"FORM"!=t.tagName;)t=t.parentElement?t.parentElement:t.parentNode;if(!t)return!0;$("#idCheckoutForm").append('<input type="hidden" name="JS" value="1" />'),AddHiddenShipClass(e);var r=document.getElementsByName("INVOICEADDRESSSELECT").length>0,n=!1;r&&(n=!IsElementChecked("idINVOICEADDRESSSELECT_0"));var i=document.getElementById("idSEPARATESHIP"),o=!1;if(r&&(o=!IsElementChecked("idDELIVERADDRESSSELECT_0")),o||(o=i&&!i.checked),n&&o)return!0;for(var a=GetAllElements(t),l=0;l<a.length;l++){var s=a[l];if("idINVOICEEMAIL_CONFIRM"==s.id&&!n||"idDELIVEREMAIL_CONFIRM"==s.id&&!o){var d=document.getElementById(s.id.replace(/_CONFIRM$/,""));if("none"!=d.style.display&&d.value!=s.value){var c=GetLabelText(s)+"\n\n";return c+="'"+s.value+"' does not match '"+d.value+"'",alert(c),s.focus(),!1}}if("idNEWCUSTOMERPASSWORD2"==s.id&&(IsElementChecked("idCREATEANACCOUNT")||null==document.getElementById("idCREATEANACCOUNT"))){var u=document.getElementById("idNEWCUSTOMERPASSWORD");if("none"!=u.style.display&&u.value!=s.value){var c=PASSWORD_MATCH_ERROR;return alert(c),s.focus(),!1}}}return n&&!o&&(i.checked=!0),!0}function AddHiddenShipClass(e){try{$("#idPickupSelect").length&&$("#lstClass").length&&$("#lstClass").prop("disabled")&&$(e).append('<input type="hidden" name="ShippingClass" value="'+$("#lstClass").val()+'" />')}catch(t){alert("A problem occurred while submitting this page. Error: "+t.message)}}function GetAllElements(e){return e.all?e.all:e.getElementsByTagName?e.getElementsByTagName("*"):void 0}var g_sConfirmOrderInitText="";function SubmitPSPForm(e){if("90"===GetPaymentMethod()){var t=CheckMinMaxDeposit();if(""!==t)return $("#idFinanceDepositError").html(t),$("#idFinanceDepositError").show(),$("#idFinanceDeposit").focus(),!1}var r=GetPaymentMethod();if(-1==r)return!0;var n=document.getElementById("idSpanPSPForm");return n&&(n.innerHTML='<div id="pspwait" style="display:none;">Saving your order... Please wait</div>',ShowPSPWait("pspwait"),ShowPSPForm()),r>=1e4&&3e4>r?!0:(GetPSPFormAndSubmit(r,e),!1)}var g_bConfirmOrderDone=!1;function SubmitPPEForm(e){return g_bConfirmOrderDone?(alert("Your order is being completed"),!1):(g_bConfirmOrderDone=!0,AddHiddenShipClass(e),e.submit(),!1)}function GetPaymentMethod(){var e=document.getElementById("idPAYMENTMETHOD");if(e)return e.value;var t=document.getElementsByName("PAYMENTMETHOD");if(!t)return-1;if(1==t.length)return t[0].value;for(var r=0;r<t.length;r++)if(t[r].checked)return t[r].value;return-1}function GetPSPFormAndSubmit(e,t){var r=new ajaxObject(document.location.href.split("?")[0]);r.callback=function(t,r){if(200!=r||"Error:"==t.substring(0,6))return alert(t),void ShowPSPForm(!1);var n=document.getElementById("idSpanPSPForm");if(n){n.innerHTML=t;var i=document.getElementById("idPSPForm");return i?void i.submit():void RequireScript("psplib"+e+".htm.js",function(){GetPSPHelper()})}};var n="ACTION=GETPSPFORM&PAYMENTMETHOD="+e;t&&(n+="&SHOP="+t);var i=document.getElementsByName("PAYMENTPONO");i.length&&(n+="&PAYMENTPONO="+escape(i[0].value));var o=document.getElementsByName("PAYMENTUSERDEFINED");o.length&&(n+="&PAYMENTUSERDEFINED="+escape(o[0].value)),"90"===e&&(n+=GetParams()),r.update(n,"GET")}function CloseForm(){ShowPSPForm(!1)}function RequireScript(e,t){var r=document.createElement("script"),n=document.getElementsByTagName("script")[0];r.onerror=function(){alert("Error loading ["+e+"]. Please try another payment method."),ShowPSPForm(!1)},void 0!=t&&(r.onreadystatechange=function(){("loaded"===r.readyState||"complete"===r.readyState)&&t()},r.onload=function(){t()}),r.src=e,n.parentNode.insertBefore(r,n)}function ShowPSPForm(e){var t=document.getElementById("idDivPSPForm");t&&(null==e||e?t.style.display="inline":t.style.display="none")}function ShowPSPWait(e,t){null==t||t?(document.getElementById(e).style.display="inline",document.getElementById("pspwait").style.display="inline"):(document.getElementById("pspwait").style.display="none",document.getElementById(e).style.display="none")}function SFDropDownMenu(e){for(var t=document.getElementById(e).getElementsByTagName("LI"),r=0;r<t.length;r++)t[r].onmouseover=function(){this.className+=" sfhover"},t[r].onmouseout=function(){this.className=this.className.replace(new RegExp(" sfhover\\b"),"")}}function ShowHideHelp(e,t){var r=document.getElementById(e.id+"help");r&&(r.style.display=t)}function ShowHideHelpDiv(e,t){var r=document.getElementById(e.id+"help");if(r){var n=document.getElementById("idCheckoutHelp");if(n){var i=r.innerHTML,o=document.getElementById(e.id+"label");o&&"actrequired"==o.className&&(i+=" This is a required field."),n.innerHTML=""==t?i:""}}}function GetLabelText(e){var t=document.getElementById(e.id+"label");if(t||(t=document.getElementById(e.id.replace(/DELIVER/,"INVOICE")+"label")),t){var r=t.innerHTML;return r=r.replace(/(\n|\t)/," "),r=r.replace(/<.*?>/g,""),r=r.replace(/\s*\*$/,"")}return""}function SetFocusToID(e){var t=document.getElementById(e);t&&"none"!=t.style.display&&t.focus()}var g_sInvoiceCountryCode="";function SetInvoiceCountries(){var e=document.getElementById("lstInvoiceCountry");if(e&&e.options){var t=document.getElementById("idINVOICECOUNTRYText"),r=document.getElementById("idSEPARATESHIP"),n=r&&r.checked?!0:!1,i=e.value?e.value:g_sInvoiceCountryCode,o=""!=i&&"---"!=i||!t?"":t.value;e.options.length=1;var a="",l="";for(var s in g_arrCountries){var d=g_arrCountries[s],c=!0;if(c=g_bInvoiceLocationRestrictive?!n&&g_bDeliveryLocationRestrictive?d[2]&&d[3]:d[2]:g_bDeliveryLocationRestrictive&&!n?d[3]:d[2]||d[3]){var u=document.createElement("OPTION");u.value=d[0],u.text=d[1],i&&u.value==i&&(a=u.value),"---"!=i&&u.text==o&&(l=u.value),e.options.add(u)}}a&&(e.value=a),l&&(e.value=l),e.value&&(g_sInvoiceCountryCode=e.value)}}function StateDropdownChanged(e){var t=-1!=e.id.indexOf("Invoice")?"idInvoiceRegionEdit":"idDeliveryRegionEdit",r=document.getElementById(t);if(!r||"UndefinedRegion"==e.value)return void GetShippingClassesSelectHtml(e);var n=e.selectedIndex;r.value=e.options[n].text,GetShippingClassesSelectHtml(e)}function LoadXMLDoc(e,t){return window.XMLHttpRequest?xhttp=new XMLHttpRequest:xhttp=new ActiveXObject("Microsoft.XMLHTTP"),xhttp.open("GET",e,!1),xhttp.send(null),t?xhttp.responseXML:xhttp.responseText}function DOMDocFromXML(e){var t=null;if(window.ActiveXObject)t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e);else if(window.DOMParser){var r=new DOMParser;t=r.parseFromString(e,"text/xml")}return t}function DisplayFeefoFeedback(e,t,r,n,i,o){var a=escape("?logon="+n),l="FeefoFeedback";""!=i&&(a+=escape("&vendorref="+i),l+="_"+i),a+=escape("&limit="+e),a+=escape("&mozillahack=true");var s=r+"?ACTION=FEEFOXML&FEEFOPARAM="+a;o&&(s+="&SHOP="+escape(o));var d=LoadXMLDoc(s,!0);if(null!=d&&""!=d.xml){var c=LoadXMLDoc(t+"feedback.xsl",!1),u=/(feefo\.css|plus\.gif|minus\.gif)/gi;c=c.replace(u,t+"$1");var p=DOMDocFromXML(c);window.ActiveXObject?(ex=d.transformNode(p),document.getElementById(l).innerHTML=ex):document.implementation&&document.implementation.createDocument&&(xsltProcessor=new XSLTProcessor,xsltProcessor.importStylesheet(p),resultDocument=xsltProcessor.transformToFragment(d,document),document.getElementById(l).appendChild(resultDocument))}}function ShowBackLink(){var e=getCookie("LAST_SECTION_URL");if(e){var t=document.getElementById("idSPPBackLink");t&&(t.href=e,t.style.display="")}}function CheckPassword(e,t){if(!e.value||!t.value||e.value!=t.value){var r=PASSWORD_MATCH_ERROR,n=e;return e.value?t.value||(r="Please enter a value for "+GetLabelText(t),n=t):r="Please enter a value for "+GetLabelText(e),alert(r),n.focus(),!1}return!0}function GetScriptURL(){var e=document.location.href;return e.split("?")[0]}function IsLoggedIn(){var e=getCookie("ACTINIC_BUSINESS");if(!e)return!1;for(var t=e.split(/\n/),r=0;r<t.length;r++){var n=t[r].split(/\t/);if("USERNAME"==n[0]&&""!=n[1])return!0}return!1}function GetScriptPrefix(){var e=location.pathname.lastIndexOf("/");if(-1!=e){var t=location.pathname.substr(e+1);return t.substr(0,2)}}function SetBusinessCookies(e,t){e||(setCookie("CART_CONTENT","CART_TOTAL	0	CART_COUNT	0"),setCookie("ACTINIC_BUSINESS","BASEFILE"),document.location.replace(document.location.href.replace(/#logout$/,"")))}function OnKeyDownForm(){if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var e=new Number(RegExp.$1);if(e>=9&&13==window.event.keyCode){var t=window.event.srcElement;if("INPUT"==t.tagName&&("submit"==t.type||"button"==t.type))return;for(var r=0;r<t.form.all.length;r++){var n=t.form.all[r];if("INPUT"==n.tagName&&"submit"==n.type)return n.click(),window.event.cancelBubble=!0,void(window.event.returnValue=!1)}}}}function Sprintf(e){for(var t=e,r=1;r<arguments.length;r++)t=t.replace(/%s/,arguments[r]);return t}var g_mm_nMenuCloseTimeout=500,g_mm_nMenuHoverOpenTimeout=300,g_mm_closeTimer=null,g_mm_menuParent=null,g_mm_menuItem=null,g_mm_NO_MENU_ITEM=-1,g_mm_nIDRecentMouseOver=g_mm_NO_MENU_ITEM,g_mm_nIDCurrentMouseOver=g_mm_NO_MENU_ITEM,g_mm_timerRecentMouseOver=null,g_mm_timerDelayMouseOver=null,g_mm_nIDForMouseUp=g_mm_NO_MENU_ITEM,g_mm_nWindowsTouchOn=g_mm_NO_MENU_ITEM,g_mm_mapListenersAdded={},$ge=function(e){return document.getElementById(e)};function mmClick(e,t){return g_mm_nIDRecentMouseOver==t?(e.preventDefault&&e.preventDefault(),!1):void 0}function mmClose(){g_mm_menuItem&&(g_mm_menuItem.style.display="none",g_mm_menuItem=null),g_mm_menuParent&&(g_mm_menuParent.className="",g_mm_menuParent=null)}function mmCloseTime(){g_mm_nIDForMouseUp==g_mm_NO_MENU_ITEM?(g_mm_timerDelayMouseOver&&(window.clearTimeout(g_mm_timerDelayMouseOver),g_mm_timerDelayMouseOver=null),g_mm_closeTimer&&(window.clearTimeout(g_mm_closeTimer),g_mm_closeTimer=null),g_mm_closeTimer=window.setTimeout(mmClose,g_mm_nMenuCloseTimeout)):g_mm_nWindowsTouchOn=g_mm_nIDForMouseUp}function mmCancelCloseTime(){g_mm_closeTimer&&(window.clearTimeout(g_mm_closeTimer),g_mm_closeTimer=null),g_mm_menuParent&&(g_mm_menuParent.className="sel")}function mmOpen(e){return $("div.miniNav").is(":visible")&&"#"!=$("#main-link"+e).attr("href")?void(g_mm_nIDRecentMouseOver=g_mm_NO_MENU_ITEM):void(g_mm_nWindowsTouchOn!=e&&(g_mm_nIDRecentMouseOver=e,g_mm_timerRecentMouseOver&&window.clearTimeout(g_mm_timerRecentMouseOver),g_mm_timerRecentMouseOver=window.setTimeout(function(){g_mm_nIDRecentMouseOver=g_mm_NO_MENU_ITEM,g_mm_timerRecentMouseOver=null},g_mm_nMenuHoverOpenTimeout),g_mm_nIDCurrentMouseOver&&g_mm_nIDCurrentMouseOver!=g_mm_NO_MENU_ITEM?mmOpenCore(e):g_mm_timerDelayMouseOver=setTimeout(mmOpenCore.bind(null,e),g_mm_nMenuHoverOpenTimeout)))}function mmOpenCore(e){g_mm_nIDCurrentMouseOver=e,mmCancelCloseTime(),mmClose(),menuDiv=$ge("mega-menu"),g_mm_menuParent=$ge("main-link"+e),g_mm_mapListenersAdded["mouseup"+e]||(AddEvent(g_mm_menuParent,"mouseup",mmMouseUpHandler(e)),g_mm_mapListenersAdded["mouseup"+e]=!0),g_mm_menuItem=$ge("tc"+e),g_mm_menuItem.style.display="block";var t=menuDiv.offsetWidth,r=g_mm_menuItem.offsetWidth,n=findLeftPos(menuDiv),i=findLeftPos(g_mm_menuParent),o=t-i;if(r>t){var a=r-t;g_mm_menuItem.style.left=-1*(i+Math.floor(a/2)-n)+"px"}else i-n+r>t?g_mm_menuItem.style.left=-1*(i-n+r-t)+"px":g_mm_menuItem.style.left="0px"}function mmMouseUpHandler(e){var t=e;return function(){g_mm_nIDForMouseUp=t,window.setTimeout(function(){g_mm_nIDForMouseUp=g_mm_NO_MENU_ITEM},0)}}$(document).ready(function(){$("#mega-menu > ul").mouseleave(function(e){0==$(e.relatedTarget).parents().filter(e.currentTarget).length&&(g_mm_nIDCurrentMouseOver=g_mm_NO_MENU_ITEM)})});function findLeftPos(e){var t=0;if(e.offsetParent){do t+=e.offsetLeft;while(e=e.offsetParent);return t}}function findPosX(e){var t=0;if(e.offsetParent)for(;;){if(t+=e.offsetLeft,!e.offsetParent)break;e=e.offsetParent}else e.x&&(t+=e.x);return t}function findPosY(e){var t=0;if(e.offsetParent)for(;;){if(t+=e.offsetTop,!e.offsetParent)break;e=e.offsetParent}else e.y&&(t+=e.y);return t}function getDynamicAccPrice(e,t,r,n){var i=0==e.indexOf("file://"),o=r.sProdRef,a="";if(!i){var l="v_"+o+"_",s=document.getElementById("idVars"+o);if(s){if(r.arrComps)for(var d=r.arrComps,c=d.length,u=0;c>u;u++){var p=d[u],m=l+p.nUI,g=document.getElementsByName(m)[0];a+="checkbox"==g.type?"&"+m+"="+(g.checked?"on":"off"):"&"+m+"="+g.value,p.elemHTML=g}var f=GetAttributes(s),v=f[o];if(v)for(var h=parseInt(v[0].name.match(/_(\d+)$/)[1]),S=v.length,u=0;S>u;u++){var P=v[u];if(h=parseInt(P.name.match(/_(\d+)$/)[1]),r.arrComps){var C=GetAttrFromSuffix(r,h);C.elem||(C.elem=new CSelect(P))}if("radio"==document.getElementsByName(P.name)[0].type)for(var _=document.getElementsByName(P.name)[0],I=0;null!=_;){if(_.checked){a+="&"+P.name+"="+_.value;break}_=document.getElementsByName(P.name)[++I]}else a+="&"+P.name+"="+P.value}}var y="sPushBtnGridVariants_"+o;"undefined"!=typeof window[y]&&(a+="&"+window[y]);var A="Q_"+o;a+="&"+A+"="+document.getElementsByName(A)[0].value;var T=new ajaxObject(e);T.callback=function(e,t){if(200!=t){var n=document.getElementById("id"+r.sProdRef+"DynamicPrice"),i=document.getElementById("id"+r.sProdRef+"StaticPrice");return r.bOvrStaticPrice&&i&&!r.bQuantityBreak&&(i.style.visibility="visible",i.style.display=""),void(n&&(n.style.display="none",n.style.visibility="hidden"))}var a=document.getElementById("id"+o+"TaxExcPrice"),l=document.getElementById("id"+o+"TaxIncPrice"),s=document.getElementById("id"+r.sProdRef+"VATMsg");if(null!=e)try{var d=e.parseJSON();if(d.ErrorMsg)return s&&(s.style.visibility="hidden",s.style.display="none"),void(a?a.innerHTML=d.ErrorMsg:l&&(l.innerHTML=d.ErrorMsg));s&&(s.style.visibility="visible",s.style.display="");var c=d.Total,u=d.Total+d.Tax1+d.Tax2;a&&(a.innerHTML=FormatPrices(c)),l&&(l.innerHTML=FormatPrices(u))}catch(p){}};var b="ACTION=GETACCPRICE&PRODREF="+o+"&SID="+t;b+=a,n&&(b+="&SHOP="+n),T.update(b,"GET")}}function SetupChoicesAllProducts(e,t,r){for(var n in g_mapProds){var i=g_mapProds[n];if(i){var o="v_"+n+"_",a=document.getElementById("idVars"+n);if(a){if(i.arrComps){for(var l=i.arrComps,s=l.length,d=0;s>d;d++){var c=l[d],u=o+c.nUI,p=document.getElementsByName(u)[0];c.elemHTML=p}var m=GetAttributes(a),g=m[n];if(g){for(var f=parseInt(g[0].name.match(/_(\d+)$/)[1]),v=g.length,d=0;v>d;d++){var h=g[d];f=parseInt(h.name.match(/_(\d+)$/)[1]);var S=GetAttrFromSuffix(i,f);S.elem||(S.elem=new CSelect(h))}UpdateChoices(i,!0)}}(!i.bOvrStaticPrice||i.nPricingModel!=PRICING_MODEL_COMPONENTS_SUM||g_mapDynPrices[i.sProdRef]&&g_mapDynPrices[i.sProdRef].Total>0)&&UpdatePrice(i,e,t,r)}}}g_mapDynPrices={}}function getAllDynamicPrices(e,t,r){if($.isEmptyObject(g_mapProds))return"";var n=0==e.indexOf("file://");if(n)return SetupVariants(!0),"";if(g_bStockUpdateInProgress)return g_bDynamicPriceUpdatePending=!0,"";var i=new ajaxObject(e);i.callback=function(n,i){if(null!=n){if(200==i)try{g_mapDynPrices=n.parseJSON()}catch(o){}SetupChoicesAllProducts(e,t,r)}};var o="ACTION=GETALLPRICES&SID="+t,a="";a=SetupVariants(!0),o+=a,r&&(o+="&SHOP="+r),i.update(o,"GET"),g_bDynamicPriceUpdatePending=!1}function SetupVariantsForProduct(e,t){var r="",n=g_mapProds[e];if(n){var i="v_"+e+"_",o=document.getElementById("idVars"+e);if(o&&n.arrComps){for(var a=n.arrComps,l=a.length,s=0;l>s;s++){var d=a[s],c=i+d.nUI,u=document.getElementsByName(c)[0];t&&(r+="checkbox"==u.type?"&"+c+"="+(u.checked?"on":"off"):"&"+c+"="+u.value),d.elemHTML=u}var p=GetAttributes(o),m=p[e];if(m)for(var g=parseInt(m[0].name.match(/_(\d+)$/)[1]),f=m.length,s=0;f>s;s++){var v=m[s];g=parseInt(v.name.match(/_(\d+)$/)[1]);var h=GetAttrFromSuffix(n,g);if(h.elem||(h.elem=new CSelect(v)),t)if("radio"==document.getElementsByName(v.name)[0].type)for(var S=document.getElementsByName(v.name)[0],P=0;null!=S;){if(S.checked){r+="&"+v.name+"="+S.value;break}S=document.getElementsByName(v.name)[++P]}else r+="&"+v.name+"="+v.value}}if(t){var C="sPushBtnGridVariants_"+e;"undefined"!=typeof window[C]&&(r+="&"+window[C])}}return r}function SetupVariants(e){var t="";for(var r in g_mapProds)t+=SetupVariantsForProduct(r,e);return t}function GetInputElement(e,t){for(var r=e.getElementsByTagName("INPUT"),n=0;n<r.length;n++){var i=r[n];if(i.name==t)return i}return void 0}function GetOriginalRef(e){var t=e.split("!");return t[t.length-1]}function GetProductFromMap(e){if(g_mapProds[e])return g_mapProds[e];for(var t in g_mapProds)if(GetOriginalRef(t)==e)return g_mapProds[t]}function SetupDPDPickupOptions(e){if(null!=e.Error)return alert("There was an error in initializing the Collection Point Pickup service. Please select another shipping option"),$("#idDPDShippingType3").attr("disabled",!0),HideLoadingDialog(),void $("#idDPDShippingType1").click();$("#map").css("left","0"),$("#map").css("position","relative"),$("#map").css("width","100%"),$("#map").show(),g_mapPickupLocationsJSON=e;
var t=e.data.results,r=[];r.forEach(function(e){e.setMap(null)}),r=[];var n=new google.maps.LatLngBounds;t.forEach(function(e){var t=e.pickupLocation.addressPoint.latitude,i=e.pickupLocation.addressPoint.longitude,o=new google.maps.LatLng(t,i),a={organisation:e.pickupLocation.address.organisation,postcode:e.pickupLocation.address.postcode,locality:e.pickupLocation.address.locality,property:e.pickupLocation.address.property,street:e.pickupLocation.address.street,town:e.pickupLocation.address.town,county:e.pickupLocation.address.county,distance:Math.round(100*e.distance)/100,disabledaccess:e.pickupLocation.disabledAccess,parking:e.pickupLocation.parkingAvailable,openlate:e.pickupLocation.openLate,shortname:e.pickupLocation.shortName,openhours:e.pickupLocation.pickupLocationAvailability.pickupLocationOpenWindow,directions:e.pickupLocation.pickupLocationDirections},l=new google.maps.Marker({map:map,title:e.pickupLocation.address.organisation,position:o,pickupLocationCode:e.pickupLocation.pickupLocationCode,pickupLocationDetails:a});r.push(l),n.contains(o)||n.extend(o),l.addListener("click",function(){infowindow.open(map,l),infowindow.setContent(SetupInfoWindow(l))});var s=(""!=e.pickupLocation.address.organisation?e.pickupLocation.address.organisation+",":"")+(""!=e.pickupLocation.address.property?e.pickupLocation.address.property+",":"")+(""!=e.pickupLocation.address.street?e.pickupLocation.address.street+",":"")+(""!=e.pickupLocation.address.locality?e.pickupLocation.address.locality+",":"")+(""!=e.pickupLocation.address.postcode?e.pickupLocation.address.postcode+",":"")+(""!=e.pickupLocation.address.county?e.pickupLocation.address.county+",":"")+e.pickupLocation.address.town;g_mapCodeToDetail[e.pickupLocation.pickupLocationCode]=s,g_mapCodeToMarker[e.pickupLocation.pickupLocationCode]=l;var d="<option value='"+e.pickupLocation.pickupLocationCode+"'"+($("#idDPDPickupDefault").val()===e.pickupLocation.pickupLocationCode?" selected":"")+">"+s+"</option>";$("#idPickupSelect").append(d)}),google.maps.event.trigger(map,"resize"),map.fitBounds(n),$("#idPickupSelect").show(),SelChangePickupLocations(),HideLoadingDialog()}function SelectPickupLocation(e){e.preventDefault();var t=g_SelectedMarker;t&&($("#idPickupSelect").val(t.pickupLocationCode),$("input#idDPDPickupLocation").val(g_mapCodeToDetail[t.pickupLocationCode]),$("#idMapBtn").text("Selected"),$("#idMapBtn").prop("disabled",!0))}function SelChangePickupLocations(){var e=$("#idPickupSelect").val(),t=g_mapCodeToMarker[e];t&&($("input#idDPDPickupLocation").val(g_mapCodeToDetail[t.pickupLocationCode]),google.maps.event.trigger(t,"click"),$("#idMapBtn").text("Selected"),$("#idMapBtn").prop("disabled",!0))}function ShippingTypeChanged(e){switch(e){case"1":$("#map").hide(),$("#idPickupSelect").hide(),$("#idDeliveryDateFields").hide(),$("#lstClass").prop("disabled",!1),$("#lstClass > option").each(function(){$(this).attr("data-ship2shop")?$(this).prop("disabled",!0):$(this).prop("disabled",!1)}),$("#idSelectPickupLabel").hide(),$("#lstClass").children("option:enabled").eq(0).prop("selected",!0);break;case"2":$("#map").hide(),$("#idPickupSelect").hide(),$("#lstClass").prop("disabled",!1),SetupDeliveryDateList(),FilterClassList(),$("#idDeliveryDateFields").show(),$("#idSelectPickupLabel").hide();break;case"3":$("#idDeliveryDateFields").hide(),"undefined"==typeof g_mapPickupLocationsJSON.data&&"undefined"==typeof g_mapPickupLocationsJSON.error?(ShowLoadingDialog(),g_mapAJAXActions.GetDPDPickupLocations=SetupDPDPickupOptions,AddAJAXCall("GetDPDPickupLocations"),AJAXCall()):($("#map").show(),$("#idPickupSelect").show(),SelChangePickupLocations()),$("#lstClass > option").each(function(){return $(this).attr("data-ship2shop")?($(this).prop("disabled",!1),$("#lstClass").val(this.value),$("#lstClass").prop("disabled",!0),!1):void 0}),$("#idSelectPickupLabel").show()}}function SetupDeliveryDateList(){var e=new Date,t,r,n,i,o,a,l=6==e.getDay()||0==e.getDay(),s=5==e.getDay(),d=e.getHours()<12;if($("#idDeliveryDate").empty(),l||s&&!d){var c=1;switch(e.getDay()){case 0:c=2;break;case 6:c=3;break;case 5:c=4}e.setDate(e.getDate()+c)}else d?e.setDate(e.getDate()+1):e.setDate(e.getDate()+2);for(var u=0;u<g_nMaxDays;u++)r=aDaysOfWeek[e.getDay()],n=aMonths[e.getMonth()],i=e.getFullYear(),o=e.getDate(),a=o+" "+n+" "+i,t="<option value='"+a+"'"+($("#idDPDDateDefault").val()===a?" selected":"")+">"+r+" "+o+" "+n+", "+i+"</option>",$("#idDeliveryDate").append(t),e.setDate(e.getDate()+1)}function FilterClassList(){var e=new Date($("#idDeliveryDate").val());console.log(e.getDay());var t=new Date,r=t.getHours()<12,n=e.getDay()<6&&e.getDay()>0;$("#lstClass > option").each(function(){var t=!1;switch($(this).attr("data-filter")){case"w":$(this).prop("disabled",n?!1:!0);break;case"st":$(this).prop("disabled",6==e.getDay()?!1:!0);break;case"sn":$(this).prop("disabled",0==e.getDay()?!1:!0);break;default:$(this).prop("disabled",!0)}return!0}),$("#lstClass").children("option:enabled").eq(0).prop("selected",!0)}function SetupInfoWindow(e){var t=e.pickupLocationDetails,r=Array(7),n="";for(i=0;i<t.openhours.length;i++){if(n="",void 0!=r[t.openhours[i].pickupLocationOpenWindowDay]){var o=r[t.openhours[i].pickupLocationOpenWindowDay],a=o.substr(6);n=t.openhours[i].pickupLocationOpenWindowStartTime===a?o.substr(0,5)+"-"+t.openhours[i].pickupLocationOpenWindowEndTime:r[t.openhours[i].pickupLocationOpenWindowDay]+"|"+t.openhours[i].pickupLocationOpenWindowStartTime+"-"+t.openhours[i].pickupLocationOpenWindowEndTime}else n=t.openhours[i].pickupLocationOpenWindowStartTime+"-"+t.openhours[i].pickupLocationOpenWindowEndTime;r[t.openhours[i].pickupLocationOpenWindowDay]=n}var l='<div id="locationInfo"><table style="line-height:1.3"><tr><td><strong>'+t.shortname+"</strong><br>"+(""!=t.property?t.property+"<br>":"")+(""!=t.street?t.street+"<br>":"")+(""!=t.locality?t.locality+"<br>":"")+(""!=t.town?t.town+"<br>":"")+(""!=t.county?t.county+"<br>":"")+t.postcode+"<br>";return l+="Distance:"+t.distance+" miles<br>Car Parking:"+(t.parking?"Yes":"No")+"<br>Disabled Access:"+(t.disabledaccess?"Yes":"No")+"<br>",""!=t.directions&&(l+="Additional directions:"+t.directions+"<br>"),l+="</td><td>",l+="<strong>Normal opening hours:&nbsp;</strong><br>Mon:&nbsp;"+(void 0!=r[1]?r[1]:"Closed")+"<br>Tue:&nbsp;"+(void 0!=r[2]?r[2]:"Closed")+"<br>Wed:&nbsp;"+(void 0!=r[3]?r[3]:"Closed")+"<br>Thu:&nbsp;"+(void 0!=r[4]?r[4]:"Closed")+"<br>Fri:&nbsp;"+(void 0!=r[5]?r[5]:"Closed")+"<br>",void 0!=r[6]&&(l+="Sat:&nbsp;"+r[6]+"<br>"),void 0!=r[7]&&(l+="Sun:&nbsp;"+r[7]+"<br>"),l+="</td></tr></table>",l+="<strong>Latitude:</strong>"+e.position.lat().toFixed(5)+" | <strong>Longitude:</strong>"+e.position.lng().toFixed(5)+"<br>",l+='<div align="center"><button class="btn btn-primary" id="idMapBtn" onclick="SelectPickupLocation(event)">Select</button></div></div>',g_SelectedMarker=e,l}function SetDefaultShippingType(){var e=$("input[name=DPDShippingType]:checked").val();ShippingTypeChanged(e)}function GetUsedCoupons(e){if(0==e.indexOf("file://"));else{var t=new ajaxObject(e);t.callback=function(e,t){if(null!=e&&200==t)try{var r=document.getElementById("used-coupons");r.innerHTML=e}catch(n){}};var r="ACTION=GETUSEDCOUPONS";t.update(r,"GET")}}function RemoveCouponAtIndex(e,t){if(0==e.indexOf("file://"));else{var r=new ajaxObject(e);r.callback=function(e,t){if(null!=e&&200==t)try{var r=document.getElementById("used-coupons");r.innerHTML=e}catch(n){}};var n="ACTION=REMOVECOUPON&COUPONINDEX="+t+"&SHOWNOCART=1";r.update(n,"GET")}}function GetShippingClassesSelectHtml(e){if(-1!=e.id.indexOf("Delivery")){ShowLoadingDialog();var t=new ajaxObject(document.location.href.split("?")[0]);t.callback=function(e,t){if(HideLoadingDialog(),bDebug&&alert("Status: "+t+" Response: "+e),200!=t||"Error:"==e.substring(0,6))return void alert(e);var r=document.getElementById("idShippingSelect");r&&(r.innerHTML=e)};var r="ACTION=GETSHIPPINGSELECT&LocationDeliveryRegion="+encodeURIComponent(e.value);t.update(r,"GET")}}function IsInStock(e,t,r){var n=GetProductFromMap(e);return t[e]>0&&(!n||!n.bAssemblyProduct)||n&&n.bAssemblyProduct&&!r[e]?!0:!1}/***************************************************************
*
* ActinicSearch.js	-	utility functions for search functionality
*
* Copyright (c) 2012-2014 SellerDeck Limited
*
****************************************************************/
var g_bIsDebugging=!1,g_ErrorCode={TAG:1,LOGIC:2,IO:3,UNDEFINED:4};function ShowError(e,t){var r="";switch(t){case g_ErrorCode.TAG:r="Tag not found error";break;case g_ErrorCode.LOGIC:r="Logical error";break;case g_ErrorCode.IO:r="Input output error";break;case g_ErrorCode.UNDEFINED:r="Variable undefined error";break;default:r="Unknown error"}var n="Error: "+r+"\nMessage: "+e;g_bIsDebugging&&console.log(n)}function GetIEVersion(){var e=0;return/MSIE (\d+\.\d+);/.test(navigator.userAgent)&&(e=new Number(RegExp.$1)),e}function GetArrayIndex(e,t){if(Array.prototype.indexOf)return e.indexOf(t);for(var r=e.length,n=0;r>n;n++)if(e[n]===t)return n;return-1}function InsertSort(e){for(var t=1;t<e.length;t++){for(var r=e[t],n=t;e[n-1]>r;)e[n]=e[n-1],--n;e[n]=r}return e}function IsPreview(){return 0==window.location.href.indexOf("file://")?!0:!1}function EscapeRegExp(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function AutoSuggest(e){var t=500,r=!1,n,i=new Array,o=new Array,a={},l="",s=0,d={ENTER:13,ESC:27,SPACE:32,LEFTARROW:37,UP:38,RIGHTARROW:39,DOWN:40};if("undefined"!=typeof pg_sSearchScript&&e){"Quick Search"===e.value&&(e.value="");var c=document.createElement("div"),u=findPosX(e),p=findPosY(e);p+=e.offsetHeight,c.style.left=u+"px",c.style.top=p+"px";var m=document.createElement("ul");m.style.display="none",c.className="sf_suggestion",m.style.width=e.offsetWidth+"px",c.appendChild(m),e.parentNode.appendChild(c),e.onblur=function(){c.parentNode===e.parentNode&&e.parentNode.removeChild(c)},e.onkeypress=function(t){var r=e.AS_getKeyCode(t);return r==d.ENTER&&"none"!=m.style.display&&0!=s&&(e.AS_selectList(),s=0),!0},e.onkeyup=function(r){var n=e.AS_getKeyCode(r);switch(n){case d.LEFTARROW:case d.RIGHTARROW:case d.ENTER:return!1;case d.ESC:e.value="",s=0,e.AS_clearList();break;case d.UP:e.AS_navList("up");break;case d.DOWN:e.AS_navList("down");break;default:""==e.value?e.AS_clearList():(e.AS_clearTimer(),e.AS_setTimer(t))}},e.AS_getListItems=function(){var t=new Array,r=new Array,n={},o,s=pg_sSearchValidWordCharacters;s=s.replace(/([\^\$\.\*\+\?\=\!\:\|\\\/\(\)\[\]\{\}])/g,"\\$1");var d=new RegExp("[^"+s+"]"),c=e.value.split(d),u="";r.length=0;for(var p=0;p<c.length;p++)c[p]&&r.push(c[p]);var m=e.AS_getChangedSearchWord(r);if(u=m[m.length-1],m.length=0,"undefined"!=typeof u){var g=pg_sSearchScript,f=new ajaxObject(g);f.callback=function(i){if(""!==i){try{n=i.parseJSON()}catch(o){return}0!=n.count?(t=n.words,e.value.length>0?(e.AS_createList(t,r,u,!0),l=u):e.AS_clearList()):u&&(l=u,t.push(u),a[u]="",e.AS_createList(t,r,u,!1))}};var v="ACTION=MATCH&TEXT="+u;IsHostMode()&&(v+="&SHOP="+pg_sShopID),f.update(v,"GET"),i=r,e.AS_clearTimer()}},e.AS_getChangedSearchWord=function(t){var r=new Array;if(t.length>0)for(var n=0;n<t.length;n++)e.AS_findFromArray(i,t[n])?o.push(t[n]):r.push(t[n]);return r},e.AS_createList=function(t,r,n,i){if(e.AS_resetList(),t.length>0){for(var o=0;o<t.length;o++){var a=document.createElement("li");a.className="notselected";var l=document.createElement("a");l.href="javascript:void(0);",l.m_nIndex=o+1;var d=n+"<b>"+t[o].substr(n.length)+"</b>";i?l.innerHTML=d:l.innerHTML="<strike>"+d+"</strike>",a.m_nIndex=o+1,a.onmouseover=function(){e.AS_navListItem(this.m_nIndex)},l.onmousedown=function(){return s=this.m_nIndex,e.AS_selectList(this.m_nIndex),!1},a.appendChild(l),m.setAttribute("tabindex","-1"),m.appendChild(a)}m.style.display="block"}else e.AS_clearList()},e.AS_resetList=function(){for(var e=m.getElementsByTagName("li"),t=e.length,r=0;t>r;r++)m.removeChild(e[0])},e.AS_navList=function(t){s+="down"==t?1:-1;var r=m.getElementsByTagName("li");1>s&&(s=r.length),s>r.length&&(s=1),e.AS_navListItem(s)},e.AS_navListItem=function(e){s=e;for(var t=m.getElementsByTagName("li"),r=0;r<t.length;r++)t[r].className=r==s-1?"selected":"notselected"},e.AS_selectList=function(){for(var t=m.getElementsByTagName("li"),r=t[s-1].getElementsByTagName("a")[0],n=r.innerHTML.replace(/(<strike>(.*)<\/strike>)|(<[^>]+>)/g,""),o="",d=0;d<i.length;d++)"undefined"==typeof a[i[d]]&&(o+=i[d]===l?n+" ":i[d]+" ");e.value=o,e.AS_clearList()},e.AS_clearList=function(){m&&(m.style.display="none",selectedIndex=0),i.length=0},e.AS_getKeyCode=function(e){var t;if(!e)var e=window.event;return e.keyCode&&(t=e.keyCode),t},e.AS_findFromArray=function(e,t){for(var r=0;r<e.length;r++)if(e[r]==t)return!0;return!1},e.AS_setTimer=function(t){r||(n=setTimeout(e.AS_getListItems,t),r=!0)},e.AS_clearTimer=function(){r&&(clearTimeout(n),r=!1)}}}function AddAutoSuggest(){if(!IsPreview()){if("undefined"==typeof pg_sSearchScript||""===pg_sSearchScript){var e='Variable "pg_sSearchScript" undefined OR null, autosuggest may not work';return void ShowError(e,g_ErrorCode.UNDEFINED)}for(var t=0;t<document.forms.length;t++)document.forms[t]&&document.forms[t].SS&&(document.forms[t].SS.setAttribute("autocomplete","off"),document.forms[t].SS.setAttribute("onfocus","AutoSuggest(this)"))}}$(document).ready(function(){AddAutoSuggest(),AddOnFilter(),CheckHashChangeEvent()});var g_eResultLayout={STD:1,TABULAR:2,UNDEFINED:3},gArrSortedProductRefs=new Array,gArrResultSet=new Array,gArrayDefinedPropertiesSorted=new Array,gArrProperty=new Array,gArrFilterGrpIdSorted=new Array,gMapObjProductDetails={},gMapPropIdDecoratedChoices={},gMapInvalidProdRefs={},gMapInvalidEmptyPermsProdRefs={},gMapPropNameToPropId={},gMapFilterGrpIdToFilterGrpName={},gMapParams={},gMapProdRefToDecProdRef={},g_sSearchResultsTemplate="",g_sListStartTemplate="",g_sListRowStartTemplate="",g_sListCellStartTemplate="",g_sListCellEndTemplate="",g_sListRowEndTemplate="",g_sListEndTemplate="",g_sResultLayout=g_eResultLayout.UNDEFINED,g_nListColCount=0,gMapAltProdToParentProductRef={},gMapProdToAltProdArray={},gMapMatchedProducts={},g_sDefinedPropertiesPattern,gMapRefStock={},gMapChildToParentProducts={};gArrSortedProductRefs.length=0,gArrResultSet.length=0;var g_nProductMinIndex=0,g_nProductMaxIndex=0,g_nCurrenPageNumber=0,g_nIEVersion=0,g_eFilterTimer={Cache:1,Server:2,UNDEFINED:3},g_hFilterTimer,g_bFilterTimerOn=!1,g_bFirstLoad=!1,g_bCacheStock=!0,g_bClearAll=!1,g_bHasPresetOptions=!1,g_bUseStorageFromClick=!1,g_bUseStorageSortPage=!1,g_bSortOrder="",g_eFilterSettings={FILTER:1,SORTORDER:2,PAGINATION:3};function AddOnFilter(){if(!IsPreview()){var e=document.forms.filter;if("undefined"!=typeof e){if("undefined"==typeof pg_sSearchScript||""===pg_sSearchScript){var t='Variable "pg_sSearchScript" undefined OR null, filtering may not work';return void ShowError(t,g_ErrorCode.UNDEFINED)}g_nIEVersion=GetIEVersion();for(var r=document.forms.filter.elements,n=0;n<r.length;n++)"INPUT"!==r[n].tagName||"radio"!==r[n].type&&"checkbox"!==r[n].type?"INPUT"===r[n].tagName&&"submit"===r[n].type&&r[n].setAttribute("onclick",'OnFilter(this, "link", false); return false;'):r[n].setAttribute("onclick","OnFilter(this);");var i=GetSelectWithinSortForm("filter_sortorder");if(i&&i.setAttribute("onchange","OnSort(this);"),i=GetSelectWithinSortForm("filter_sortorder_static"),i&&i.setAttribute("onchange","OnSortStatic(this);"),"undefined"!=typeof e){var o=document.getElementById("SearchResults");if(o)g_sSearchResultsTemplate=o.innerHTML,g_sSearchResultsTemplate=g_sSearchResultsTemplate.replace(/(<actinic:xmltemplate name=\"ImageLine\">((.*?)|(.*?(\n))+.*?)<\/actinic:xmltemplate>)/gi,""),g_sSearchResultsTemplate=g_sSearchResultsTemplate.replace(/(<script(\s*)type=\"text\/template\">([^`]*?)<\/script>)/gi,"$3"),g_sSearchResultsTemplate=g_sSearchResultsTemplate.replace(/(<sd_script)/gi,"<script"),g_sSearchResultsTemplate=g_sSearchResultsTemplate.replace(/(<\/sd_script)/gi,"</script");else{var t='Element with id "SearchResults" not found in result template, search might not work properly';ShowError(t,g_ErrorCode.TAG)}if(g_sResultLayout=GetResultLayoutUsed(),g_sResultLayout===g_eResultLayout.TABULAR){var a="",l="",s="",d="",c="",u="";a=document.getElementById("S_LISTSTART"),l=document.getElementById("S_LISTROWSTART"),s=document.getElementById("S_LISTCELLSTART"),d=document.getElementById("S_LISTCELLEND"),c=document.getElementById("S_LISTROWEND"),u=document.getElementById("S_LISTEND"),a&&(g_sListStartTemplate=a.innerHTML,g_sListStartTemplate=g_sListStartTemplate.replace(/(&lt;)/gi,"<"),g_sListStartTemplate=g_sListStartTemplate.replace(/(&gt;)/gi,">")),l&&(g_sListRowStartTemplate=l.innerHTML,g_sListRowStartTemplate=g_sListRowStartTemplate.replace(/(&lt;)/gi,"<"),g_sListRowStartTemplate=g_sListRowStartTemplate.replace(/(&gt;)/gi,">")),s&&(g_sListCellStartTemplate=s.innerHTML,g_sListCellStartTemplate=g_sListCellStartTemplate.replace(/(&lt;)/gi,"<"),g_sListCellStartTemplate=g_sListCellStartTemplate.replace(/(&gt;)/gi,">")),d&&(g_sListCellEndTemplate=d.innerHTML,g_sListCellEndTemplate=g_sListCellEndTemplate.replace(/(&lt;)/gi,"<"),g_sListCellEndTemplate=g_sListCellEndTemplate.replace(/(&gt;)/gi,">")),c&&(g_sListRowEndTemplate=c.innerHTML,g_sListRowEndTemplate=g_sListRowEndTemplate.replace(/(&lt;)/gi,"<"),g_sListRowEndTemplate=g_sListRowEndTemplate.replace(/(&gt;)/gi,">")),u&&(g_sListEndTemplate=u.innerHTML,g_sListEndTemplate=g_sListEndTemplate.replace(/(&lt;)/gi,"<"),g_sListEndTemplate=g_sListEndTemplate.replace(/(&gt;)/gi,">"))}ResetSortOrder()}CacheProperties(),CacheFilterSections(),CacheDefinedPriceBands(),CachePriceBandPriceRange(),CacheDefinedChoices(),SetDefaultSelection(),SortFilterGroup(),g_bHasPresetOptions=HasPresetFilterOptions(),SetSelectionMapsFromStorage(),SetStoredPageNumber(),IsFilterCountEnabled()?OnFilter(null,null,!0):(GenerateDynamicFilterOptions(),IsFilterAsDefaultView()?OnFilter(null,null,!0):OnFilter(null,null,!1)),HideModifyStaticControls()}}}function HasFilterStorage(){var e=SDStorage.readPage("filterSettings");return null===e||""===e?!1:!0}function IsUseFilterStorage(){return-1==window.location.hash.search("usestorage")?!1:!0}function CacheProperties(){for(var e=0;e<pg_arrayPropertyName.length;e++)if("undefined"!=typeof pg_arrayPropertyName[e]){var t=pg_arrayPropertyName[e].replace(/(&#95;)/g,"_"),r=t.split(":"),n=r[0],i=r[1],o=n.substr(n.lastIndexOf("_")+1),a=(i+"_"+o).toUpperCase();gMapPropNameToPropId[a]=n,gMapFilterGrpIdToFilterGrpName[n]=a,gArrFilterGrpIdSorted.push(n),gArrayDefinedPropertiesSorted.push(a),gArrProperty.push(n)}InsertSort(gArrayDefinedPropertiesSorted),g_sDefinedPropertiesPattern="-"+gArrayDefinedPropertiesSorted.join("--")+"-"}function SortFilterGroup(){InsertSort(gArrFilterGrpIdSorted)}function GetSelectWithinSortForm(e){var t=document.forms[e];if("undefined"!=typeof t){var r=t.elements;if("undefined"!=typeof r)for(var n=0;n<r.length;n++)if("SELECT"===r[n].tagName)return r[n]}return null}function OnFilter(e,t,r,n){var i="",o=document.forms.filter;if("undefined"!=typeof e&&null!==e&&AppendUseStorageHash(g_eFilterSettings.FILTER),g_bUseStorageFromClick&&(ResetAllStorage(),g_bUseStorageFromClick=!1),ResetSortOrder(),"undefined"!=typeof e&&null!==e&&-1!=g_nCurrenPageNumber&&SetCurrentPageNumber(0),g_bFirstLoad=r?!0:!1,g_bClearAll=n?!0:!1,g_bFirstLoad||ClearCtrlSelectionMap(),ClearURLParamCache(),ShowLoadingDialog(),i+="PAGE=DynamicFilter&","undefined"!=typeof e&&"undefined"!=typeof t&&"link"===t&&!g_bFirstLoad&&"update_lnk"!==e.id&&"update_btn"!==e.id){var a="hf_"+e.name,l="";l=document.getElementById(a),l&&l.parentNode.removeChild(l);var s="";s="PR"===e.name?"hf_PR":"SX"===e.name?"hf_SX":"hf_"+e.id;var d="";if(9>g_nIEVersion&&0!==g_nIEVersion?d=document.createElement('<input name="'+s+'">'):(d=document.createElement("input"),d.name=s),d.id="hf_"+e.name,d.type="hidden",d.value=e.value,e.parentNode.appendChild(d),null!==e.parentNode){var c=GetParent("li",e);EditLabel(c)}}if(ReadFilterParamsFromPage(),IsFilterCountEnabled()&&HideOptionAny(),ClearButtonHandler(),!IsFilterCountEnabled()&&!IsFilterAsDefaultView()||g_bFirstLoad){if(!g_bFirstLoad&&(g_bClearAll||GetClearButtonCount()<1))return void HideLoadingDialog();if(g_bFirstLoad&&g_bCacheStock&&CacheStockFilter(),i+=GetURLParam(g_bClearAll),IsHostMode()&&(i+="SHOP="+pg_sShopID+"&"),(IsFilterCountEnabled()||IsFilterAsDefaultView())&&(i+="SID="+pg_nCurrentFilterSectionID+"&"),o.Action){var u=o.Action.value;i+="Action="+u}ClearFilterTimer(),SetFilterTimer(g_eFilterTimer.Server,i)}else ClearFilterTimer(),SetFilterTimer(g_eFilterTimer.Cache)}function ReadFilterParamsFromPage(){for(var e=document.forms.filter,t=e.elements,r=0;r<t.length;r++){var n="",i="",o="",a=!1,l="",s="",d=!1;if("INPUT"!==t[r].tagName||"checkbox"!==t[r].type&&"radio"!==t[r].type)if("INPUT"===t[r].tagName&&"hidden"===t[r].type&&"PAGE"!==t[r].name&&"FILTERPAGE"!==t[r].name&&"ACTINIC_REFERRER"!==t[r].name&&"Action"!==t[r].name&&null===t[r].name.match(/hf_/g))l=t[r].name,s=t[r].value,a=!0;else if("SELECT"===t[r].tagName){var c=t[r];o=GetSelections(c),a=!1,d=!0}else if("INPUT"===t[r].tagName&&"hidden"===t[r].type){if("hf_"===t[r].name.substr(0,3)){var u=t[r].name.substr(3,t[r].name.length);l=u.split("-")[0],s=t[r].value,"PR"===l||"SX"===l?n=s:(n=u,i=s),a=!0}}else a=!1;else t[r].checked===!0?(l=t[r].name,s=t[r].value,"SX"===l?n=s:(n=t[r].id,i=t[r].value),a=!0):a=!1;if(a){var p=encodeURIComponent(s).replace(/!|'|\(|\)|\*|%20|%C2/g,function(e){return{"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A","%20":"+","%C2":""}[e]});g_bFirstLoad||GetControlSelections(l,n,i),CacheURLParams(l,p)}}}function ClearButtonHandler(){for(var e in gMapFilters){var t=IsShowClearButton(e);ShowHideClearButton(t,e)}GetClearButtonCount()<1&&ShowSectionContent()}function SetFilterTimer(e,t){g_bFilterTimerOn||(g_hFilterTimer=setTimeout(function(){e===g_eFilterTimer.Cache?FilterProductsFromCache():e===g_eFilterTimer.Server&&FilterProductsFromServer(t)},25),g_bFilterTimerOn=!0)}function ClearFilterTimer(){g_bFilterTimerOn&&(clearTimeout(g_hFilterTimer),g_bFilterTimerOn=!1)}function FilterProductsFromServer(e){if(!IsLoggedIn()&&"undefined"!=typeof pg_bFilteringCacheEnabled&&0!==pg_bFilteringCacheEnabled&&(IsFilterCountEnabled()||IsFilterAsDefaultView())){var t=new XMLHttpRequest,r="AjaxProductList_"+pg_nUploadReferenceNumber+"_"+pg_nCurrentFilterSectionID+".js";try{if(t.open("GET",GetFilterCacheURL(r),!1),t.send(),200===t.status||304===t.status){var n={};try{n=t.responseText.parseJSON()}catch(i){return void GetProductListFromServer(e)}if(0!=n.ProductSearchResults.ResultCount){gArrResultSet.length=0,gArrResultSet=n.ProductSearchResults.ResultSet;var o=GetSortOrder();DoSort(o,gArrResultSet),RetrieveProductDetails(g_nCurrenPageNumber,!0)}else(!g_bFirstLoad||IsFilterAsDefaultView())&&FormatResultHTML(!1,null,null,!1);return void HideLoadingDialog()}}catch(i){}}GetProductListFromServer(e)}function GetProductListFromServer(e){var t=pg_sSearchScript,r=new ajaxObject(t);r.callback=function(e){if(""!==e){var t={};try{t=e.parseJSON()}catch(r){return void ShowJSONError(r)}if(0!=t.ProductSearchResults.ResultCount){gArrResultSet.length=0,gArrResultSet=t.ProductSearchResults.ResultSet;var n=GetSortOrder();DoSort(n,gArrResultSet),RetrieveProductDetails(g_nCurrenPageNumber,!0)}else(!g_bFirstLoad||IsFilterAsDefaultView())&&FormatResultHTML(!1,null,null,!1),HideLoadingDialog()}},r.update(e,"GET")}function FilterProductsFromCache(){if(GetClearButtonCount()<1?(ClearCtrlSelectionMap(),g_bClearAll=!0):g_bClearAll=!1,g_bClearAll&&!IsFilterAsDefaultView())return UpdateFilterCount(),void HideLoadingDialog();var e="";g_bClearAll||(e=GetFilterPatternForResult()),gArrResultSet.length=0;var t=GetFilteredProducts(e);gArrResultSet=GetDecoratedProdRefs(t);var r=GetSortOrder();DoSort(r,gArrResultSet),RetrieveProductDetails(g_nCurrenPageNumber,!0)}function GetDecoratedProdRefs(e){for(var t=new Array,r=0;r<e.length;r++){var n=e[r];"undefined"!=typeof gMapProdRefToDecProdRef[n]&&t.push(gMapProdRefToDecProdRef[n])}return t}function GetFilterPatternForResult(){var e={},t="";for(var r in gMapFilterGrpIdToFilterGrpName)if("undefined"!=typeof gMapControlToSelection[r]){var n=gMapControlToSelection[r],i=new Array,o="";if("PR"===r)for(var a in n){var l=r+"_"+a;i.push(l)}else if("SX"===r){var s={};for(var a in n){s[a]="";for(var d=gMapFilters.SX[a].m_arrSubSectionIds,c=0;c<d.length;c++)-1!==GetArrayIndex(gArraySectionIDs,d[c])&&(s[d[c]]="")}for(var u in s){var l=r+"_"+u;i.push(l)}}else for(var p in n)if("undefined"!=typeof gMapControlIdChoiceName[p]){var l=r+":"+gMapControlIdChoiceName[p];i.push(l)}i.length>0&&(e[r]="(\\!"+i.join("\\!|\\!")+"\\!)")}for(var m=0;m<gArrFilterGrpIdSorted.length;m++){var g=gArrFilterGrpIdSorted[m];"undefined"!=typeof e[g]&&(t.length>0&&(t+=".*"),t+=e[g])}return t}function CacheURLParams(e,t){"undefined"!=typeof gMapParams[e]?gMapParams[e].push(t):(gMapParams[e]=new Array,gMapParams[e].push(t))}function ClearURLParamCache(){for(var e in gMapParams)gMapParams[e]=new Array}function GetURLParam(e){var t="",r=!1;if(e&&UpdateDefaultParams(),(IsFilterAsDefaultView()||IsFilterCountEnabled())&&g_bFirstLoad){for(var n in gMapDefCtrlSelections)"undefined"!=typeof gMapParams[n]&&(gMapParams[n]=new Array,gMapParams[n].push(""));"undefined"!=typeof gMapParams.PR&&(gMapParams.PR=new Array,gMapParams.PR.push("-1")),"undefined"!=typeof gMapParams.SX&&(gMapParams.SX=new Array,gMapParams.SX.push("-1"))}for(var i in gMapParams){var o=gMapParams[i],a=o.length;if(0!=a)for(var l=0;a>l;l++){var s=o[l];t+=i+"="+s+"&"}else{var s="";("PR"===i||"SX"===i)&&(s="-1"),t+=i+"="+s+"&"}}return t}function UpdateDefaultParams(){var e="";for(var t in gMapDefCtrlSelections){var r=t+"-"+gMapDefCtrlSelections[t],n="";"undefined"!=typeof gMapControlIdChoiceName[r]&&(n=gMapControlIdChoiceName[r]);var i=encodeURIComponent(n).replace(/!|'|\(|\)|\*|%20|%C2/g,function(e){return{"!":"%21","'":"%27","(":"%28",")":"%29","*":"%2A","%20":"+","%C2":""}[e]});"undefined"!=typeof gMapParams[t]&&(gMapParams[t]=new Array,gMapParams[t].push(i))}"undefined"!=typeof gMapParams.PR&&(gMapParams.PR=new Array,gMapParams.PR.push("-1")),"undefined"!=typeof gMapParams.SX&&(gMapParams.SX=new Array,gMapParams.SX.push("-1"))}function GetSelections(e){for(var t="",r="",n="",i=0;i<e.options.length;i++)if(e.options[i].selected===!0){var o=e.name,a=encodeURIComponent(e.options[i].value);t+=o+"="+a+"&","PR"===o||"SX"===o?r=e.options[i].value:(r=e.options[i].id,n=e.options[i].value),g_bFirstLoad||GetControlSelections(o,r,n),CacheURLParams(o,a)}return t}function ValidateMultipleListBox(e){for(var t=0,r=0;r<e.options.length;r++)e.options[r].selected===!0&&t++}function DoSort(e,t){var r=pg_sSortOrdersPrependedToProdRefs,n=e.split("_");n.push("0","0","0","0");for(var i=0;i<n.length;i++)n[i]=parseInt(n[i]);for(var o=r.split(","),i=0;i<o.length;i++)o[i]=parseInt(o[i]);var a={0:1,1:-1,2:1,3:-1,4:1,5:-1,6:1,7:-1,8:-1,9:-1,10:1,11:-1,12:1,13:-1,14:1,15:-1},l={0:0,1:1,2:2,3:2,4:4,5:4,6:6,7:7,8:8,9:9,10:10,11:10,12:12,13:12,14:14,15:14},s=o.length,d="^";d+="([0-9]*):",d+="([i|v])";for(var c=0;s>c;c++)d+="([0-9A-Za-z?_]{2}|{[0-9A-Za-z?_]{3}|}[0-9A-Za-z?_]{4})";d+="(.*)$";var u=new RegExp(d),p={};gArrSortedProductRefs.length=0;for(var i=0;i<t.length;i++){var m=t[i].match(u);if(m){var g=m[s+3],f=g.split(":");2==f.length&&(g=f[0],gMapAltProdToParentProductRef[g]=f[1]),gArrSortedProductRefs[i]=g,m[1]=String("0000000000"+m[1]).substr(-10,10),p[g]=m,"i"===m[2]&&(gMapInvalidProdRefs[g]=""),((IsFilterCountEnabled()||IsFilterAsDefaultView())&&g_bFirstLoad||!IsFilterCountEnabled())&&(gMapProdRefToDecProdRef[g]=t[i])}else{var v="Logical error occurred during sorting";ShowError(v,g_ErrorCode.LOGIC)}}for(var h={},S=0;s>S;S++)h[o[S]]=S+3;h[0]=s+3,h[1]=1;var P=new Array(a[n[0]],a[n[1]],a[n[2]],a[n[3]]),C=new Array(h[l[n[0]]],h[l[n[1]]],h[l[n[2]]],h[l[n[3]]]);gArrSortedProductRefs.sort(function(e,t){for(var r,n,i=0;4>i;i++){if(r=p[e][C[i]],n=p[t][C[i]],n>r)return-1*P[i];if(r>n)return P[i]}return 0})}function RetrieveProductDetails(e,t){var r=!1,n=!1;ShowLoadingDialog(),SetCurrentPageNumber(e),StoreSettings();var i=GetProdRefsOfNonCachedProductDetails(gArrSortedProductRefs);i.length>0&&(r=!0),n=i.length===gArrSortedProductRefs.length;var o=!1;if((t||r)&&(o=!0),r)if(IsLoggedIn()||"undefined"==typeof pg_bFilteringCacheEnabled||0===pg_bFilteringCacheEnabled||!IsFilterCountEnabled()&&!IsFilterAsDefaultView())UpdateProductDetailsFromServer(i,n,o);else{var a=new XMLHttpRequest,l="AjaxProductDetails_"+pg_nUploadReferenceNumber+"_"+pg_nCurrentFilterSectionID+".js";if(a.open("GET",GetFilterCacheURL(l),!1),a.send(),200===a.status||304===a.status){var s={};try{if(s=a.responseText.parseJSON(),0==s.ProductDetails.ProductInfoCount||s.ProductDetails.ProductInfoCount!==i.length)return void UpdateProductDetailsFromServer(i,n,o)}catch(d){return void UpdateProductDetailsFromServer(i,n,o)}UpdateProductDetails(s,o)}else UpdateProductDetailsFromServer(i,n,o)}else if(0!==gArrSortedProductRefs.length){var c=IsFilterAsDefaultView(),u=HasFilterStorage();if(!g_bFirstLoad||c||u){if((c||IsFilterCountEnabled())&&t){var p=GetFilterPatternForResult();gArrResultSet.length=0;var m=GetFilteredProducts(p);gArrResultSet=GetDecoratedProdRefs(m);var g=GetSortOrder();DoSort(g,gArrResultSet)}FormatResultHTML(!0,gArrSortedProductRefs,e,o)}else UpdateFilterCount()}else(!g_bFirstLoad||IsFilterAsDefaultView())&&FormatResultHTML(!0,null,null,o)}function UpdateProductDetailsFromServer(e,t,r){for(var n="",i=0;i<e.length;i++)"undefined"!=typeof e[i]&&(n+=e[i],i+1<e.length&&(n+="_"));var o=pg_sSearchScript,a={},l=new ajaxObject(o);if(l.callback=function(e){if(""!==e){var t={};try{t=e.parseJSON()}catch(n){return void ShowJSONError(n)}UpdateProductDetails(t,r)}},n="PAGE=DynamicFilter&DPR="+n,IsSearchBySubSection()&&g_bFirstLoad){for(var s="",d=0;d<gArraySectionIDs.length;d++)s+=gArraySectionIDs[d],d+1<gArraySectionIDs.length&&(s+="_");""!==s&&(n+="&SIDS="+s)}t&&(n+="&SID="+pg_nCurrentFilterSectionID),IsHostMode()&&(n+="&SHOP="+pg_sShopID),l.update(n,"POST")}function ShowJSONError(e){"undefined"!=typeof e&&e.length>500&&(e=e.substring(0,500)+"...");var t="The filter operation returned a script error. Please try again, and contact us if the error persists. The error was: \n\n["+e+"]";alert(t)}function UpdateProductDetails(e,t){var r=e.ProductDetails.ProductInfoCount;if("undefined"!=typeof e.SectionDetails&&0!=e.SectionDetails.SectionInfoCount&&CacheSectionDetails(e.SectionDetails.SectionInfoSet),0!=r){var n=new Array;n=e.ProductDetails.ProductInfoSet,CacheProductDetails(n),CacheProductDetailsWithFullPermutation(t)}}function UpdateProductDetailsHelper(e){var t=HasFilterStorage();g_bFirstLoad&&IsFilterCountEnabled()&&(g_bHasPresetOptions||t)&&(CalculateCount(!0),RemoveFilterWithZeroCount(),ClearFilterCounts());var r=IsFilterAsDefaultView();if(!g_bFirstLoad||r||t){if(r||IsFilterCountEnabled()){var n=GetFilterPatternForResult();gArrResultSet.length=0;var i=GetFilteredProducts(n);gArrResultSet=GetDecoratedProdRefs(i);var o=GetSortOrder();DoSort(o,gArrResultSet)}FormatResultHTML(!0,gArrSortedProductRefs,g_nCurrenPageNumber,e)}else UpdateFilterCount(),HideLoadingDialog()}function CacheProductDetailsWithFullPermutation(e){var t=GetProdRefForFullPermutation();if(""==t)return void UpdateProductDetailsHelper(e);var r=new Array,n=pg_sSearchScript,i=new ajaxObject(n);i.callback=function(t){return""===t?void UpdateProductDetailsHelper(e):(UpdateProductDetailsWithFullPermutation(t),void UpdateProductDetailsHelper(e))},sParams="ACTION=FULLPERMLIST&PRODREF="+t,i.update(sParams,"GET",!1)}function SetSelectionMapsFromStorage(){if(HasFilterStorage()){var e=SDStorage.readPage("filterSettings");ClearCtrlSelectionMap(),arrSettings=e.split(",");for(var t=0;t<arrSettings.length;t++){var r=arrSettings[t].split(":"),n=r[0],i=r[1];if("undefined"==typeof gMapControlToSelection[n]?(gMapControlToSelection[n]={},gMapControlToSelection[n][i]=""):gMapControlToSelection[n][i]="","PR"===n||"SX"===n?gMapCtrlSelections[arrSettings[t]]=!0:gMapCtrlSelections[i]=!0,"undefined"!=typeof gMapFilterGrpIdToFilterGrpName[n]&&"undefined"!=typeof gMapControlIdChoiceName[i]){var o=(gMapFilterGrpIdToFilterGrpName[n]+":"+gMapControlIdChoiceName[i]).toUpperCase();gMapPropCtrlSelections[o]=!0,"undefined"==typeof gMapPropIdToSelections[n]&&(gMapPropIdToSelections[n]=new Array),-1==GetArrayIndex(gMapPropIdToSelections[n],o)&&(gMapPropIdToSelections[n].push(o),gMapPropIdToSelections[n].length>0&&InsertSort(gMapPropIdToSelections[n]))}}}}function HasPresetFilterOptions(){var e=!1;for(var t in gMapFilters)if("PR"!==t&&"SX"!==t)for(var r=gMapFilters[t].m_mapChoices,n=1;"undefined"!=typeof r[n];){var i=r[n].m_sChoiceID;"undefined"!=typeof gMapCtrlSelections[i]&&""!==gMapFilters[t].m_mapChoices[n].m_sChoiceName&&(e=!0),n++}return e}function FormatResultHTML(e,t,r,n){n&&FilterProductsBasedOnPerms();var i=document.getElementById("ContentPage");i&&(i.style.display="none");var o=document.getElementById("filter_results_area");o&&(o.style.cssText="display:block");var a=document.getElementById("search_results_list");a&&(a.style.cssText="display:block");var l=document.getElementById("SortBy");if(l&&(l.style.cssText="display:block"),ReloadCarousels(),!e||0===gArrSortedProductRefs.length){var s="No matching products were found.";return UpdateResultContent(s),UpdateResultSummary(!1),UpdatePaginatedLinks(!1),n&&UpdateFilterCount(),gArrSortedProductRefs.length=0,gArrResultSet.length=0,void HideLoadingDialog()}g_sResultLayout===g_eResultLayout.TABULAR?FormatTabularResult(r):FormatStandardResult(r),n&&UpdateFilterCount()}function FormatStandardResult(e){var t="",r="",n=GetPaginatedProducts(gArrSortedProductRefs,e);0==n.length&&(e=0,n=GetPaginatedProducts(gArrSortedProductRefs,e));for(var i=0;i<n.length;i++){var o=new ProductDetails;o=GetProductDetails(n[i]),"undefined"!=typeof o&&(r=ReplaceResultTemplates(o,i),t+='<div class="std-product-details">'+r+"</div>")}UpdateResultContent(t),UpdateResultSummary(!0);var a=CreateSearchResultPageLinks();a[1]<2?UpdatePaginatedLinks(!1):UpdatePaginatedLinks(!0,a[0]),HideLoadingDialog()}function FormatTabularResult(e){var t="",r="",n="",i=GetPaginatedProducts(gArrSortedProductRefs,e);0==i.length&&(e=0,i=GetPaginatedProducts(gArrSortedProductRefs,e));for(var o=!1,a=0;a<i.length;a++){var l=new ProductDetails;l=GetProductDetails(i[a]),"undefined"!=typeof l&&(r=ReplaceResultTemplates(l,a),g_nListColCount>1?((a+1)%g_nListColCount===0?(n+=g_sListCellStartTemplate+r+g_sListCellEndTemplate,o=!0):(n+=g_sListCellStartTemplate+r+g_sListCellEndTemplate,o=!1),o?(t+=g_sListRowStartTemplate+n+g_sListRowEndTemplate,n=""):a+1===i.length&&(t+=g_sListRowStartTemplate+n+g_sListRowEndTemplate)):t+=g_sListRowStartTemplate+g_sListCellStartTemplate+r+g_sListCellEndTemplate+g_sListRowEndTemplate)}t=g_sListStartTemplate+t+g_sListEndTemplate;var s=CreateSearchResultPageLinks();s[1]<2?UpdatePaginatedLinks(!1):UpdatePaginatedLinks(!0,s[0]),UpdateResultContent(t),HideLoadingDialog()}function ReplaceResultTemplates(objProductDetails,nProdCount){var nProductCount=g_nProductMinIndex+1+nProdCount,sResultTemplate=g_sSearchResultsTemplate;for(sResultTemplate=ReplaceProductDetailstemplate(objProductDetails,sResultTemplate,nProductCount);sResultTemplate.match(/<Actinic:ScriptFunctionCall[^>]*>([^`]*?)<\/Actinic:ScriptFunctionCall>/i);){var arrMatch=sResultTemplate.match(/<Actinic:ScriptFunctionCall[^>]*>([^`]*?)<\/Actinic:ScriptFunctionCall>/i);if(arrMatch[1]){var scriptResult="";try{scriptResult=eval(arrMatch[1])}catch(e){console.log("Error in evaluating the statement: "+arrMatch[1])}sResultTemplate=sResultTemplate.replace(/<Actinic:ScriptFunctionCall[^>]*>([^`]*?)<\/Actinic:ScriptFunctionCall>/i,scriptResult)}}return sResultTemplate}function ReplaceProductDetailstemplate(e,t,r){var n=FormatPrices(e.m_sPrice);t=t.replace(/(<Actinic:S_ITEM><\/Actinic:S_ITEM>)/gi,r);var i="";if(IsLoggedIn()&&"undefined"!=typeof pg_sCustomerAccountsCGIURL&&""!==pg_sCustomerAccountsCGIURL){var o="";IsHostMode()&&(o="SHOP="+pg_sShopID+"&"),i='<a href="'+pg_sCustomerAccountsCGIURL+"?"+o+"PRODUCTPAGE="+e.m_sAnchor+'">'}else i='<a href="'+e.m_sAnchor+'">';var a="("+e.m_sSection+")&nbsp;",l=n+"&nbsp;",s=e.m_sDescription+"&nbsp;";if(t=t.replace(/((&lt;|<)Actinic:S_PNAME(&gt;|>)(&lt;|<)\/Actinic:S_PNAME(&gt;|>))/gi,e.m_sName),t=t.replace(/(<Actinic:S_SNAME><\/Actinic:S_SNAME>)/gi,a),t=t.replace(/(<Actinic:S_LINK><\/Actinic:S_LINK>)/gi,i),t=t.replace(/(<Actinic:S_PRAWPRICE><\/Actinic:S_PRAWPRICE>)/gi,e.m_sPrice),t=t.replace(/(<Actinic:S_PRICE><\/Actinic:S_PRICE>)/gi,l),t=t.replace(/(<Actinic:S_DESCR><\/Actinic:S_DESCR>)/gi,s),t=t.replace(/(<Actinic:S_STOCK><\/Actinic:S_STOCK>)/gi,e.m_nStockLevel),""==e.m_sImage&&"undefined"!=typeof pg_sDefaultProductImage&&(e.m_sImage=pg_sDefaultProductImage),""!==e.m_sImage){var d=/(<div[^>]*ResultImage[^>]*>([^`]*?)<\/div>)/gim,c=new Array;if(c=d.exec(t),null!=c){var u=c[2],p="";"undefined"!=typeof pg_nProductImageWidth&&pg_nProductImageWidth>0&&(p+='width="'+pg_nProductImageWidth+'" '),"undefined"!=typeof pg_nProductImageHeight&&pg_nProductImageHeight>0&&(p+='height="'+pg_nProductImageHeight+'"'),u=u.replace(/=\"\"/gi,""),u=u.replace(/netquotevar:thumbnailsize/gi,p),u=u.replace(/\bNETQUOTEVAR:THUMBNAIL\b/gi,e.m_sImage),t=t.replace(d,u)}}else t=t.replace(/(<div[^>]*ResultImage[^>]*>([^`]*?)<\/div>)/gi,"");if(pg_bShowProductFeedback){var d=/(<div[^>]*ResultFeefoLogo[^>]*>([^`]*?)<\/div>)/gim,c=new Array;if(c=d.exec(t),null!=c){var m=c[2];m=m.replace(/((&lt;|<)Actinic:S_PRODREF(&gt;|>)(&lt;|<)\/Actinic:S_PRODREF(&gt;|>))/gi,e.m_sProdRef),t=t.replace(d,m)}}else t=t.replace(/(<div[^>]*ResultFeefoLogo[^>]*>([^`]*?)<\/div>)/gi,"");return t=UpdateUDPVariableTemplates(e,t)}function UpdateUDPVariableTemplates(e,t){for(var r in e.m_mapUDPs)if(r){var n=EscapeRegExp(DecodeHtmlEntity(r)),i='(((&lt;)|(<))actinic:template[^((&gt;)|(>))]*name=((&quot;)|("))'+n+'((&quot;)|("))((&gt;)|(>))((&lt;)|(<))/actinic:template((&gt;)|(>)))';t=t.replace(new RegExp(i,"ig"),e.m_mapUDPs[r])}return t=t.replace(/(<actinic:template[^>]*name[^>]*>([^`]*?)<\/actinic:template>)/gi,"")}var DecodeHtmlEntity=function(e){return e.replace(/&#(\d+);/g,function(e,t){return"39"==t||"34"==t?"\\"+String.fromCharCode(t):String.fromCharCode(t)})},EncodeHtmlEntity=function(e){for(var t=[],r=e.length-1;r>=0;r--)t.unshift(["&#",e[r].charCodeAt(),";"].join(""));return t.join("")};function ProductDetails(){this.m_sProdRef="",this.m_sSid="",this.m_sName="",this.m_sDescription="",this.m_sSection="",this.m_sImage="",this.m_sAnchor="",this.m_sPrice="",this.m_mapProperties={},this.m_mapCompToPermutation={},this.m_sDecSection="",this.m_sDecPriceBand="",this.m_sDecFilterString="",this.m_mapDecChoices={},this.m_mapUDPs={},this.m_nStockLevel,this.m_bFullPermutation=!1}function ProductProperties(){this.m_mapChoices={},this.m_sPropID="",this.m_bShow=!1,this.m_bHideAlways=!1}function FilterChoiceDetails(){this.m_sChoiceID="",this.m_sChoiceName="",this.m_nChoiceCount=0,this.m_bHideAlways=!1}function SetProductDetails(e,t){e.m_sProdRef=t[0],e.m_sSid=t[1],e.m_sName=t[2],e.m_sDescription=t[3],e.m_sSection=t[4],e.m_sImage=t[5],e.m_sAnchor=t[6],e.m_sPrice=t[7];var r=t[8],n=t[9],i=t[10],o=t[11];e.m_nStockLevel=t[14];var a=i.split(",");if(""!=n)for(var l=n.split("|"),s=0;s<l.length;s++){var d=l[s];""!=d&&(d=DecodeHtmlEntity(d),"undefined"==typeof gMapChildToParentProducts[d]&&(gMapChildToParentProducts[d]=new Array),gMapChildToParentProducts[d].push(e.m_sProdRef))}for(var c=new Array,u=0;u<a.length;u++){var p=a[u].split("!"),m=p[0],g="S_"+m;if("undefined"!=typeof gMapFilterGrpIdToFilterGrpName[g]){e.m_mapProperties[g]=new ProductProperties;for(var f=1;f<p.length;f++){var v=p[f].replace(/(^\s*)|(\s*$)/gi,"");SetProductProperties(e,g,c,m,v)}}}var h=!1;if(""!==r)for(var S=r.split(","),P=0;P<S.length;P++){var C=/(<(.*)>(.*))/gim,_=C.exec(S[P]);if(null!==_&&""!==_[2]){var I=_[2].toUpperCase().split(":");InsertSort(I);for(var y=I.join(":"),A=0;A<I.length;A++)"undefined"==typeof gMapPropNameToPropId[I[A]]&&(I.splice(A,1),A--);var T=_[3];if(""===T){"undefined"==typeof e.m_mapCompToPermutation[y]&&(e.m_mapCompToPermutation[y]="EMPTY",h=!0);continue}for(var b=T.toUpperCase().split("|"),R=0;R<b.length;R++){for(var E=b[R].split("!!"),D=0;D<E.length;D++){var L=E[D].split("!");"undefined"==typeof gMapPropNameToPropId[L[0]]&&(E.splice(D,1),
D--)}InsertSort(E);var M="\\-"+E.join("\\-.*\\-")+"\\-",N=M.split("!"),O=new RegExp(N.join("\\:"),"i");("undefined"==typeof e.m_mapCompToPermutation[y]||"EMPTY"===e.m_mapCompToPermutation[y]||"OSTOCK"===e.m_mapCompToPermutation[y])&&(e.m_mapCompToPermutation[y]=new Array),e.m_mapCompToPermutation[y].push(O)}}}else e.m_mapCompToPermutation.EMPTY="";if(h&&"undefined"!=typeof gMapInvalidProdRefs[e.m_sProdRef]&&h&&(gMapInvalidEmptyPermsProdRefs[e.m_sProdRef]=0),IsFilterCountEnabled()||IsFilterAsDefaultView()){var F=GetPriceBand(parseInt(e.m_sPrice));e.m_sDecPriceBand=F;var w="PR_"+F;c.push(w),e.m_sDecSection=e.m_sSid;var k="SX_"+e.m_sSid;c.push(k)}InsertSort(c);var B="!"+c.join("!!")+"!";e.m_sDecFilterString=B;for(var G=o.split(","),H=0;H<G.length;H++){var x=G[H].split("|");e.m_mapUDPs[x[0]]=x[1]}}function SetProductProperties(e,t,r,n,i){if(objProductProperties=e.m_mapProperties[t],objProductProperties.m_sPropID=n,"&#33;"===i)return void(objProductProperties.m_mapChoices[0]="");for(var o=i.split("&#33;"),a=0;a<o.length;a++){var l=o[a].replace(/(^\s*)|(\s*$)/gi,""),s=l.replace(/(&#32;)/gi," ");if(objProductProperties.m_mapChoices[s]=a,""!==s){var d="S_"+n+":"+s;r.push(d),e.m_mapDecChoices[d]=""}}}function OnSortStatic(e){var t=e.selectedIndex,r=GetSelectWithinSortForm("filter_sortorder");r&&(r.selectedIndex=t),OnSort(e)}function OnSort(e){var t=document.forms.filter_sortorder,r=e.selectedIndex,n=e.options[r].value;g_bSortOrder=n,AppendUseStorageHash(g_eFilterSettings.SORTORDER),-1!=g_nCurrenPageNumber&&SetCurrentPageNumber(0),ShowLoadingDialog(),UpdateSortOrder(n),DoSort(n,gArrResultSet),RetrieveProductDetails(g_nCurrenPageNumber,!1)}function OnPagination(e){AppendUseStorageHash(g_eFilterSettings.PAGINATION),RetrieveProductDetails(e,!1),$(function(){$("html, body").animate({scrollTop:$("#SortBy").offset().top},"slow")})}function AppendUseStorageHash(e){if(SDStorage.isSupported()){var t=!1;""==window.location.hash?(window.location.hash="#usestorage",t=!0):""!=window.location.hash&&-1!=window.location.hash.indexOf("usestorage")?t=!1:(window.location.hash="#usestorage",t=!0),e==g_eFilterSettings.FILTER?g_bUseStorageFromClick=t:g_bUseStorageSortPage=t}}function StoreSettings(){if(IsUseFilterStorage()){var e="",t=new Array,r=0,n=!1;for(var i in gMapControlToSelection){var o=gMapControlToSelection[i];for(var a in o){var l=i+":"+a;t[r++]=l,n=!0}}n&&(e=t.join(",")),SDStorage.writePage("filterSettings",e),SDStorage.writePage("sortOrder",g_bSortOrder),SDStorage.writePage("pageNumber",g_nCurrenPageNumber)}}function ResetAllStorage(){ResetStorage(g_eFilterSettings.FILTER),ResetStorage(g_eFilterSettings.SORTORDER),ResetStorage(g_eFilterSettings.PAGINATION)}function ResetStorage(e){switch(e){case g_eFilterSettings.FILTER:SDStorage.writePage("filterSettings","");break;case g_eFilterSettings.SORTORDER:g_bSortOrder=pg_sDefaultSortOrder,SDStorage.writePage("sortOrder",g_bSortOrder);break;case g_eFilterSettings.PAGINATION:g_nCurrenPageNumber=0,SDStorage.writePage("pageNumber",g_nCurrenPageNumber)}}function GetProductDetails(e){return gMapObjProductDetails[e]}function IsProductDetailsCached(e){var t=!1;return"undefined"!=typeof gMapObjProductDetails[e]&&(t=!0),t}function GetPaginatedProducts(e,t){var r=new Array;0===pg_nSearchResultsLimit||-1===t?(g_nProductMinIndex=0,g_nProductMaxIndex=e.length+1):(g_nProductMinIndex=t*pg_nSearchResultsLimit,g_nProductMaxIndex=(t+1)*pg_nSearchResultsLimit);for(var n=g_nProductMinIndex;g_nProductMaxIndex>n;n++)"undefined"!=typeof e[n]&&r.push(e[n]);return r}function GetParent(e,t){var r=t.parentNode;if("undefined"!=typeof r&&null!=r&&null!=r.tagName)for(;r.tagName!==e.toUpperCase();)r=r.parentNode;return r}function EditLabel(e){for(var t=e.childNodes,r=e.parentNode.childNodes,n=0;n<r.length;n++)if(null!==r[n])for(var i=r[n].childNodes,o=0;o<i.length;o++)null!==i[o]&&"LABEL"==i[o].nodeName&&(i[o].style.cssText="");for(var a=0;a<t.length;a++)null!==t[a]&&"LABEL"==t[a].nodeName&&(t[a].style.cssText="color:red;")}function UpdateResultSummary(e){var t="";if(t=document.getElementById("search_results_list"),null===t)return void ShowError("Tag with the id 'search_results_list' is not found in Filter Results Layout, result summary might not be updated properly",g_ErrorCode.TAG);if(!e){var r="<Actinic:S_SUMMARY></Actinic:S_SUMMARY>";return void(t.innerHTML=t.innerHTML.replace(/(<Actinic:S_SUMMARY>(.*?)<\/Actinic:S_SUMMARY>)/gi,r))}var n=CalculateMinMaxSearchResult(),r="<Actinic:S_SUMMARY>Results "+n[0]+"-"+n[1]+" of "+gArrSortedProductRefs.length+"</Actinic:S_SUMMARY>";t.innerHTML=t.innerHTML.replace(/(<Actinic:S_SUMMARY>(.*?)<\/Actinic:S_SUMMARY>)/gi,r)}function CalculateMinMaxSearchResult(){var e=g_nProductMinIndex+1,t=0;return t=g_nProductMaxIndex>gArrSortedProductRefs.length?gArrSortedProductRefs.length:g_nProductMaxIndex,[e,t]}function UpdateResultContent(e){var t=document.getElementById("FilterResultElements"),r=document.getElementById("StaticResults");if(r&&(r.innerHTML=""),g_sResultLayout===g_eResultLayout.TABULAR){var n="";n=document.getElementById("product-list"),n&&(n.innerHTML=e)}else if(t)t.innerHTML=e,t.style.display="block";else{var i='Tag with the id "SearchResults" is not found in filter option layout, filter might not work properly';ShowError(i,g_ErrorCode.TAG)}}function CreateSearchResultPageLinks(){var e=document.getElementById("PaginationLinksTemplate");if(e){var t=e.innerHTML.replace(/(\n)/g,""),r={nMaxVisibleLinks:"<Actinic:PAGINATION_VISIBLELINKS>(.*?)</Actinic:PAGINATION_VISIBLELINKS>",sHeader:"<Actinic:PAGINATION_HEADER>(.*?)</Actinic:PAGINATION_HEADER>",sShowFirstLink:"<Actinic:PAGINATION_SHOWFIRSTURL>(.*?)</Actinic:PAGINATION_SHOWFIRSTURL>",sFirstPageURL:"<Actinic:PAGINATION_FIRSTPAGEURL>(.*?)</Actinic:PAGINATION_FIRSTPAGEURL>",sPrevPageURL:"<Actinic:PAGINATION_PREVPAGEURL>(.*?)</Actinic:PAGINATION_PREVPAGEURL>",sLinksPageURL:"<Actinic:PAGINATION_LINKSPAGEURL>(.*?)</Actinic:PAGINATION_LINKSPAGEURL>",sNextPageURL:"<Actinic:PAGINATION_NEXTPAGEURL>(.*?)</Actinic:PAGINATION_NEXTPAGEURL>",sLastPageURL:"<Actinic:PAGINATION_LASTPAGEURL>(.*?)</Actinic:PAGINATION_LASTPAGEURL>",sFullPageURL:"<Actinic:PAGINATION_FULLPAGEURL>(.*?)</Actinic:PAGINATION_FULLPAGEURL>"};for(var n in r){var i=new RegExp(r[n],"gi"),o=i.exec(t);if(o){var a=o[1];a=a.replace(/(&lt;)/gi,"<"),a=a.replace(/(&gt;)/gi,">"),r[n]=a}else r[n]=""}}var l="",s=pg_nSearchResultsLimit,d=parseInt(r.nMaxVisibleLinks);0===pg_bShowFullPageInPagination&&-1===g_nCurrenPageNumber&&(g_nCurrenPageNumber=0),s>gArrSortedProductRefs.length&&(s=gArrSortedProductRefs.length);var c=0;if(0!==s&&(c=Math.floor(gArrSortedProductRefs.length/s),gArrSortedProductRefs.length%s!==0&&c++),2>c)return[l,c];if(0!==pg_bShowFullPageInPagination&&-1===g_nCurrenPageNumber){var u=r.sShowFirstLink,p="javascript:OnPagination(0)";return l=u.replace(/<ACTINIC:PAGINATION_URLLINK><\/ACTINIC:PAGINATION_URLLINK>/gi,p),[l,c]}if(l=r.sHeader,0!==g_nCurrenPageNumber){var u=r.sFirstPageURL,p="javascript:OnPagination(0)";u=u.replace(/<ACTINIC:PAGINATION_URLLINK><\/ACTINIC:PAGINATION_URLLINK>/gi,p),l+=u,u=r.sPrevPageURL,p="javascript:OnPagination("+(g_nCurrenPageNumber-1)+")",u=u.replace(/<ACTINIC:PAGINATION_URLLINK><\/ACTINIC:PAGINATION_URLLINK>/gi,p),l+=u}0===d&&(d=c);var m=0;g_nCurrenPageNumber>-1&&(m=Math.floor(g_nCurrenPageNumber/d));var g=m*d,f=g+d;f>c&&(f=c);for(var v=g;f>=v;v++){var p="javascript:OnPagination("+v+")",u=r.sLinksPageURL,h,S=v+1;if(f>v)v===g_nCurrenPageNumber?(h=" <b>"+S+"</b> ",u=u.replace(/<A(.*)<\/A>/gi,h)):(u=u.replace(/<ACTINIC:PAGINATION_INDEX><\/ACTINIC:PAGINATION_INDEX>/gi,S),u=u.replace(/<ACTINIC:PAGINATION_URLLINK><\/ACTINIC:PAGINATION_URLLINK>/gi,p)),l+=u;else if(c>v){var P="...";u=u.replace(/<ACTINIC:PAGINATION_INDEX><\/ACTINIC:PAGINATION_INDEX>/gi,P),u=u.replace(/<ACTINIC:PAGINATION_URLLINK><\/ACTINIC:PAGINATION_URLLINK>/gi,p),l+=u}}if(c!==g_nCurrenPageNumber+1&&(p="javascript:OnPagination("+(g_nCurrenPageNumber+1)+")",u=r.sNextPageURL,u=u.replace(/<ACTINIC:PAGINATION_URLLINK><\/ACTINIC:PAGINATION_URLLINK>/gi,p),l+=u,p="javascript:OnPagination("+(c-1)+")",u=r.sLastPageURL,u=u.replace(/<ACTINIC:PAGINATION_URLLINK><\/ACTINIC:PAGINATION_URLLINK>/gi,p),l+=u),0!==pg_bShowFullPageInPagination){u=r.sFullPageURL,p="javascript:OnPagination(-1)";var C=gArrSortedProductRefs.length;u=u.replace(/<ACTINIC:PAGINATION_URLLINK><\/ACTINIC:PAGINATION_URLLINK>/gi,p),u=u.replace(/<ACTINIC:PAGINATION_PRODUCTCOUNT><\/ACTINIC:PAGINATION_PRODUCTCOUNT>/gi,C),l+=u}return[l,c]}function UpdatePaginatedLinks(e,t){var r=document.getElementById("filter_pagination_links_top");r&&(e?r.innerHTML=t:r.innerHTML="");var n=document.getElementById("filter_pagination_links_bottom");n&&(e?n.innerHTML=t:n.innerHTML="")}function UpdateSortOrder(e){var t=document.forms.filter;if("undefined"!=typeof t)for(var r=t.elements,n=0;n<r.length;n++)"INPUT"===r[n].tagName&&"SO"===r[n].name&&(r[n].value=e)}function GetPaginationDetails(){var e=0;e=pg_nSearchResultsLimit>gArrSortedProductRefs.length?gArrSortedProductRefs.length:pg_nSearchResultsLimit;var t=0;return 0!==e&&(t=Math.floor(gArrSortedProductRefs.length/e),gArrSortedProductRefs.length%e!==0&&t++),[e,t]}function GetSortOrder(){var e="",t=document.forms.filter;return"undefined"!=typeof t&&t.SO&&(e=t.SO.value),""===e&&"undefined"!=typeof pg_sDefaultSortOrder&&(e=pg_sDefaultSortOrder),e}function ResetSortOrder(){var e=document.forms.filter,t="";t=SDStorage.readPage("sortOrder"),t?(g_bSortOrder=t,e.SO.value=t):"undefined"!=typeof e&&"undefined"!=typeof pg_sDefaultSortOrder&&e.SO&&(g_bSortOrder=pg_sDefaultSortOrder,e.SO.value=pg_sDefaultSortOrder);var r=document.forms.filter_sortorder,n="";"undefined"!=typeof e&&(n=r.getElementsByTagName("option"));for(var i in n)n[i].value===g_bSortOrder?n[i].selected="selected":n[i].selected=""}function SetCurrentPageNumber(e){g_nCurrenPageNumber=e}function SetStoredPageNumber(){var e=SDStorage.readPage("pageNumber");g_nCurrenPageNumber=null!=e?e:0}function ShowLoadingDialog(){var e=document.getElementById("loading-dialog");e&&(e.style.display="block")}function HideLoadingDialog(){var e=document.getElementById("loading-dialog");e&&(e.style.display="none")}function GetProdRefsOfNonCachedProductDetails(e){var t=new Array;if(t.length=0,0!==e.length)for(var r=0;r<e.length;r++)IsProductDetailsCached(e[r])||t.push(e[r]);return t}function CacheProductDetails(e){for(var t=0;t<e.length;t++){var r=e[t].ProductInfo,n=r[0];IsOutOfStock(n,r[12],r[13])||(gMapObjProductDetails[n]=new ProductDetails,SetProductDetails(gMapObjProductDetails[n],r))}}function IsOutOfStock(e,t,r){var n=IsOutOfStockFromStockFilter(e);if(IsExcludeOutOfStockItems()&&t)if(null==n){if(0>=r)return!0}else if(n)return!0;return!1}var gMAX_INT="9007199254740992",gMapPriceBandPriceRange={},gMapFilters={},gMapDefCtrlSelections={},gArrayPriceIDs=new Array,gArraySectionIDs=new Array,gMapControlIdChoiceName={},gMapPropIdToBtnClearStatus={},gMapCtrlSelections={},gMapPropCtrlSelections={},gMapPropIdToSelections={},gMapControlToSelection={},g_eControlType={BUTTON:1,LIST:2,LINK:4,UNDEFINED:5};function UpdateFilterCount(){IsFilterCountEnabled()&&"undefined"!=typeof pg_arrayPriceBandValues&&"undefined"!=typeof pg_arrayProperties&&(CalculateCount(!1),!g_bFirstLoad||g_bHasPresetOptions||HasFilterStorage()||RemoveFilterWithZeroCount(),GenerateDynamicFilterOptions(),ClearFilterCounts())}function CacheDefinedPriceBands(){if("undefined"==typeof pg_arrayPriceBandValues){var e="Global variables 'pg_arrayPriceBandValues' is not defined, filtering functionality might not be available";return void ShowError(e,g_ErrorCode.UNDEFINED)}gMapFilterGrpIdToFilterGrpName.PR="PR",gArrFilterGrpIdSorted.push("PR"),gMapFilters.PR={},gMapFilters.PR.m_bShow=!1;for(var t=0;t<pg_arrayPriceBandValues.length;t++){var r=pg_arrayPriceBandValues[t].split(":"),n=r[1].split("-"),i=r[0];gArrayPriceIDs.push(i),gMapFilters.PR[i]=new PriceBandDetails,t===pg_arrayPriceBandValues.length-1&&(n[1]=gMAX_INT),SetPriceDetails(gMapFilters.PR[i],n[0],n[1])}}function PriceBandDetails(){this.m_nMin=0,this.m_nMax=0,this.m_nCount=0,this.m_bHideAlways=!1}function SetPriceDetails(e,t,r){e.m_nMin=parseInt(t),e.m_nMax=parseInt(r)}function GetPriceBand(e){var t="-1",r=gMapFilters.PR;for(var n in r){var i=r[n].m_nMin,o=r[n].m_nMax;if(e>=i&&o>=e){t=n;break}}return t}function GenerateDynamicFilterOptions(){CreateFilterSectionOptions(),CreateFilterPriceBandOptions(),CreateFilterPropertyOptions()}function ClearFilterCounts(){for(var e in gMapFilters)if("PR"===e){var t=gMapFilters[e];for(var r in t)t[r].m_nCount=0;gMapFilters[e].m_bShow=!1}else if("SX"===e){var n=gMapFilters[e];for(var i in n)n[i].m_nCumulativeCount=0,n[i].m_nCount=0;gMapFilters[e].m_bShow=!1}else{var o=gMapFilters[e].m_mapChoices;for(var a in o)o[a].m_nChoiceCount=0,gMapFilters[e].m_bShow=!1}}function CacheDefinedChoices(){if("undefined"==typeof pg_arrayProperties){var e="Global variables 'pg_arrayProperties' is not defined, filtering functionality might not be available";return void ShowError(e,g_ErrorCode.UNDEFINED)}for(var t=0;t<pg_arrayProperties.length;t++)if("undefined"!=typeof pg_arrayProperties[t]){var r=pg_arrayProperties[t].split(":"),n=r[0].replace(/(&#95;)/g,"_"),i=n.split("-"),o=i[0],a=i[1],l=r[1];if(gMapControlIdChoiceName[n]=l,"undefined"==typeof gMapPropIdDecoratedChoices[o]&&(gMapPropIdDecoratedChoices[o]=new Array),""!==l){var s=gMapFilterGrpIdToFilterGrpName[o]+":"+l;s.toUpperCase(),-1==GetArrayIndex(gMapPropIdDecoratedChoices[o],s)&&(gMapPropIdDecoratedChoices[o].push(s),InsertSort(gMapPropIdDecoratedChoices[o]))}"undefined"==typeof gMapFilters[o]&&(gMapFilters[o]=new ProductProperties),"undefined"==typeof gMapFilters[o].m_mapChoices[a]&&(gMapFilters[o].m_mapChoices[a]=new FilterChoiceDetails),"undefined"!=typeof gMapFilters[o].m_mapChoices[a]&&SetDefinedChoices(gMapFilters[o].m_mapChoices[a],o,n,l)}}function SetDefinedChoices(e,t,r,n){e.m_sChoiceID=r,e.m_sChoiceName=n,gMapFilters[t].m_bShow=!1}function CachePriceBandPriceRange(){if("undefined"!=typeof pg_arrayPriceBandRange)for(var e=0;e<pg_arrayPriceBandRange.length;e++){var t=pg_arrayPriceBandRange[e].split(":"),r=t[0];gMapPriceBandPriceRange[r]=t[1]}}function CreateFilterPriceBandOptions(){var e="",t="";if(e=document.getElementById("FilterPriceBandOptions"),t=document.getElementById("PriceOptionTemplate"),null===e||null===t){var r='Tag with the id "FilterPriceBandOptions" OR "PriceOptionTemplate" is not found in filter option layout, filter count might not work for price band';return void ShowError(r,g_ErrorCode.TAG)}var n=!1;if(IsHideChoiceWithZeroResults()&&IsFilterCountEnabled()||IsFilterCountEnabled()&&g_bFirstLoad){var i=document.getElementById("PR");gMapFilters.PR.m_bShow?(i.style.display="block",n=!1):(i.style.display="none",n=!0)}var o=t.outerHTML,a=t.innerHTML,l="",s="",d=GetLayoutType(a),c="",u="",p="",m="";if(m=document.getElementById("PriceOptionTemplateSelect"),null!==m){c=m.outerHTML;var g=m.innerHTML,f=g.toLowerCase().indexOf("</act:select>");f>0&&(u=g.substring(0,f),u=u.replace(/(ACT:SELECT)/gi,"select"),p="</select>")}var v="",h="",S="",P="",C="",_="";if(v=document.getElementById("PriceOptionTemplateStartUL"),null!==v&&(h=v.innerHTML,S=v.outerHTML,h=h.replace(/(&lt;)/gi,"<"),h=h.replace(/(&gt;)/gi,">")),P=document.getElementById("PriceOptionTemplateEndUL"),null!==P&&(C=P.innerHTML,_=P.outerHTML,C=C.replace(/(&lt;)/gi,"<"),C=C.replace(/(&gt;)/gi,">")),!n&&""!==c&&IsDropDownListBox(c)){l=a,l=l.replace(/(&lt;Actinic:PriceIndex&gt;&lt;\/Actinic:PriceIndex&gt;)/gi,"-1"),l=l.replace(/(<Actinic:PriceIndex><\/Actinic:PriceIndex>)/gi,"-1"),l=l.replace(/(<Actinic:PriceBand><\/Actinic:PriceBand>)/gi,"Any");var I="PR:-1",y="";"undefined"!=typeof gMapCtrlSelections[I]&&(y="selected"),l=l.replace(/(ActinicDisabledCtrl=\"\")/gi,""),l=l.replace(/(ActinicDisabledStyle=\"\")/gi,""),l=l.replace(/(ActinicCustomSelection=\"\")/gi,y),l=l.replace(/(ACT:OPTION)/gi,"option"),l=l.replace(/(<Actinic:HiddentInput><\/Actinic:HiddentInput>)/gi,""),s+=l}var A=0,T=1;l="";for(var b=0;b<gArrayPriceIDs.length;b++){var R=gArrayPriceIDs[b];if("undefined"!=typeof gMapFilters.PR[R]&&!gMapFilters.PR[R].m_bHideAlways){sHiddenInput="",A=gMapFilters.PR[R].m_nCount,T++,l=a,l=l.replace(/(&lt;Actinic:PriceIndex&gt;&lt;\/Actinic:PriceIndex&gt;)/gi,gArrayPriceIDs[b]),l=l.replace(/(<Actinic:PriceIndex><\/Actinic:PriceIndex>)/gi,gArrayPriceIDs[b]);var E=gMapPriceBandPriceRange[gArrayPriceIDs[b]].replace(/(&nbsp;)/gi," ");IsFilterCountEnabled()&&(E+=" ("+A+")"),l=l.replace(/(<Actinic:PriceBand><\/Actinic:PriceBand>)/gi,E);var I="PR:"+gArrayPriceIDs[b],y="",D="",L="";"undefined"!=typeof gMapCtrlSelections[I]&&("LIST"===d?y="selected":"LINKS"===d?(y='style="color:red"',sHiddenInput='<input type="hidden" value="'+gArrayPriceIDs[b]+'" name="hf_PR" id="hf_PR"/>'):y="checked"),IsFilterCountEnabled()&&IsHideChoiceWithZeroResults()&&(A>0||(L='style="display:none;"',D='style="display:none;"')),IsFilterCountEnabled()&&!IsHideChoiceWithZeroResults()&&("LIST"===d?A>0||(L='disabled="disabled"'):"LINKS"===d?A>0||(L='disabled="disabled"',D='style="color:gray;cursor:default"'):A>0||(L='disabled="disabled"',D='style="color:gray"')),l=l.replace(/(ActinicDisabledCtrl=\"\")/gi,L),l=l.replace(/(ActinicDisabledStyle=\"\")/gi,D),l=l.replace(/(ACT:OPTION)/gi,"option"),l=l.replace(/(ActinicCustomSelection=\"\")/gi,y),l=l.replace(/(<Actinic:HiddentInput><\/Actinic:HiddentInput>)/gi,sHiddenInput),s+=l}}n?(u="",h="",s="",C="",p=""):(u=u.replace(/(&lt;Actinic:ListCount&gt;&lt;\/Actinic:ListCount&gt;)/gi,T),u=u.replace(/(<Actinic:ListCount><\/Actinic:ListCount>)/gi,T)),e.innerHTML=c+o+S+_+u+h+s+C+p}function CreateFilterPropertyOptions(){for(var e=0;e<gArrProperty.length;e++)if("undefined"!=typeof gArrProperty[e]){var t=gArrProperty[e],r="FilterPropertyOptions_"+t,n="PropOptionTemplate_"+t,i="",o="";if(i=document.getElementById(r),o=document.getElementById(n),null===i||null===o){var a="Tag with the id"+r+" OR "+n+"is not found in filter option layout, filter count might not work for the property ID "+t;ShowError(a,g_ErrorCode.TAG);continue}var l=o.innerHTML,s=o.outerHTML,d=GetLayoutType(l),c="",u="",p=!1;if("undefined"!=typeof gMapFilters[t]){var m=gMapFilters[t].m_mapChoices,g=1;if(IsHideChoiceWithZeroResults()&&IsFilterCountEnabled()||IsFilterCountEnabled()&&g_bFirstLoad||gMapFilters[t].m_bHideAlways){var f=document.getElementById(t);g_bFirstLoad&&gMapFilters[t].m_bHideAlways||g_bFirstLoad&&!gMapFilters[t].m_bShow&&IsHideChoiceWithZeroResults()||!g_bFirstLoad&&!gMapFilters[t].m_bShow?(f.style.display="none",i.style.display="none",p=!0):(f.style.display="block",i.style.display="block",p=!1)}var v="",h="",S="",P="",C="",_="PropOptionTemplateSelect_"+t;if(C=document.getElementById(_),null!==C&&(v=C.innerHTML,h=C.outerHTML,!p)){var I=v.toLowerCase().indexOf("</act:select>");I>0&&(S=v.substring(0,I),S=S.replace(/(ACT:SELECT)/gi,"select"),S=S.replace(/(&lt;Actinic:FilterPropValueName&gt;&lt;\/Actinic:FilterPropValueName&gt;)/gi,t),S=S.replace(/(<Actinic:FilterPropValueName><\/Actinic:FilterPropValueName>)/gi,t),P="</select>")}var y=IsDropDownListBox(v),A="",T="",b="",R="",E="",D="";A=document.getElementById("PropOptionTemplateStartUL_"+t),null!==A&&(T=A.innerHTML,b=A.outerHTML,T=T.replace(/(&lt;)/gi,"<"),T=T.replace(/(&gt;)/gi,">")),R=document.getElementById("PropOptionTemplateEndUL_"+t),null!==R&&(E=R.innerHTML,D=R.outerHTML,E=E.replace(/(&lt;)/gi,"<"),E=E.replace(/(&gt;)/gi,">"));for(var L=0;"undefined"!=typeof m[g];){var M=!1;if(""===m[g].m_sChoiceName){if(!y||p){g++;continue}M=!0}if(""===m[g].m_sChoiceID||m[g].m_bHideAlways&&!M)g++;else{var N="",O=m[g].m_nChoiceCount;L++,c=l,c=c.replace(/(&lt;Actinic:FilterPropValueName&gt;&lt;\/Actinic:FilterPropValueName&gt;)/gi,t),c=c.replace(/(<Actinic:FilterPropValueName><\/Actinic:FilterPropValueName>)/gi,t);var F=m[g].m_sChoiceName;c=c.replace(/(&lt;Actinic:FilterPropValue&gt;&lt;\/Actinic:FilterPropValue&gt;)/gi,F),c=c.replace(/(<Actinic:FilterPropValue><\/Actinic:FilterPropValue>)/gi,F);var w=t+"-"+g,k="",B="",G="";"undefined"==typeof gMapCtrlSelections[w]||g_bClearAll||("LIST"===d?k="selected":"LINKS"===d?(k='style="color:red"',N='<input type="hidden" value="'+m[g].m_sChoiceName+'" name="hf_'+m[g].m_sChoiceID+'" id="hf_'+t+'"/>'):k="checked"),IsFilterCountEnabled()&&IsHideChoiceWithZeroResults()&&(O>0||(B='style="display:none;"',G='style="display:none;"')),!IsFilterCountEnabled()||IsHideChoiceWithZeroResults()||M||("LIST"===d?O>0||(B='disabled="disabled"'):"LINKS"===d?O>0||(B='disabled="disabled"',G='style="color:gray;cursor:default"'):O>0||(B='disabled="disabled"',G='style="color:gray"')),c=c.replace(/(ACT:OPTION)/gi,"option"),c=c.replace(/(ActinicDisabledCtrl=\"\")/gi,B),c=c.replace(/(ActinicDisabledStyle=\"\")/gi,G),c=c.replace(/(ActinicCustomSelection=\"\")/gi,k),c=c.replace(/(&lt;Actinic:FilterPropChoiceID&gt;&lt;\/Actinic:FilterPropChoiceID&gt;)/gi,m[g].m_sChoiceID),c=c.replace(/(<Actinic:FilterPropChoiceID><\/Actinic:FilterPropChoiceID>)/gi,m[g].m_sChoiceID);var H=m[g].m_sChoiceName;M&&(H="Any"),IsFilterCountEnabled()&&!M&&(H+=" ("+m[g].m_nChoiceCount+")"),c=c.replace(/(&lt;Actinic:FilterPropText&gt;&lt;\/Actinic:FilterPropText&gt;)/gi,H),c=c.replace(/(<Actinic:FilterPropText><\/Actinic:FilterPropText>)/gi,H),c=c.replace(/(<Actinic:HiddentInput><\/Actinic:HiddentInput>)/gi,N),u+=c,g++}}1===L&&L++,S=S.replace(/(&lt;Actinic:ListCount&gt;&lt;\/Actinic:ListCount&gt;)/gi,L),S=S.replace(/(<Actinic:ListCount><\/Actinic:ListCount>)/gi,L),i.innerHTML="",i.innerHTML=b+D+h+s+S+T+u+E+P}}}function GetLayoutType(e){var t;return t=e.match(/(ACT:OPTION)/gim)?"LIST":e.match(/(type=\"submit\")/gim)||e.match(/(type=submit)/gim)?"LINKS":"BUTTONS"}function IsDropDownListBox(e){var t=!1,r=e.match(/(ACT:SELECT(.*)size\s*=\s*["\']?([^"\' ]*)["\' ]\s*)/i);return r?"undefined"!=typeof r[3]&&"1"===r[3]&&(t=!0):e.match(/(ACT:SELECT)/i)&&(t=!0),t}function GetControlSelections(e,t,r){var n="";if("SX"===e||"PR"===e)n=e+":"+t,"-1"!==t&&("undefined"==typeof gMapControlToSelection[e]?(gMapControlToSelection[e]={},gMapControlToSelection[e][t]=""):gMapControlToSelection[e][t]="");else{if(n=t,""!==n&&""!==r&&"undefined"!=typeof gMapControlIdChoiceName[n]){var i=gMapControlIdChoiceName[n],o=n.split("-")[0],a=gMapFilterGrpIdToFilterGrpName[o]+":"+i,l=a.toUpperCase();"undefined"==typeof gMapPropIdToSelections[o]&&(gMapPropIdToSelections[o]=new Array),-1==GetArrayIndex(gMapPropIdToSelections[o],l)&&(gMapPropIdToSelections[o].push(l),gMapPropIdToSelections[o].length>0&&InsertSort(gMapPropIdToSelections[o])),"undefined"==typeof gMapPropCtrlSelections[l]&&(gMapPropCtrlSelections[l]=!0)}""!==n&&""!==e&&""!==r&&("undefined"==typeof gMapControlToSelection[e]?(gMapControlToSelection[e]={},gMapControlToSelection[e][n]=""):gMapControlToSelection[e][n]="")}""!==n&&(gMapCtrlSelections[n]=!0)}function ClearCtrlSelectionMap(){gMapCtrlSelections={},gMapControlToSelection={},gMapPropCtrlSelections={},gMapPropIdToSelections={}}function IsFilterCountEnabled(){return"undefined"!=typeof pg_bEnableFilterCount&&pg_bEnableFilterCount?!0:!1}function GetResultLayoutUsed(){var e=g_eResultLayout.UNDEFINED,t="";return t=document.getElementById("S_LISTCOLCOUNT"),t?(e=g_eResultLayout.TABULAR,g_nListColCount=parseInt(t.innerHTML)):e=g_eResultLayout.STD,e}function IsHostMode(){return"undefined"!=typeof pg_sShopID&&pg_sShopID?!0:!1}function SetDefaultSelection(){if(GetControlSelections("PR","-1"),GetControlSelections("SX","-1"),"undefined"!=typeof pg_arrayDefaultProperties)for(var e=0;e<pg_arrayDefaultProperties.length;e++)if("undefined"!=typeof pg_arrayDefaultProperties[e]&&null!==pg_arrayDefaultProperties[e]){var t=pg_arrayDefaultProperties[e].replace(/(&#95;)/g,"_"),r=t.split("-");gMapDefCtrlSelections[r[0]]=r[1],GetControlSelections(r[0],t,gMapControlIdChoiceName[t])}}function CheckHashChangeEvent(){if(!IsPreview()){var e=GetIEVersion();if(8>e&&0!==e){var t="";function r(){window.location.hash!==t&&(HashChangeHandler(),t=window.location.hash)}r(),window.setInterval(r,500)}else AddEvent(window,"hashchange",HashChangeHandler),window.location.hash&&HashChangeHandler()}}function HashChangeHandler(){if(g_bUseStorageSortPage)return void(g_bUseStorageSortPage=!1);if(ResetSortOrder(),SetStoredPageNumber(),-1!=window.location.hash.search("usestorage"))return SetSelectionMapsFromStorage(),void(IsFilterCountEnabled()?OnFilter(null,null,!0):(GenerateDynamicFilterOptions(),IsFilterAsDefaultView()?OnFilter(null,null,!0):OnFilter(null,null,!1)));var e="";if(e=document.getElementById("filter_results_area")){var t="";t=document.getElementById("ContentPage"),t&&(t.style.display="block"),e.style.display="none",""!=window.location.hash&&(window.location.hash=window.location.hash),ShowSectionContent(),HideAllClearButtons(),ResetStorage(g_eFilterSettings.FILTER)}}function IsHideChoiceWithZeroResults(){return"undefined"!=typeof pg_bHideChoiceWithZeroResults&&1===pg_bHideChoiceWithZeroResults?!0:!1}function CreateClearButton(e){var t=document.getElementById(e+"-clear-button");if(t)return void(t.style.cssText="display:block");var r=document.getElementById(e);if(r){var n="<a href='javascript:ClearFilterOptions(\""+e+'");\' id="'+e+'-clear-button" class="clear-button">Clear</a>';r.innerHTML=r.innerHTML+n}}function ShowHideClearButton(e,t){var r=document.getElementById(t+"-clear-button");r?e?(r.style.cssText="display:block",gMapPropIdToBtnClearStatus[t]=!0):(r.style.cssText="display:none",gMapPropIdToBtnClearStatus[t]=!1):e&&(CreateClearButton(t),gMapPropIdToBtnClearStatus[t]=!0)}function GetClearButtonCount(){var e=0;for(sPropId in gMapPropIdToBtnClearStatus)gMapPropIdToBtnClearStatus[sPropId]===!0&&e++;return e}function ClearFilterOptions(e){GetClearButtonCount()<2?OnClearAllOptions():(ClearFilterChoices(e),OnFilter())}function ClearFilterChoices(e){var t=document.forms.filter;if("undefined"!=typeof t)for(var r=document.forms.filter.elements,n=0;n<r.length;n++){var i=GetControlType(r[n]);if(e===r[n].name&&i!==g_eControlType.UNDEFINED&&(ResetSelectionCheck(i,r[n],e),i===g_eControlType.LINK))break}}function GetControlType(e){var t=g_eControlType.UNDEFINED,r=e.type,n=e.tagName;return"INPUT"===n?"checkbox"===r||"radio"===r?t=g_eControlType.BUTTON:"submit"===r&&(t=g_eControlType.LINK):"SELECT"===n&&(t=g_eControlType.LIST),t}function ResetSelectionCheck(e,t,r){switch(e){case g_eControlType.BUTTON:("-1"!=t.value||""!=t.value)&&(t.checked=!1);break;case g_eControlType.LIST:for(var n=0;n<t.options.length;n++)("-1"!=t.options[n].value||""!=t.options[n].value)&&(t.options[n].selected=!1);break;case g_eControlType.LINK:var i=document.getElementById("hf_"+r);if(i){var o=i.value,a="";if("PR"===r)a="lbl_"+o;else if("SX"===r)a+="lbl_SX_"+o;else{var l=i.name.split("hf_");a="lbl_"+l[1]}var s=document.getElementById(a);s&&(s.style.cssText=""),i.parentNode.removeChild(i)}}}function HideModifyStaticControls(){var e=document.getElementById("update_btn");if(e){var t=e.parentNode;t&&t.parentNode.removeChild(t)}var r=document.getElementById("update_lnk");r&&(r.setAttribute("onclick","javascript:OnClearAllOptions(); return false;"),r.value="Clear All")}function OnClearAllOptions(){GetClearButtonCount()<1||(ShowSectionContent(),HideAllClearButtons(),ResetStorage(g_eFilterSettings.FILTER),-1!=g_nCurrenPageNumber&&ResetStorage(g_eFilterSettings.PAGINATION))}function ShowSectionContent(){if(!IsFilterAsDefaultView()){var e=document.getElementById("filter_results_area");e&&(e.style.cssText="display:none");var t=document.getElementById("ContentPage");t&&(t.style.cssText="display:block"),ReloadCarousels()}}function HideAllClearButtons(){ClearCtrlSelectionMap();for(var e in gMapPropIdToBtnClearStatus)gMapPropIdToBtnClearStatus[e]===!0&&ClearFilterChoices(e);OnFilter(null,null,!1,!0)}function CacheFilterSections(){if("undefined"!=typeof pg_arrayFilterSections){gMapFilterGrpIdToFilterGrpName.SX="SX",gArrFilterGrpIdSorted.push("SX"),gMapFilters.SX={},gMapFilters.SX.m_bShow=!1;for(var e=0;e<pg_arrayFilterSections.length;e++)if("undefined"!=typeof pg_arrayFilterSections[e]&&null!==pg_arrayFilterSections[e]){var t=pg_arrayFilterSections[e].split(":"),r=t[0];gMapFilters.SX[r]=new SectionDetails,gMapFilters.SX[r].m_sSectionName=t[1],gArraySectionIDs.push(r)}}}function SectionDetails(){this.m_sSectionName="",this.m_nCount=0,this.m_nCumulativeCount=0,this.m_arrSubSectionIds=new Array,this.m_bHideAlways=!1}function CreateFilterSectionOptions(){var e="",t="";if(e=document.getElementById("FilterSectionOptions"),t=document.getElementById("SectionOptionTemplate"),null===e||null===t){var r='Tag with the id "FilterSectionOptions" OR "SectionOptionTemplate" is not found in filter option layout, filter count might not work for departments';return void ShowError(r,g_ErrorCode.TAG)}var n=!1;if(IsHideChoiceWithZeroResults()&&IsFilterCountEnabled()||IsFilterCountEnabled()&&g_bFirstLoad){var i=document.getElementById("SX");gMapFilters.SX.m_bShow?(i.style.display="block",n=!1):(i.style.display="none",n=!0)}var o=t.outerHTML,a=t.innerHTML,l="",s="",d=GetLayoutType(a),c="",u="",p="",m="";if(m=document.getElementById("SectionOptionTemplateSelect"),null!==m){c=m.outerHTML;var g=m.innerHTML,f=g.toLowerCase().indexOf("</act:select>");f>0&&(u=g.substring(0,f),u=u.replace(/(ACT:SELECT)/gi,"select"),p="</select>")}var v="",h="",S="",P="",C="",_="";if(v=document.getElementById("SectionOptionTemplateStartUL"),null!==v&&(h=v.innerHTML,S=v.outerHTML,h=h.replace(/(&lt;)/gi,"<"),h=h.replace(/(&gt;)/gi,">")),P=document.getElementById("SectionOptionTemplateEndUL"),null!==P&&(C=P.innerHTML,_=P.outerHTML,C=C.replace(/(&lt;)/gi,"<"),C=C.replace(/(&gt;)/gi,">")),!n&&""!==c&&IsDropDownListBox(c)){l=a,l=l.replace(/(&lt;Actinic:SectionIndex&gt;&lt;\/Actinic:SectionIndex&gt;)/gi,"-1"),l=l.replace(/(<Actinic:SectionIndex><\/Actinic:SectionIndex>)/gi,"-1"),l=l.replace(/(<Actinic:SectionName><\/Actinic:SectionName>)/gi,"Any");var I="SX:-1",y="";"undefined"!=typeof gMapCtrlSelections[I]&&(y="selected"),l=l.replace(/(ActinicDisabledCtrl=\"\")/gi,""),l=l.replace(/(ActinicDisabledStyle=\"\")/gi,""),l=l.replace(/(ActinicCustomSelection=\"\")/gi,y),l=l.replace(/(ACT:OPTION)/gi,"option"),l=l.replace(/(<Actinic:HiddentInput><\/Actinic:HiddentInput>)/gi,""),s+=l}for(var A=0,T=1,b=0;b<gArraySectionIDs.length;b++)if(sHiddenInput="","undefined"!=typeof gMapFilters.SX[gArraySectionIDs[b]]&&!gMapFilters.SX[gArraySectionIDs[b]].m_bHideAlways){A=gMapFilters.SX[gArraySectionIDs[b]].m_nCumulativeCount,T++,l=a,l=l.replace(/(&lt;Actinic:SectionIndex&gt;&lt;\/Actinic:SectionIndex&gt;)/gi,gArraySectionIDs[b]),l=l.replace(/(<Actinic:SectionIndex><\/Actinic:SectionIndex>)/gi,gArraySectionIDs[b]);var R=gMapFilters.SX[gArraySectionIDs[b]].m_sSectionName;IsFilterCountEnabled()&&(R+=" ("+A+")"),l=l.replace(/(<Actinic:SectionName><\/Actinic:SectionName>)/gi,R);var I="SX:"+gArraySectionIDs[b],y="",E="",D="";"undefined"!=typeof gMapCtrlSelections[I]&&("LIST"===d?y="selected":"LINKS"===d?(y='style="color:red"',sHiddenInput='<input type="hidden" value="'+gArraySectionIDs[b]+'" name="hf_SX" id="hf_SX"/>'):y="checked"),IsFilterCountEnabled()&&IsHideChoiceWithZeroResults()&&(A>0||(D='style="display:none;"',E='style="display:none;"')),IsFilterCountEnabled()&&!IsHideChoiceWithZeroResults()&&("LIST"===d?A>0||(D='disabled="disabled"'):"LINKS"===d?A>0||(D='disabled="disabled"',E='style="color:gray;cursor:default"'):A>0||(D='disabled="disabled"',E='style="color:gray"')),l=l.replace(/(ActinicDisabledCtrl=\"\")/gi,D),l=l.replace(/(ActinicDisabledStyle=\"\")/gi,E),l=l.replace(/(ACT:OPTION)/gi,"option"),l=l.replace(/(ActinicCustomSelection=\"\")/gi,y),l=l.replace(/(<Actinic:HiddentInput><\/Actinic:HiddentInput>)/gi,sHiddenInput),s+=l}n?(u="",h="",s="",C="",p=""):(u=u.replace(/(&lt;Actinic:ListCount&gt;&lt;\/Actinic:ListCount&gt;)/gi,T),u=u.replace(/(<Actinic:ListCount><\/Actinic:ListCount>)/gi,T)),e.innerHTML=c+o+S+_+u+h+s+C+p}function IsSearchBySubSection(){return"undefined"!=typeof pg_bSearchBySubSection&&1===pg_bSearchBySubSection?!0:!1}function CacheSectionDetails(e){for(var t=0;t<e.length;t++){
var r=e[t].SectionID;"undefined"!=typeof gMapFilters.SX[r]?gMapFilters.SX[r].m_arrSubSectionIds=e[t].SubSectionIDs:(gMapFilters.SX[r]=new SectionDetails,gMapFilters.SX[r].m_arrSubSectionIds=e[t].SubSectionIDs)}}function UpdateCumulativeSectionCount(){if(IsSearchBySubSection())for(var e=0;e<gArraySectionIDs.length;e++){var t=gArraySectionIDs[e];if("undefined"!=typeof gMapFilters.SX[t]){var r=new Array;r=gMapFilters.SX[t].m_arrSubSectionIds;for(var n=0;n<r.length;n++)"undefined"!=typeof gMapFilters.SX[r[n]]&&(gMapFilters.SX[t].m_nCumulativeCount+=gMapFilters.SX[r[n]].m_nCount);gMapFilters.SX[t].m_nCumulativeCount+=gMapFilters.SX[t].m_nCount}}}function HideOptionAny(){var e=IsFilterAsDefaultView(),t=document.getElementById("SX_-1");if(t){var r=t.parentNode,n;n=e?r.childNodes:r.parentNode.childNodes;for(var i=0;i<n.length;i++)"LABEL"===n[i].tagName&&"SX_-1"===n[i].htmlFor&&n[i].parentNode.removeChild(n[i]);t.parentNode.removeChild(t)}var o=document.getElementById("-1");if(o){var a=o.parentNode,n;n=e?a.childNodes:a.parentNode.childNodes;for(var i=0;i<n.length;i++)"LABEL"===n[i].tagName&&"-1"===n[i].htmlFor&&n[i].parentNode.removeChild(n[i]);o.parentNode.removeChild(o)}for(var l=0;l<gArrProperty.length;l++)if("undefined"!=typeof gArrProperty[l]){var s=gArrProperty[l],d="",c="PropOptionTemplateSelect_"+s,u=document.getElementById(c);if(null!==u&&(d=u.innerHTML),""!==d&&IsDropDownListBox(d))continue;s+="-1";var p=document.getElementById(s);if(p&&""===p.value){var m=p.parentNode,n;n=e?m.childNodes:m.parentNode.childNodes;for(var i=0;i<n.length;i++)"LABEL"===n[i].tagName&&n[i].htmlFor===s&&n[i].parentNode.removeChild(n[i]);m.removeChild(p)}}}function IsFilterAsDefaultView(){return"undefined"!=typeof pg_bFilterDefaultView&&pg_bFilterDefaultView?!0:!1}function IsShowClearButton(e){var t=!1;if("SX"===e)for(var r in gMapFilters.SX)"undefined"!=typeof gMapCtrlSelections["SX:"+r]&&"-1"!==gMapCtrlSelections[r]&&(t=!0);else if("PR"===e)for(var n in gMapFilters.PR)"undefined"!=typeof gMapCtrlSelections["PR:"+n]&&"-1"!==gMapCtrlSelections[n]&&(t=!0);else if("undefined"!=typeof gMapFilters[e])for(var i=gMapFilters[e].m_mapChoices,o=1;"undefined"!=typeof i[o];){var a=i[o].m_sChoiceID;"undefined"!=typeof gMapCtrlSelections[a]&&""!==gMapFilters[e].m_mapChoices[o].m_sChoiceName&&(t=!0),o++}return t}function FilterProductsBasedOnPerms(){var e={},t=new Array;for(var r in gMapPropCtrlSelections)"undefined"!=typeof r&&t.push(r);if(t.length<=0)for(var n=gArrayDefinedPropertiesSorted.join(":"),i=0;i<gArrSortedProductRefs.length;i++){var o=gArrSortedProductRefs[i];if("undefined"!=typeof gMapInvalidProdRefs[o]||gMapObjProductDetails[o].m_bFullPermutation){var a=gMapObjProductDetails[o].m_mapCompToPermutation;"undefined"==typeof a[n]||"EMPTY"!==a[n]&&"OSTOCK"!==a[n]?e[o]=!0:IsAllOtherPermsValid(a,n)?e[o]=!0:e[o]=!1}else e[o]=!0}else{InsertSort(t);for(var l=GetPermSelectionString(""),i=0;i<gArrSortedProductRefs.length;i++){var o=gArrSortedProductRefs[i];if("undefined"!=typeof gMapInvalidProdRefs[o]||gMapObjProductDetails[o].m_bFullPermutation){e[o]=!1;var a=gMapObjProductDetails[o].m_mapCompToPermutation;if("undefined"==typeof a.EMPTY){var s=!0,d=!1;for(sComponent in a)if(IsValidComponent(t,sComponent)===!0){if(d=!0,"EMPTY"===a[sComponent]||"OSTOCK"===a[sComponent]){IsAllOtherPermsValid(a,sComponent)&&(e[gArrSortedProductRefs[i]]=!0);continue}var c=a[sComponent];if(c.length>0)for(var u=0;u<c.length;u++)if(TestRegExp(c[u],l)){s=!1;break}s===!1&&(e[gArrSortedProductRefs[i]]=!0)}d||(e[gArrSortedProductRefs[i]]=!0)}else e[o]=!1}else e[o]=!0}}for(var o in e)if(e[o]===!1){var p=GetArrayIndex(gArrSortedProductRefs,o);-1!==p&&(gArrSortedProductRefs.splice(p,1),delete gMapMatchedProducts[o])}for(var p=0;p<gArrSortedProductRefs.length;p++){var o=gArrSortedProductRefs[p];"undefined"!=typeof gMapAltProdToParentProductRef[o]&&"undefined"!=typeof gMapMatchedProducts[gMapAltProdToParentProductRef[o]]&&(gArrSortedProductRefs.splice(p,1),p--)}gArrResultSet.length=0,gArrResultSet=GetDecoratedProdRefs(gArrSortedProductRefs)}function IsValidComponent(e,t){for(var r=!1,n=t.split(":"),i=e.join("|"),o=0;o<n.length;o++){var a=n[o];if(-1!==i.indexOf(a)){r=!0;break}}return r}function UpdatePermutationCount(e,t){var r=new Array;for(var n in gMapPropCtrlSelections)"undefined"!=typeof n&&r.push(n);if("SX"!==e&&"PR"!==e){var i="",o=gMapFilters[e].m_mapChoices;for(i in o)if(""!==i){var a=o[i].m_nChoiceCount;if(0!==a){var l="",n=e,s=o[i].m_sChoiceName;l=GetPermSelectionString(n,s);for(var d=0;d<t.length;d++){var c=t[d];if("undefined"==typeof gMapAltProdToParentProductRef[c]||"undefined"==typeof gMapProdToAltProdArray[gMapAltProdToParentProductRef[c]])if("undefined"==typeof gMapProdToAltProdArray[c]){if("undefined"!=typeof gMapObjProductDetails[c].m_mapProperties[e]){var u=gMapObjProductDetails[c].m_mapProperties[e].m_mapChoices;if("undefined"!=typeof u[s]){var p=gMapObjProductDetails[c].m_mapCompToPermutation,m=gMapFilterGrpIdToFilterGrpName[n],g=GetCombination(m,p);if(""!==g)IsValidCombination(c,l,g)||o[i].m_nChoiceCount--;else{var f=GetPermSelectionString("");if(""!==f){var v=!1,h="";for(h in p)if((0==r.length||IsValidComponent(r,h))&&!IsValidCombination(c,f,h)){v=!0;break}v&&o[i].m_nChoiceCount--}}}}}else CheckAlternativePermutations(c,e,s,r)||o[i].m_nChoiceCount--}}}}else for(var d=0;d<t.length;d++){var c=t[d];if("undefined"==typeof gMapAltProdToParentProductRef[c]||"undefined"==typeof gMapProdToAltProdArray[gMapAltProdToParentProductRef[c]]||!("PR"===e&&gMapObjProductDetails[gMapAltProdToParentProductRef[c]].m_sDecPriceBand===gMapObjProductDetails[c].m_sDecPriceBand||"SX"===e&&gMapObjProductDetails[gMapAltProdToParentProductRef[c]].m_sDecSection===gMapObjProductDetails[c].m_sDecSection)){var f=GetPermSelectionString("");if(""!==f){var v=!1,h="",p=gMapObjProductDetails[c].m_mapCompToPermutation;for(h in p)if((0==r.length||IsValidComponent(r,h))&&!IsValidCombination(c,f,h)){v=!0;break}if(v)if("PR"===e){var S=gMapObjProductDetails[c].m_sDecPriceBand,P=gMapFilters.PR;for(var C in P)if(S===C){P[S].m_nCount--;break}}else if("SX"===e){var _=gMapObjProductDetails[c].m_sDecSection,I=gMapFilters.SX;for(var y in I)if(_===y){I[_].m_nCount--;break}}}}}}function CheckAlternativePermutations(e,t,r,n){if("undefined"==typeof gMapProdToAltProdArray[e])return!0;var i="",o=t,a=!0;i=GetPermSelectionString(o,r);for(var l=gMapProdToAltProdArray[e],s=0;s<l.length;s++){var e=l[s];if("undefined"!=typeof gMapObjProductDetails[e].m_mapProperties[t]){var d=gMapObjProductDetails[e].m_mapProperties[t].m_mapChoices;if("undefined"!=typeof d[r]){var c=gMapObjProductDetails[e].m_mapCompToPermutation,u=gMapFilterGrpIdToFilterGrpName[o],p=GetCombination(u,c);if(""!==p){var m=c[p];if("undefined"!=typeof gMapInvalidProdRefs[e]&&!gMapObjProductDetails[e].m_bFullPermutation&&"EMPTY"===m||"OSTOCK"===m){if(IsAllOtherPermsValid(c,p))return!0;a=!1;continue}if("EMPTY"===m)return!0;if(m.length>0){for(var g=0;g<m.length;g++)if(TestRegExp(m[g],i))return!0;g===m.length&&(a=!1)}}else{var f=GetPermSelectionString("");if(""!==f){var v=!1,h="";for(h in c)if(IsValidComponent(n,h)){if(IsValidCombination(e,f,h))return!0;a=!1;break}}}}}}return a}function IsValidCombination(e,t,r){var n=gMapObjProductDetails[e].m_mapCompToPermutation;if(""!==r){var i=n[r];if("undefined"!=typeof gMapInvalidProdRefs[e]&&!gMapObjProductDetails[e].m_bFullPermutation&&"EMPTY"===i||"OSTOCK"===i)return IsAllOtherPermsValid(n,r)?!0:!1;if("EMPTY"===i)return!0;if(i.length>0){for(var o=0;o<i.length;o++)if(TestRegExp(i[o],t))return!0;return!1}}return!0}function GetPermSelectionString(e,t){for(var r="",n=gMapFilterGrpIdToFilterGrpName[e]+":"+t,i=0;i<gArrayDefinedPropertiesSorted.length;i++){var o=gArrayDefinedPropertiesSorted[i],a=gMapPropNameToPropId[o];r+=e===a?"-"+n+"-":"undefined"!=typeof gMapPropIdToSelections[a]?"-"+gMapPropIdToSelections[a].join("--")+"-":"-"+gMapPropIdDecoratedChoices[a].join("--")+"-"}return r}function GetCombination(e,t){var r="";for(var n in t)if(""!==n&&-1!==n.indexOf(e)){r=n;break}return r}function CalculateCount(e){for(var t=0;t<gArrFilterGrpIdSorted.length;t++){var r="",n=gArrFilterGrpIdSorted[t];e||g_bClearAll||(r=GetFilterPatternForCount(n));var i=GetFilteredProducts(r);CountFilterOptions(n,i),UpdatePermutationCount(n,i),"SX"===n&&UpdateCumulativeSectionCount()}}function GetFilterPatternForCount(e){var t={},r="";for(var n in gMapFilterGrpIdToFilterGrpName)if(n!==e&&"undefined"!=typeof gMapControlToSelection[n]){var i=gMapControlToSelection[n],o=new Array,a="";if("PR"===n)for(var l in i){var s=n+"_"+l;o.push(s)}else if("SX"===n){var d={};for(var l in i){d[l]="";for(var c=gMapFilters.SX[l].m_arrSubSectionIds,u=0;u<c.length;u++)-1!==GetArrayIndex(gArraySectionIDs,c[u])&&(d[c[u]]="")}for(var p in d){var s=n+"_"+p;o.push(s)}}else for(var m in i)if("undefined"!=typeof gMapControlIdChoiceName[m]){var s=n+":"+gMapControlIdChoiceName[m];o.push(s)}o.length>0&&(t[n]="(\\!"+o.join("\\!|\\!")+"\\!)")}for(var g=0;g<gArrFilterGrpIdSorted.length;g++){var f=gArrFilterGrpIdSorted[g];"undefined"!=typeof t[f]&&(r.length>0&&(r+=".*"),r+=t[f])}return r}function GetFilteredProducts(e){var t=new Array,r=new RegExp(e,"i");gMapMatchedProducts={},gMapProdToAltProdArray={};for(var n in gMapObjProductDetails)if(""!==e){var i=gMapObjProductDetails[n].m_sDecFilterString;TestRegExp(r,i)&&(t.push(n),gMapMatchedProducts[n]="")}else t.push(n),gMapMatchedProducts[n]="";for(var o=0;o<t.length;o++){var n=t[o];"undefined"!=typeof gMapAltProdToParentProductRef[n]&&"undefined"!=typeof gMapMatchedProducts[gMapAltProdToParentProductRef[n]]&&("undefined"==typeof gMapProdToAltProdArray[gMapAltProdToParentProductRef[n]]&&(gMapProdToAltProdArray[gMapAltProdToParentProductRef[n]]=new Array,gMapProdToAltProdArray[gMapAltProdToParentProductRef[n]].push(gMapAltProdToParentProductRef[n])),gMapProdToAltProdArray[gMapAltProdToParentProductRef[n]].push(n))}return t}function TestRegExp(e,t){var r=!1;return"undefined"!=typeof e&&"undefined"!=typeof t&&""!=t&&(r=e.test(t)),r}function CountFilterOptions(e,t){for(var r={},n=0;n<t.length;n++)r[t[n]]="";for(var n=0;n<t.length;n++){var i=t[n];if("PR"===e){var o=gMapObjProductDetails[t[n]].m_sDecPriceBand;("undefined"==typeof gMapAltProdToParentProductRef[i]||"undefined"==typeof r[gMapAltProdToParentProductRef[i]]||gMapObjProductDetails[gMapAltProdToParentProductRef[i]].m_sDecPriceBand!==o)&&UpdatePriceCount(o)}else if("SX"===e){var a=gMapObjProductDetails[t[n]].m_sDecSection;("undefined"==typeof gMapAltProdToParentProductRef[i]||"undefined"==typeof r[gMapAltProdToParentProductRef[i]]||gMapObjProductDetails[gMapAltProdToParentProductRef[i]].m_sDecSection!==a)&&UpdateSectionCount(a)}else{var l=gMapObjProductDetails[t[n]].m_sDecFilterString,s=gMapObjProductDetails[t[n]].m_mapDecChoices;if("undefined"==typeof gMapAltProdToParentProductRef[i]||"undefined"==typeof r[gMapAltProdToParentProductRef[i]])UpdateChoiceCount(e,l,s);else{var d=gMapObjProductDetails[gMapAltProdToParentProductRef[i]].m_mapDecChoices,c={};for(var u in s)c[u]="";for(var u in d)"undefined"!=typeof c[u]&&delete c[u];UpdateChoiceCount(e,l,c)}}}}function UpdatePriceCount(e){var t=gMapFilters.PR,r=!1;for(var n in t)if(n===e){t[n].m_nCount++,r=!0;break}r&&(gMapFilters.PR.m_bShow=!0)}function UpdateSectionCount(e){var t=gMapFilters.SX,r=!1;for(var n in t)if(n===e){t[n].m_nCount++,r=!0;break}r&&(gMapFilters.SX.m_bShow=!0)}function UpdateChoiceCount(e,t,r){var n=gMapFilters[e].m_mapChoices,i=!1;for(var o in n){var a=n[o];if(""!==a.m_sChoiceName){var l=e+":"+a.m_sChoiceName;"undefined"!=typeof r[l]&&(a.m_nChoiceCount++,i=!0)}}i&&(gMapFilters[e].m_bShow=!0)}function RemoveFilterWithZeroCount(){for(var e in gMapFilters)if("PR"===e){var t=gMapFilters[e];for(var r in t)0==t[r].m_nCount&&(t[r].m_bHideAlways=!0)}else if("SX"===e){var n=gMapFilters[e];for(var i in n)0==n[i].m_nCumulativeCount&&(n[i].m_bHideAlways=!0)}else{var o=gMapFilters[e].m_mapChoices;gMapFilters[e].m_bHideAlways=!0;for(var a in o)0==o[a].m_nChoiceCount?o[a].m_bHideAlways=!0:gMapFilters[e].m_bHideAlways=!1}}function IsAllOtherPermsValid(e,t){var r=!1;for(var n in e)if(n!==t){var i=e[n];if("EMPTY"!==i&&"OSTOCK"!==i&&i.length>0){r=!0;break}}return r}function GetFilterCacheURL(e){var t="",r=document.getElementsByTagName("base");if(r&&r.length>0){t=r[0].href;var n=document.location.protocol,i=t.split("//")[0];i!=n&&(t=t.replace(new RegExp("^"+i),n));var o=t.split("//")[1].split("/")[0];return o!=document.location.host&&(t=t.replace(o,document.location.host)),t.match(/\/$/)||(t+="//"),t+e}return e}function ReloadCarousels(){$("div[class^='bxSlider']").each(function(e){var t=$(this).data("sd_BXSlider");t&&t.reloadSlider()})}function CacheStockFilter(){if(IsExcludeOutOfStockItems()){var e=new ajaxObject("stockfilter.js");e.callback=function(e){if(""!==e){g_bCacheStock=!1;var t=e.split("|");for(gMapRefStock={},index=0;index<t.length;index++)if(""!=t[index]){var r=t[index].split("_");gMapRefStock[r[0]]=parseInt(r[1])}}},e.update("","GET",!1)}}function IsOutOfStockFromStockFilter(e){return"undefined"==typeof gMapRefStock[e]?null:gMapRefStock[e]<=0?!0:!1}function IsExcludeOutOfStockItems(){return"undefined"!=typeof pg_bExcludeOutOfStockItems&&0!==pg_bExcludeOutOfStockItems?!0:!1}function GetProdRefForFullPermutation(){var e={};for(var t in gMapRefStock)if("undefined"!=typeof gMapChildToParentProducts[t])for(var r=gMapChildToParentProducts[t],n=0;n<r.length;n++)e[r[n]]=null;for(var t in gMapInvalidEmptyPermsProdRefs)e[t]=null;var i="",o=0;for(var t in e)i+=(0==o?"":"_")+t,o++;return i}function UpdateProductDetailsWithFullPermutation(e){var t={};try{t=e.parseJSON()}catch(r){return void ShowJSONError(r)}arrProductToFullPermutation=t.FullPermutationList;for(var n=0;n<arrProductToFullPermutation.length;n++){var i=arrProductToFullPermutation[n];for(var o in i)if("undefined"!=typeof gMapObjProductDetails[o]){var a=gMapObjProductDetails[o];UpdateCompToPermMapWithFullPermutation(a,i[o]);var l=gMapObjProductDetails[o].m_mapCompToPermutation;if(0==Object.keys(l).length)continue;var s=!0;for(var d in l)if("OSTOCK"!==l[d]){s=!1;break}s&&delete gMapObjProductDetails[o]}}}function UpdateCompToPermMapWithFullPermutation(e,t){if(""!==t){e.m_mapCompToPermutation={};for(var r=t.split(","),n=0;n<r.length;n++){var i=/(<(.*)>(.*))/gim,o=i.exec(r[n]);if(null!==o&&""!==o[2]){var a=o[2].toUpperCase().split(":");InsertSort(a);for(var l=a.join(":"),s=0;s<a.length;s++)"undefined"==typeof gMapPropNameToPropId[a[s]]&&(a.splice(s,1),s--);var d=o[3];if(""===d)continue;for(var c=d.split("|"),u=c.length>0,p=0;p<c.length;p++){var i=/(.*)\:(\d)\:.*\:(.*)/gim,o=i.exec(c[p]);if(0!=o[2]){var m=o[3];if(""!=m){var g=m.split("!"),f=g[0];f=DecodeHtmlEntity(f);var v=g[2],h=g[3];if(IsOutOfStock(f,v,h))continue;u=!1}for(var S=o[1],P=S.toUpperCase().split("!!"),C=0;C<P.length;C++){var _=P[C].split("!");"undefined"==typeof gMapPropNameToPropId[_[0]]&&(P.splice(C,1),C--)}if(0!==P.length){InsertSort(P);var I="\\-"+P.join("\\-.*\\-")+"\\-",y=I.split("!"),A=new RegExp(y.join("\\:"),"i");("undefined"==typeof e.m_mapCompToPermutation[l]||"EMPTY"===e.m_mapCompToPermutation[l]||"OSTOCK"===e.m_mapCompToPermutation[l])&&(e.m_mapCompToPermutation[l]=new Array),e.m_mapCompToPermutation[l].push(A)}}else"undefined"==typeof e.m_mapCompToPermutation[l]&&(e.m_mapCompToPermutation[l]="EMPTY")}!u||"undefined"!=typeof e.m_mapCompToPermutation[l]&&"EMPTY"!==e.m_mapCompToPermutation[l]||(e.m_mapCompToPermutation[l]="OSTOCK")}}e.m_bFullPermutation=!0}else e.m_mapCompToPermutation.EMPTY=""}/***************************************************************
* 
* dynamic.js	-	utility functions for dynamic prices and choices
*
* Copyright (c) 2014 SellerDeck Limited
*
****************************************************************/
var g_mapProds={},timeout=null,g_nTimeout=1e3,g_sDynamicPriceURL="";function OnProdLoad(e,t,r){if(e)g_sDynamicPriceURL=e,getAllDynamicPrices(e,t,r);else{if(g_sDynamicPriceURL="",g_bStockUpdateInProgress)return void(g_bChoicesUpdatePending=!0);SetupVariants(!1);for(var n in g_mapProds){var i=g_mapProds[n];UpdateChoices(i,!0,void 0)}}}function GetAttrFromSuffix(e,t){if(!e.mapAttr){e.mapAttr={};for(var r=0;r<e.arrComps.length;r++){var n=e.arrComps[r];if(n.aA)for(var i=0;i<n.aA.length;i++)e.mapAttr[n.aA[i].nUI]=n.aA[i]}}return e.mapAttr[t]}function UpdateChoices(e,t,r){if(e&&!e.bFixChoices&&!e.bNoATC&&e.arrComps){for(var n=GetProdChoices(e,r,t),i=GetChangedElemIndices(e,r),o=i?i.nCompIndex:0,a=e.arrComps,l=a.length,s=o;l>s;s++){var d=n[s],c=a[s];if(c.aA&&(t&&MapInvalidPermutations(c),c.mP||e.bSequentialChoices)){c.arrUserSeq||(c.arrUserSeq=[]),!e.bSequentialChoices&&i&&s==i.nCompIndex&&UpdateUserSequence(c,i.nAttrIndex,n[s]),NormaliseAttrSeq(c);var d=NormaliseUserChoices(c,n[s]);NormalisePerms(c);var u=0;e.bSequentialChoices&&s==o&&i&&(u=i.nAttrIndex),UpdateCompChoices(e,c,d,u)}}updateStockDisplay(g_mapStockByRef,!1),e.bSequentialChoices&&UpdateSequentialDisplay(e,n)}}function UpdateSequentialDisplay(e,t){for(var r=!1,n=0;n<e.arrComps.length;n++){var i=e.arrComps[n];if(i.bExclFromSeq){var o=r;UpdateSequentialCompDisplay(e,i,t[n],0,!1),r=o}else r=UpdateSequentialCompDisplay(e,i,t[n],0,r)}}function UpdateSequentialCompDisplay(e,t,r,n,i){var o=t.elemHTML,a=!0;if("checkbox"==o.type&&(o.disabled=i,i||(a=o.checked)),!t.aA)return i;for(var l=t.aA.length,s=n;l>s;s++){var d=t.aA[s],c=d.elem,u=c.elemHTML;if(i||!a)EnableSelectElement(u,!1),"SELECT"==u.tagName&&(u.selectedIndex=0);else{var p=GetValidChoiceCount(u);if((!t.bOpt||l>1)&&1==p.nCount){var m=GetAttributeValue(u);"SELECT"==u.tagName?p.elemFirstValid.selected=!0:p.elemFirstValid.checked=!0;var g=GetAttributeValue(u);m!=g&&(r[s]=g?parseInt(g):0,UpdateCompChoices(e,t,r,s+1))}var m=GetAttributeValue(u);EnableSelectElement(u,!0),""==m&&(i=!0)}}return i}function GetValidChoiceCount(e){var t=0,r=null;if("SELECT"==e.tagName)for(var n=0;n<e.options.length;n++){var i=e.options[n],o=parseInt(i.value?i.value:"0");o>0&&!i.disabled&&(t++,1==t&&(r=i))}else for(var a=document.getElementsByName(e.name),n=0;n<a.length;n++){var l=a[n],o=parseInt(l.value?l.value:"0");o>0&&(t++,1==t&&(r=l))}return{nCount:t,elemFirstValid:r}}function EnableSelectElement(e,t){if("SELECT"==e.tagName)e.disabled=!t;else for(var r=document.getElementsByName(e.name),n=0;n<r.length;n++){var i=r[n];i.disabled=!t}}function GetProdChoices(e,t,r){if(!e.arrComps)return[];for(var n=!1,i=new Array(e.arrComps.length),o=0;o<e.arrComps.length;o++){var a=e.arrComps[o];if(a.aA){i[o]=new Array(a.aA.length);for(var l=0;l<a.aA.length;l++){var s=a.aA[l];if(s.nCC&&s.elem)if(r)a.bOpt&&a.bSelDef&&"SPAN"==s.elem.elemHTML.tagName?i[o][l]=1:i[o][l]=0;else{var d=GetAttributeValue(s.elem.elemHTML),c=""==d?0:parseInt(d,10);e.bSequentialChoices&&(n?c=0:(0==c||t&&t.name==s.elem.elemHTML.name)&&(!a.bOpt||IsCompEnabled(a,i[o]))&&(n=!0)),i[o][l]=c}}}}return i}function UpdateCompChoices(e,t,r,n,i){if(t.aA){var o=t.aA;void 0==i&&(i=o.length);for(var a=n;i>a;a++){var l=GetUserChoiceCount(r),s=GetNormAttr(t,a),d=r[a]?r[a]:"";if(void 0!=s.elem){var c=s.elem,u=c.elemHTML,p=c.arrOptions,m="";"SELECT"==u.tagName?u.options.length=0:m=c.arrHTMLFrag[0];for(var g=0,f=0,v=-1,h=s.nRBCCount,S=p.length,P=0,C=-1,_=!1,I=0;S>I;I++){var y=p[I],A=y[0];r[a]=A?parseInt(A):0;var T=p[I][1],b=p[I][2];if(0==I&&""==T||IsValidOption(t,r,a,a,l))if(_=0==I&&0==r[I]?!0:!1,f++,A&&(P++,1==P&&(C=r[a])),"SELECT"==u.tagName)AddOption(u,A,T,A==d,b);else{var R=c.arrHTMLFrag[g+1];h>1&&f%h==0&&I<p.length-1&&(R=c.arrHTMLFrag[h]),m+=T+R}g++}if((!t.bOpt||o.length>1)&&1==P&&(d=C,SetAttributeValue(u,d),r[a]=C,a>l&&UpdateCompChoices(e,t,r,l,a)),0==f||_){if(!t.bOpt){e.bNoATC=!0;var E=e.sProdRef.replace(/^\d+!/,"");$("[id^='EnableIfOutOfStock_']").filter("[id$='_"+E+"']").filter("[data-message]").each(function(){$(this).html($(this).attr("data-message")).removeAttr("data-message")}),$("[id^='EnableIfOutOfStock_']").filter("[id$='_"+E+"']").show(),$("[id^='RemoveIfOutOfStock_']").filter("[id$='_"+E+"']").hide()}"SELECT"==u.tagName&&(u.style.display="none",t.elemHTML.value="",t.elemHTML.style.display="none","checkbox"==t.elemHTML.type&&(t.elemHTML.checked=!1))}if("SELECT"!=u.tagName){var D=document.getElementById("id"+u.name+"_Table");D.innerHTML=m,SetAttributeValue(u,d)}else-1==u.selectedIndex&&(u.selectedIndex=0);var L=GetAttributeValue(u);r[a]=""==L?0:parseInt(L,10)}}}}function GetPricePerm(e,t){if(!t)return void 0;if(t[e])return t[e];for(var r=Clone(e),n=0;n<e.length;n++)if(e[n]){if(r[n]=0,t[r])return t[r];r[n]=e[n]}return void 0}function IsValidOption(e,t,r,n,i){if(0==e.nInvalidPermCount)return!0;var o=t[r];if(o>0&&0==e.nInvalidAnyCount&&0==e.arrInvalidPerms[r][o])return!0;var a=!IsInvalidAnyChoice(e,t,r,0);if(a)if(r!=n&&r>i-1){for(var l=GetNormAttr(e,r),s=l.nCC-1,d=1;d<l.nCC;d++)t[r]=d,r<t.length-1?IsValidOption(e,t,r+1,n,i)||s--:(-1==e.mapNormPerms[t]||r>0&&!HasValidPrevChoices(e,t,n-1,n))&&s--;a=s>0}else r<t.length-1&&(a=IsValidOption(e,t,r+1,n,i));return t[r]=o,a&&r>0&&(HasValidPrevChoices(e,t,n-1,n)||(a=!1)),a}function IsInvalidAnyChoice(e,t,r,n){if(-1==e.mapNormPerms[t])return!0;if(0==e.nInvalidAnyCount)return!1;for(var i=n;i<t.length;i++){if(0==t[i]){for(var o=e.aA[r].nCC-1,a=1;o>a;a++)t[i]=a,-1==e.mapNormPerms[t]&&o--;if(t[i]=0,0>=o)return!0}if(i!=r){var l=!1,s=t[i];if(t[i]=0,-1==e.mapNormPerms[t]?l=!0:i<t.length-1&&IsInvalidAnyChoice(e,t,r,i+1)&&(l=!0),t[i]=s,l)return!0}}return!1}function HasValidPrevChoices(e,t,r,n){if(0>r)return!0;var i=!1,o=t[r];if(t[r]=0,-1==e.mapNormPerms[t])i=!0;else{if(t[r]=o,0==o){for(var a=GetNormAttr(e,r),l=a.nCC-1,s=1;s<a.nCC;s++)t[r]=s,-1==e.mapNormPerms[t]?l--:r>0&&!HasValidPrevChoices(e,t,r-1,n)&&l--;t[r]=o,i=1>l}!i&&r>0&&!HasValidPrevChoices(e,t,r-1,n)&&(i=!0)}return t[r]=o,!i&&r>0&&(i=!HasValidPrevChoices(e,t,r-1,n)),!i}function IsCompEnabled(e,t){if(!e||!e.elemHTML)return!1;var r=e.elemHTML,n="on"==r.value;return"checkbox"==r.type?r.checked:void 0==t?n:n&&t[0]>-1}function ChoiceChanged(e,t,r,n){var i=e.name,o;if(0==i.indexOf("v_")){var a=i.match(/^v_(.*)_\d+$/);o=a[1]}else 0==i.indexOf("Q_")&&(o=i.substr(2));if(o){g_oConfig.bEstimateChoicePrices||ValidateChoices(o,!0,e)||ShowDynamicPriceMessage(o,g_sUndeterminedPrice);var l=g_mapProds[o];UpdateChoices(l,!1,e),UpdatePrice(l,t,r,n)}}function ValidateChoices(e,t,r){var n=g_mapProds[e];if(!n||!n.arrComps)return!0;for(var i=GetProdChoices(n,r),o=0;o<n.arrComps.length;o++)if(i[o]){var a=n.arrComps[o];if(IsCompEnabled(a,i[o])&&(!a.bOpt||1!=a.aA.length)&&!ValidateComp(i[o],a.aA,t))return!1}return r&&null!=r.name&&0===r.name.indexOf("WL_")&&AddJSFlagToProductForm(r),!0}function ValidateComp(e,t,r){for(var n=0;n<e.length;n++)if(!e[n]){if(!r){var i="Please select a "+t[n].sN,o=t[n].elem.elemHTML;if(alert(i),"SELECT"!=o.tagName){var a=o.id.replace(/(_(\d+|))$/,""),l=document.getElementsByName(a);l.length>0&&(o=l[0])}o.focus()}return!1}return!0}function UpdatePrice(e,t,r,n){if(e&&!e.bFixPrice&&!e.bNoATC&&t){var i=document.getElementById("id"+e.sProdRef+"TaxIncPrice"),o=document.getElementById("id"+e.sProdRef+"TaxExcPrice"),a=document.getElementById("id"+e.sProdRef+"AccountPrice");if(i||o||a){var l=document.getElementById("id"+e.sProdRef+"VATMsg"),s=document.getElementById("id"+e.sProdRef+"DynamicPrice"),d=document.getElementById("id"+e.sProdRef+"StaticPrice");e.bOvrStaticPrice&&d&&!e.bQuantityBreak&&(d.style.visibility="hidden",d.style.display="none");var c=GetOriginalRef(e.sProdRef);if(g_mapDynPrices[c]||g_mapDynPrices.ErrorMsg){if(g_mapDynPrices.ErrorMsg||g_mapDynPrices[c].ErrorMsg)return l&&(l.style.visibility="hidden",l.style.display="none"),o?o.innerHTML=g_mapDynPrices.ErrorMsg?g_mapDynPrices.ErrorMsg:g_mapDynPrices[c].ErrorMsg:i&&(i.innerHTML=g_mapDynPrices.ErrorMsg?g_mapDynPrices.ErrorMsg:g_mapDynPrices[c].ErrorMsg),void(s&&(s.style.display="",s.style.visibility="visible"));l&&(l.style.visibility="visible",l.style.display="");var u=g_mapDynPrices[c].Total,p=g_mapDynPrices[c].Total+g_mapDynPrices[c].Tax1+g_mapDynPrices[c].Tax2;o&&(o.innerHTML=FormatPrices(u)),i&&(i.innerHTML=FormatPrices(p))}else getDynamicAccPrice(t,r,e,n);s&&(s.style.display="",s.style.visibility="visible")}}}function FormatPrices(e){for(var t=[],r=0;r<g_oConfig.arrCurrs.length;r++){var n=g_oConfig.arrCurrs[r];t.push(FormatPrice(e,n))}return 1==t.length?t[0]:Sprintf(g_oConfig.sPriceFmt,t[0],t[1])}function ZeroPad(e,t){var r="000000000000000",n=e.toString();return n.length<t&&(n=r.substr(0,t-n.length)+n),n}function FormatPrice(e,t){var r=parseFloat(t.sRate),n=Math.round(e*r),i=Math.pow(10,t.nDecs),o=Math.pow(10,t.nThous),a="",l=n;if(i>1){var s=l%i;a=t.sDecSep+ZeroPad(s,t.nDecs),l=parseInt(l/i)}if(0==l)a="0"+a;else for(;l;){var d=l%o;l=parseInt(l/o),a=l?t.sThouSep+ZeroPad(d,t.nThous)+a:d.toString()+a}return t.sSym+a}function GetTaxRate(e){return e/100}function AddOption(e,t,r,n,i){var o=document.createElement("OPTION");return o.text=r,o.value=t,n&&(o.selected=!0),o.className=i,e.options.add(o),o}function CSelect(e){this.elemHTML=e,"SELECT"==e.tagName?(this.arrOptions=GetOptionsArray(e),this.sValue=e.value):this.arrOptions=GetOptionsArray(e,this)}function GetOptionsArray(e,t){var r=[];if("SELECT"==e.tagName)for(var n=0;n<e.options.length;n++){var i=e.options[n],o=[i.value,i.text,i.className];r.push(o)}else{var a=document.getElementById("id"+e.name+"_Table");if(a){for(var l=a.innerHTML,s=[],d=document.getElementsByName(e.name),c=0,u=0,n=0;n<d.length;n++){var p=d[n],m=p.value,g=p.className,f=e.name+"_"+m,v=document.getElementById(f),h=v.outerHTML;if(!h){var S=l.indexOf(v.id),P=l.lastIndexOf("<",S),C=l.indexOf(">",P+v.innerHTML.length);h=l.substring(P,C+1)}r.push([m,h,g]),u=l.indexOf(h,c),s.push(l.substring(c,u)),c=u+h.length}s.push(l.substr(c)),t.arrHTMLFrag=s}}return r}function GetChoiceValues(e){for(var t=[],r=GetAttributes(e),n=0;n<r.length;n++){var i=GetAttributeValue(r[n]),o=""==i?0:parseInt(i,10);t.push(o)}return t}var reProdRefName=/^v_(.*)_\d+$/,reProdRefID=/^v_(.*)_\d+_\d+$/;function GetProdRefFromElem(e){var t=e.name;if(!t){var r=e.id.match(reProdRefID);if(r)return r[1]}if(t){var r=t.match(reProdRefName);if(r)return r[1]}return""}var reAttr=/\bajs-attr\b/;function GetAttributes(e){for(var t={},r={},n=GetAllElements(e),i=0;i<n.length;i++){var o=n[i];if(reAttr.test(o.className)){var a=GetProdRefFromElem(o);if(t[a]||(t[a]=[]),"SELECT"==o.tagName)t[a].push(o);else{var l=o.id.replace(/_\d+$/,"");o.name=l,r[l]||(r[l]=o,t[a].push(o))}}}return t}function GetAttributeValue(e){if("SELECT"==e.tagName)return e.value;for(var t=document.getElementsByName(e.name),r=0;r<t.length;r++)if(t[r].checked)return t[r].value;return 0}function SetAttributeValue(e,t){if("SELECT"==e.tagName)return e.value=t,e.value==t;for(var r=document.getElementsByName(e.name),n=0;n<r.length;n++)if(r[n].value==t)return r[n].checked=!0,!0;return r.length>0&&(r[0].checked=!0),!1}function Clone(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e[r];return t}function QuantityTimer(e,t,r,n){var i=e.name;if(0==i.indexOf("Q_")&&(sProdRef=i.substr(2)),sProdRef){var o=g_mapProds[sProdRef];if(!g_oConfig.bEstimateChoicePrices&&!ValidateChoices(sProdRef,!0,e)){var a=document.getElementById("id"+sProdRef+"DynamicPrice"),l=document.getElementById("id"+sProdRef+"StaticPrice");return o.bOvrStaticPrice&&a&&"none"==a.style.display&&(l&&!o.bQuantityBreak&&(l.style.visibility="hidden",l.style.display="none"),a.style.display="",a.style.visibility="visible"),void ShowDynamicPriceMessage(sProdRef,g_sUndeterminedPrice)}o.arrComps&&UpdateChoices(o,!1,e),UpdatePrice(o,t,r,n)}}function QuantityChanged(e,t,r,n){timeout&&(clearTimeout(timeout),timeout=null),timeout=setTimeout(function(){QuantityTimer(e,t,r,n)},g_nTimeout)}function ShowDynamicPriceMessage(e,t){var r=document.getElementById("id"+e+"TaxIncPrice"),n=document.getElementById("id"+e+"TaxExcPrice"),i=document.getElementById("id"+e+"VATMsg");i&&(i.style.visibility="hidden",i.style.display="none"),r&&n?(r.innerHTML="",n.innerHTML=t):r?r.innerHTML=t:n&&(n.innerHTML=t)}function GetChangedElemIndices(e,t){if(t&&e.arrComps)for(var r=0;r<e.arrComps.length;r++){var n=e.arrComps[r];if(n.aA)for(var i=0;i<n.aA.length;i++){var o=n.aA[i];if("SELECT"==t.tagName){if(o.elem.elemHTML==t)return{nCompIndex:r,nAttrIndex:i}}else if("INPUT"==t.tagName&&"radio"==t.type&&o.elem.elemHTML.name==t.name)return{nCompIndex:r,nAttrIndex:i}}}}function CloneArray(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e[r];return t}function UpdateUserSequence(e,t,r){for(var n=e.arrUserSeq,i=r[t],o=0;o<n.length;o++)if(n[o]==t){n.splice(o,1);break}i>0&&n.push(t)}function NormaliseAttrSeq(e){if(e.aA){for(var t=[],r={},n=0;n<e.arrUserSeq.length;n++){var i=e.arrUserSeq[n];r[i]=1,t.push(i)}for(var n=0;n<e.aA.length;n++)r[n]||t.push(n);e.arrNormAttrSeq=t}}function NormaliseUserChoices(e,t){for(var r=[],n=0;n<e.arrNormAttrSeq.length;n++){var i=e.arrNormAttrSeq[n];r.push(t[i])}return r}function GetNormAttr(e,t){var r=e.arrNormAttrSeq[t];return e.aA[r]}function MapInvalidPermutations(e){if(e.nInvalidPermCount=0,e.mP){var t={},r=e.mP,n=e.hOS;for(var i in r){var o=r[i];(-1==o[0]||0==o[0]&&n&&""!=o[1]&&void 0!=g_mapStockByRef[o[1]]&&g_mapStockByRef[o[1]]<=0)&&(t[i]=-1,e.nInvalidPermCount++)}e.mapInvalid=t}}function NormalisePerms(e){var t={},r=e.mapInvalid;for(var n in r)if(1==e.aA.length)t[n]=-1;else{for(var i=n.split(","),o=[],a=0;a<e.arrNormAttrSeq.length;a++){var l=e.arrNormAttrSeq[a];o.push(i[l])}t[o]=-1}e.mapNormPerms=t,GetInvalidAttrCounts(e)}function GetInvalidAttrCounts(e){e.nInvalidAnyCount=0;for(var t=new Array(e.aA.length),r=0;r<t.length;r++){for(var n=GetNormAttr(e,r),i=n.nCC,o=new Array(i),a=0;i>a;a++)o[a]=0;t[r]=o}for(var l in e.mapNormPerms)for(var s=l.split(","),r=0;r<s.length;r++){var d=t[r],c=s[r];0!=c?d[c]++:e.nInvalidAnyCount++}e.arrInvalidPerms=t}function GetUserChoiceCount(e){for(var t=0,r=0;r<e.length;r++)0!=e[r]&&t++;return t}function AddJSFlagToProductForm(e){var t=$(e).closest("form");null!=t&&t.append('<input type="hidden" name="JS" value="1" />')}function PreValidate(e){return AddJSFlagToProductForm(e),!0}var g_wishListForm,g_sAddToCartButtonName="ACTION_ADDTOCART";$(function(){$(".wishlist-row").on("submit",function(e){return"Add to Cart"==$(document.activeElement).val()&&(g_sAddToCartButtonName=$(document.activeElement)[0].name,e.preventDefault(),g_wishListForm=this,$.ajax({url:this.action,type:"POST",dataType:"json",data:$(this).serialize()+"&"+g_sAddToCartButtonName+"=Add to Cart&AJAX=1",success:function(e){$(".wishlistmodal").show(),$(this).addClass("showPopup"),$(".atcpopup").slideFadeToggle()},error:function(e,t,r){$(g_wishListForm).append('<input type="hidden" name="'+g_sAddToCartButtonName+'" value="Add to Cart" /> '),g_wishListForm.submit()}})),!0}),$(".addanother").on("click",function(){return $(g_wishListForm).append('<input type="hidden" name="NEXT_ACTION" value="ADD_ANOTHER" /> '),$(g_wishListForm).append('<input type="hidden" name="'+g_sAddToCartButtonName+'" value="Add to Cart" /> '),g_wishListForm.submit(),!1}),$(".gotocart").on("click",function(){return $(g_wishListForm).append('<input type="hidden" name="NEXT_ACTION" value="GO_TO_CART" /> '),$(g_wishListForm).append('<input type="hidden" name="'+g_sAddToCartButtonName+'" value="Add to Cart" /> '),g_wishListForm.submit(),!1})}),$.fn.slideFadeToggle=function(e,t){return this.animate({opacity:"toggle",height:"toggle"},"fast",e,t)};var g_sAddToWishListButtonName;$(function(){$(".wish-list-button-popup").parents("form").on("submit",function(e){return"Add To Wish List"==$(document.activeElement).val()&&(g_sAddToWishListButtonName=$(document.activeElement)[0].name,e.preventDefault(),g_wishListForm=this,$.ajax({url:this.action,type:"POST",dataType:"json",data:$(this).serialize()+"&"+g_sAddToWishListButtonName+"=Add To Wish List&AJAX=1",success:function(e){return"ENFORCE_LOGIN"===e.result?(window.location=e.redirectUrl,!0):($(".wishlistmodal").show(),$(this).addClass("showPopup"),void $(".atcpopup").slideFadeToggle())},error:function(e,t,r){$(g_wishListForm).append('<input type="hidden" name="'+g_sAddToWishListButtonName+'" value="Add To Wish List" /> '),g_wishListForm.submit()}})),!0}),$(".wl_goback").on("click",function(){return $(g_wishListForm).append('<input type="hidden" name="NEXT_ACTION" value="GO_BACK" /> '),$(g_wishListForm).append('<input type="hidden" name="'+g_sAddToWishListButtonName+'" value="Add To Wish List" /> '),g_wishListForm.submit(),!1}),$(".wl_gotowishlist").on("click",function(){return $(g_wishListForm).append('<input type="hidden" name="NEXT_ACTION" value="GO_TO_WISHLIST" /> '),$(g_wishListForm).append('<input type="hidden" name="'+g_sAddToWishListButtonName+'" value="Add To Wish List" /> '),g_wishListForm.submit(),!1})});var nStartPos=-1,bUseTable=!1;function CreateRecentProduct(e,t,r,n){this.sPid=e,this.sPname=t,this.sPprice=r,this.sThumb=n}function GetRecentFromCookie(){var e=getCookie("ACTINIC_RECENT");if(null!=e&&e.length>10){for(var t=new Array,r=e.split("\f"),n=0;n<r.length;n++){var i=r[n].split("	");t.push(new CreateRecentProduct(i[0],i[1],i[2],i[3]))}return t}return!1}function SetRecentToCookie(e){for(var t="",r=0;r<e.length;r++)t+=e[r].sPid+"	"+e[r].sPname+"	"+e[r].sPprice+"	"+e[r].sThumb+"\f";t=t.slice(0,-1);var n=new Date;n.setTime(n.getTime()+36e5*nKeepRecentHours),setCookie("ACTINIC_RECENT",t,n)}function ReplaceVariables(e,t){var r=0==t.sThumb.indexOf("file:///")?t.sThumb:catalogDir+t.sThumb;return e=e.replace(/_PID_/g,t.sPid),e=e.replace(/_ENAME_/g,escape(t.sPname)),e=e.replace(/_NAME_/g,t.sPname),e=e.replace(/_PRICE_/g,t.sPprice),e=e.replace(/_THUMB_/g,r),e=e.replace(/_SSURL_/g,ssURL),e=e.replace(/_HREF_/g,"href")}function ScrollBackRecent(){var e=GetRecentFromCookie();e&&e.length>nTrimListTo&&(nStartPos-=nScrollBy,0>nStartPos&&(nStartPos=0),document.getElementById("recenthtlist").innerHTML=bUseTable?RecentProductsListTableHTML():RecentProductsListHTML(),SetBackForwardButtons())}function ScrollForwardRecent(){var e=GetRecentFromCookie();e&&e.length>nTrimListTo&&(0>nStartPos&&(nStartPos=0),nStartPos+=nScrollBy,nStartPos>e.length-nTrimListTo&&(nStartPos=e.length-nTrimListTo),document.getElementById("recenthtlist").innerHTML=bUseTable?RecentProductsListTableHTML():RecentProductsListHTML(),SetBackForwardButtons())}function SetBackForwardButtons(){var e=GetRecentFromCookie();if(e){var t;(t=document.getElementById("scrollbackrecent"))&&(t.disabled=0>=nStartPos,t.style.cursor=0>=nStartPos?"default":"pointer"),(t=document.getElementById("scrollforwardrecent"))&&(t.disabled=nStartPos>=e.length-nTrimListTo,t.style.cursor=nStartPos>=e.length-nTrimListTo?"default":"pointer")}}function TrimRecentProductsList(e){var t=e.length;if(t<=nTrimListTo)return nStartPos=0,e;var r=new Array;for(0>nStartPos&&(nStartPos=t-nTrimListTo),nStartPos>t-nTrimListTo&&(nStartPos=t-nTrimListTo),i=0;i<nTrimListTo;i++)r.push(e[nStartPos+i]);return r}function RecentProductsListHTML(){var e=GetRecentFromCookie();if(e){e=TrimRecentProductsList(e),bDisplayReversed&&e.reverse();for(var t="",r=0;r<e.length;r++)t+=ReplaceVariables(sRecentItem,e[r]);if(""!=t)return sRecentPrefix+t+sRecentSuffix}return sRecentEmptyList}function RecentProductsListTableHTML(){var e=GetRecentFromCookie();if(e){e=TrimRecentProductsList(e),bDisplayReversed&&e.reverse();for(var t=!1,r=sRecentImageRowPrefix,n=sRecentDescRowPrefix,i=sRecentPriceRowPrefix,o=sRecentDeleteRowPrefix,a=0;a<e.length;a++)bHaveItems=!0,r+=ReplaceVariables(sRecentImageItem,e[a]),n+=ReplaceVariables(sRecentDescItem,e[a]),i+=ReplaceVariables(sRecentPriceItem,e[a]),o+=ReplaceVariables(sRecentDeleteItem,e[a]);if(bHaveItems)return sRecentPrefix+r+sRecentImageRowSuffix+n+sRecentDescRowSuffix+i+sRecentPriceRowSuffix+o+sRecentDeleteRowSuffix+sRecentSuffix}return sRecentEmptyList}function DisplayRecentProducts(e){bUseTable=e===!0,e?(document.write(RecentProductsListTableHTML()),SetBackForwardButtons()):(document.write(RecentProductsListHTML()),SetBackForwardButtons())}function SaveRecentProduct(e,t,r,n){if(""!=n){var i=new Array,o=GetRecentFromCookie();if(o)for(var a=0;a<o.length;a++)o[a].sPid!=e&&i.push(o[a]);for(i.push(new CreateRecentProduct(e,t,r,n));i.length>nMaxRecent;)i.shift();SetRecentToCookie(i)}}function DeleteRecent(e,t){var r=new Array,n=GetRecentFromCookie();if(n)for(var i=0;i<n.length;i++)n[i].sPid!=e&&r.push(n[i]);if(SetRecentToCookie(r),t)document.getElementById("recenthtlist").innerHTML=RecentProductsListTableHTML();else{var o=document.getElementById("recenthtlist");null===o&&(o=document.getElementById("recentstlist")),o&&(o.innerHTML=RecentProductsListHTML())}SetBackForwardButtons()}/***************************************************************
* 
* Responsive.js	-	 utility functions for responsive web design
*
* Copyright (c) 2014 SellerDeck Limited
*
****************************************************************/
"undefined"==typeof window.SD&&(window.SD={}),window.SD.Responsive={CallFunctions:function(){SD.Responsive.contactInfoTop(),SD.Responsive.menus(),SD.Responsive.orderHistory(),SD.Responsive.orderHistoryDisplay(),SD.Responsive.searchButton(),SD.Responsive.ie9(),SD.Responsive.android(),SD.Responsive.setBrowserSizeListener(),SD.Responsive.moveSizeDependentComponents(),SD.Responsive.quantityButtons(),SD.Responsive.addNavigateOnClick(),SD.Responsive.removeDuplicatedInfo(),SD.Responsive.resizeImages()},contactInfoTop:function(){var e=function(){$(".topContactInfoMobile div").css("clear","none"),$(".topContactInfoMobile div").css("width",""),$(".topContactInfoMobile div p.contactInfoP").css("display","none"),$(".topContactInfoMobile div p.contactInfoP").css("width",""),$(".topContactInfoMobile .contactInfoTopCol1").removeClass("colClass"),$(".topContactInfoMobile .contactInfoTopCol2").removeClass("colClass"),$(".topContactInfoMobile .contactInfoTopCol3").removeClass("colClass"),$(".navigation-bar .miniNav").removeAttr("style")},t=function(){$(".navigation-bar .miniNav").css("float","left")};e();var r=function(){e(),$(".topContactInfoMobile .contactInfoTopCol1").addClass("colClass"),$(".topContactInfoMobile .contactInfoTopCol1 p.contactInfoP").css("width","95%"),$(".topContactInfoMobile .contactInfoTopCol1 p.contactInfoP").toggle()},n=function(){e(),$(".topContactInfoMobile .contactInfoTopCol2").addClass("colClass"),$(".topContactInfoMobile .contactInfoTopCol2 p.contactInfoP").css("width","95%"),$(".topContactInfoMobile .contactInfoTopCol2 p.contactInfoP").toggle()},i=function(){e(),$(".topContactInfoMobile .contactInfoTopCol3").addClass("colClass"),$(".topContactInfoMobile .contactInfoTopCol3 p.contactInfoP").css("width","95%"),$(".topContactInfoMobile .contactInfoTopCol3 p.contactInfoP").toggle()};$(".topContactInfoMobile .contactInfoTopCol1 div.contactInfoClick").click(function(){r(),t(),$(".topContactInfoMobile .contactInfoTopCol1 div.contactInfoClick").click(function(){SD.Responsive.contactInfoTop()})}),$(".topContactInfoMobile .contactInfoTopCol2 div.contactInfoClick").click(function(){n(),t(),$(".topContactInfoMobile .contactInfoTopCol2 div.contactInfoClick").click(function(){SD.Responsive.contactInfoTop()})}),$(".topContactInfoMobile .contactInfoTopCol3 div.contactInfoClick").click(function(){i(),t(),$(".topContactInfoMobile .contactInfoTopCol3 div.contactInfoClick").click(function(){SD.Responsive.contactInfoTop()})})},menus:function(){$("div #mega-menu").addClass("menuHide"),$("#mainNav").click(function(e){$("div #mega-menu").slideToggle("slow",function(){$("div #mega-menu").toggleClass("menuHide").toggleClass("menuShow").removeAttr("style")}),e.preventDefault()}),$("div #brochure-menu").addClass("menuHide"),$("#mainNav").click(function(e){$("div #brochure-menu").slideToggle("slow",function(){$("div #brochure-menu").toggleClass("menuHide").toggleClass("menuShow").removeAttr("style")}),e.preventDefault()}),$("div #quickSearchLeft").addClass("menuHide"),$("#quickSearchTitle").click(function(e){$("#quickSearchLeft").slideToggle("slow",function(){$("#quickSearchLeft").toggleClass("menuHide").toggleClass("menuShow").removeAttr("style")}),e.preventDefault()}),$("div #shoppingCartSummaryLeft").addClass("menuHide"),$("#shoppingCartSummaryTitle").click(function(e){$("#shoppingCartSummaryLeft").slideToggle("slow",function(){$("#shoppingCartSummaryLeft").toggleClass("menuHide").toggleClass("menuShow").removeAttr("style")}),e.preventDefault()}),$("div #productFiltersLeft").addClass("menuHide"),$("#productFiltersTitle").click(function(e){$("#productFiltersLeft").slideToggle("slow",function(){$("#productFiltersLeft").toggleClass("menuHide").toggleClass("menuShow").removeAttr("style")}),e.preventDefault()}),$("div #infoBox").addClass("menuHide"),$("#infoBoxTitle").click(function(e){$("#infoBox").slideToggle("slow",function(){$("#infoBox").toggleClass("menuHide").toggleClass("menuShow").removeAttr("style")}),e.preventDefault()}),$("div #storeSections").addClass("menuHide"),$("#storeSectionsTitle").click(function(e){$("#storeSections").slideToggle("slow",function(){$("#storeSections").toggleClass("menuHide").toggleClass("menuShow").removeAttr("style")}),e.preventDefault()}),$("div #information").addClass("menuHide"),$("#informationTitle").click(function(e){$("#information").slideToggle("slow",function(){$("#information").toggleClass("menuHide").toggleClass("menuShow").removeAttr("style")}),e.preventDefault()}),$("div #bestSellerLeft").addClass("menuHide"),$("#bestSellerTitle").click(function(e){$("#bestSellerLeft").slideToggle("slow",function(){$("#bestSellerLeft").toggleClass("menuHide").toggleClass("menuShow").removeAttr("style")}),e.preventDefault()}),$("div #newProductLeft").addClass("menuHide"),$("#newProductTitle").click(function(e){$("#newProductLeft").slideToggle("slow",function(){$("#newProductLeft").toggleClass("menuHide").toggleClass("menuShow").removeAttr("style")}),e.preventDefault()}),$("div #couponFieldLeft").addClass("menuHide"),$("#couponFieldTitle").click(function(e){$("#couponFieldLeft").slideToggle("slow",function(){$("#couponFieldLeft").toggleClass("menuHide").toggleClass("menuShow").removeAttr("style")}),e.preventDefault()})},m_bResponsiveDeliveryFields:!1,setResponsiveDeliveryFields:function(e){SD.Responsive.m_bResponsiveDeliveryFields=e},getResponsiveDeliveryFields:function(){return SD.Responsive.m_bResponsiveDeliveryFields},orderHistory:function(){$("div#idORDER_TRACKING table tr.cart td:nth-child(1)").prepend("<span>Order Number:</span>"),$("div#idORDER_TRACKING table tr.cart td:nth-child(2)").prepend("<span>Date Ordered:</span>"),$("div#idORDER_TRACKING table tr.cart td:nth-child(3)").prepend("<span>Value:</span>"),$("div#idORDER_TRACKING table tr.cart td:nth-child(4)").prepend("<span>Status:</span>"),$("div#idORDER_TRACKING table tr.cart td:nth-child(5)").prepend("<span>Date Shipped:</span>"),$("div#idORDER_TRACKING table tr.cart td:nth-child(6)").prepend("<span>Carrier:</span>"),$("div#idORDER_TRACKING table tr.cart td:nth-child(7)").prepend("<span>Delivery Tracking:</span>"),$("div#idORDER_TRACKING [id^=idORDER_DETAILS_] tr.cart td").find("span").remove("span"),$("div#idORDER_TRACKING [id^=idORDER_DETAILS_] tr.cart td:nth-child(1)").prepend("<span>Product Ref:</span>"),$("div#idORDER_TRACKING [id^=idORDER_DETAILS_] tr.cart td:nth-child(2)").prepend("<span>Item:</span>"),$("div#idORDER_TRACKING [id^=idORDER_DETAILS_] tr.cart td:nth-child(3)").prepend("<span>Qty Ordered:</span>"),$("div#idORDER_TRACKING [id^=idORDER_DETAILS_] tr.cart td:nth-child(4)").prepend("<span>Qty Shipped:</span>"),$("div#idORDER_TRACKING [id^=idORDER_DETAILS_] tr.cart td:nth-child(5)").prepend("<span>Cancelled:</span>"),$("div#idORDER_TRACKING [id^=idORDER_DETAILS_] tr.cart td:nth-child(6)").prepend("<span>Qty Back Ordered:</span>"),$("div#idORDER_TRACKING [id^=idORDER_DETAILS_] tr.cart td:nth-child(7)").prepend("<span>Total Value:</span>"),$("div#idORDER_TRACKING [id^=idORDER_DETAILS_] tr td").each(function(){var e=$(this);e.html(e.html().replace(/&nbsp;/g,""))})},orderHistoryDisplay:function(){$("#idLookupAgain").addClass("hide"),$("#idLOOKUPORDERSFORM fieldset input[value='Lookup Order']").on("click",function(){$("#idLookupAgain").removeClass("hide"),$("#idLOOKUPORDERSFORM").toggle(),$("div#idLOOKUPORDERS > p:nth-child(2)").toggle()}),$("#idORDER_TRACKING").length&&($("#idLookupAgain").removeClass("hide"),$("#idLOOKUPORDERSFORM").toggle(),$("div#idLOOKUPORDERS > p:nth-child(2)").toggle()),$("#idLookupAgain").on("click",function(){$("#idLookupAgain").addClass("hide"),$("#idLOOKUPORDERSFORM").toggle(),$("div#idLOOKUPORDERS > p:nth-child(2)").toggle()})},searchButton:function(){$("div #searchFields").addClass("menuHide"),$("#searchButton").click(function(e){$("div #searchFields").slideToggle("slow",function(){$("div #searchFields").toggleClass("menuHide").toggleClass("menuShow").removeAttr("style")})})},ie9:function(){function e(){var e=!1;if("Microsoft Internet Explorer"==navigator.appName){var t=navigator.userAgent,r=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=r.exec(t)&&(e=9==parseFloat(RegExp.$1))}return e}e()?$("body").addClass("IeOnly"):$("body").removeClass("IeOnly")},android:function(){$("body").removeClass("androidOnly");var e=navigator.userAgent,t=e.indexOf("Mozilla/5.0")>-1&&e.indexOf("Android ")>-1&&e.indexOf("AppleWebKit")>-1&&!(e.indexOf("Chrome")>-1);t&&$("body").addClass("androidOnly")},m_nWindowWidth:0,m_timerResizeID:0,setBrowserSizeListener:function(){SD.Responsive.m_nWindowWidth=SD.Responsive.getBrowserWidth(),$(window).resize(function(){null!=SD.Responsive.m_timerResizeID&&window.clearTimeout(SD.Responsive.m_timerResizeID),SD.Responsive.m_timerResizeID=window.setTimeout(SD.Responsive.resizeIfNeeded,20)})},resizeIfNeeded:function(){SD.Responsive.m_timerResizeID=null,SD.Responsive.m_nWindowWidth!=SD.Responsive.getBrowserWidth()&&(SD.Responsive.m_nWindowWidth=SD.Responsive.getBrowserWidth(),SD.Responsive.moveSizeDependentComponents())},getBrowserWidth:function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},moveSizeDependentComponents:function(){SD.Responsive.moveMiniNavItems(),SD.Responsive.menuAlignment()},m_bMiniNavVisible:!1,moveMiniNavItems:function(){var e=$("div.miniNav").is(":visible");SD.Responsive.m_bMiniNavVisible!=e&&(SD.Responsive.m_bMiniNavVisible=e,SD.Responsive.m_bMiniNavVisible?($("#mega-menu").insertAfter(".mainNav"),$("#brochure-menu").insertAfter(".mainNav"),$("#quickSearchLeft").insertAfter(".quickSearchTitle"),$("#shoppingCartSummaryLeft").insertAfter("#shoppingCartSummaryTitle"),$("#productFiltersLeft").insertAfter(".productFiltersTitle"),$("#infoBox").insertAfter("#infoBoxTitle"),$("#storeSections").insertAfter("#storeSectionsTitle"),$("#information").insertAfter("#informationTitle"),$("#bestSellerLeft").insertAfter("#bestSellerTitle"),$("#newProductLeft").insertAfter("#newProductTitle"),$("#couponFieldLeft").insertAfter("#couponFieldTitle")):($("#mega-menu").insertAfter(".miniNav"),$("#brochure-menu").insertAfter(".miniNav"),$("#couponFieldLeft").prependTo("#left-sidebar > .sidebar"),$("#newProductLeft").prependTo("#left-sidebar > .sidebar"),$("#bestSellerLeft").prependTo("#left-sidebar > .sidebar"),$("#information").prependTo("#left-sidebar > .sidebar"),$("#storeSections").prependTo("#left-sidebar > .sidebar"),$("#infoBox").prependTo("#left-sidebar > .sidebar"),$("#productFiltersLeft").prependTo("#left-sidebar > .sidebar"),$("#shoppingCartSummaryLeft").prependTo("#left-sidebar > .sidebar"),$("#quickSearchLeft").prependTo("#left-sidebar > .sidebar")))},quantityButtons:function(){$("fieldset.quantity-box input[type!='hidden']").before('<button type="button" class="dec quantityButton">-</button>').after('<button type="button" class="inc quantityButton">+</button>'),$(".quantityButton").on("click",function(e){var t=$(e.delegateTarget),r=t.parent().find("input");if(r&&$.isNumeric(r.val())){var n=parseInt(r.val(),10),i;i=t.hasClass("inc")?n+1:n>0?n-1:0,r.val(i);var o=$.Event("keyup");o.which=16,r.trigger(o)}})},addNavigateOnClick:function(){$(".navigateOnClick").on("click",function(e){var t=$(e.target).closest(".navigateOnClick"),r=$(t).find("a").filter(":first");r&&(window.location.href=r.attr("href"))})},removeDuplicatedInfo:function(){$(".checkout-cart tr td.cart").each(function(){$(this).find(".mobileHeader:contains('REF') + .floatLeft:contains('')").prev().remove(),$(this).find(".floatLeft:contains('')").remove()})},resizeImages:function(){$(window).load(function(){window.pg_nSectionImageMaxWidth&&0==window.pg_nSectionImageMaxWidth||$(".section-link-details .section-link-image img, .product-details .product-image img").each(function(){var e=$(this).prop("naturalWidth"),t=e>window.pg_nSectionImageMaxWidth?window.pg_nSectionImageMaxWidth:e;$(this).css({"max-width":t+"px",width:"100%"})}),window.pg_nProductImageMaxWidth&&0==window.pg_nProductImageMaxWidth||$("#product-page-body form .product-image img").each(function(){var e=$(this).prop("naturalWidth"),t=e>window.pg_nProductImageMaxWidth?window.pg_nProductImageMaxWidth:e;$(this).css({"max-width":t+"px",width:"100%"})})})},m_bMainNavVisible:!1,menuAlignment:function(){var e=$("div#mega-menu").is(":visible");if(SD.Responsive.m_bMainNavVisible!=e)if(SD.Responsive.m_bMainNavVisible=e,SD.Responsive.m_bMainNavVisible){$("#mega-menu ul li a, #brochure-menu ul li a").css({height:""});var t=0;$("#mega-menu ul li, #brochure-menu ul li").each(function(){$(this).height()>t&&(t=$(this).height())}),$("#mega-menu ul li a, #brochure-menu ul li a").css({height:t+"px"}),$("#mega-menu ul li ul > li a, #brochure-menu ul li ul > li a").css({height:""})}else $("#mega-menu ul li a, #brochure-menu ul li a").removeAttr("style")}};
//# sourceMappingURL=sellerdeck.min.map